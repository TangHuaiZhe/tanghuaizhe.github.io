# Swift note

[TOC]

Swifté€šè¿‡é‡‡ç”¨ç°ä»£ç¼–ç¨‹æ¨¡å¼æ¥é¿å…å¤§é‡å¸¸è§ç¼–ç¨‹é”™è¯¯ï¼š

* å˜é‡å§‹ç»ˆåœ¨ä½¿ç”¨å‰åˆå§‹åŒ–ã€‚
* æ£€æŸ¥æ•°ç»„ç´¢å¼•è¶…å‡ºèŒƒå›´çš„é”™è¯¯ã€‚
* æ£€æŸ¥æ•´æ•°æ˜¯å¦æº¢å‡ºã€‚
* å¯é€‰å€¼ç¡®ä¿æ˜ç¡®å¤„ç† nil å€¼ã€‚
* å†…å­˜è¢«è‡ªåŠ¨ç®¡ç†ã€‚
* é”™è¯¯å¤„ç†å…è®¸ä»æ„å¤–æ•…éšœæ§åˆ¶æ¢å¤ã€‚



## ç®€å•å€¼

### letå’Œvar
ä½¿ç”¨ let æ¥å£°æ˜å¸¸é‡ï¼Œä½¿ç”¨ var æ¥å£°æ˜å˜é‡
```swift
var myVariable = 42
myVariable = 50
let myConstant = 42

//å£°æ˜çš„åŒæ—¶èµ‹å€¼,è‡ªåŠ¨æ¨æ–­ç±»å‹
let implicitInteger = 70
let implicitDouble = 70.0
//å¦‚æœåˆå§‹å€¼æ²¡æœ‰æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ï¼ˆæˆ–è€…æ²¡æœ‰åˆå§‹å€¼ï¼‰
//é‚£ä½ éœ€è¦åœ¨å˜é‡åé¢å£°æ˜ç±»å‹ï¼Œç”¨å†’å·åˆ†å‰²ã€‚
let explicitDouble: Double = 70

//å’Œjavaä¸åŒï¼Œå€¼æ°¸è¿œä¸ä¼šè¢«éšå¼è½¬æ¢ä¸ºå…¶ä»–ç±»å‹ã€‚
//å¦‚æœä½ éœ€è¦æŠŠä¸€ä¸ªå€¼è½¬æ¢æˆå…¶ä»–ç±»å‹ï¼Œè¯·æ˜¾å¼è½¬æ¢ã€‚
let label = "The width is"
let width = 94
let widthLabel = label + String(width)

//æœ‰ä¸€ç§æ›´ç®€å•çš„æŠŠå€¼è½¬æ¢æˆå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼šæŠŠå˜é‡å†™åˆ°æ‹¬å·ä¸­ï¼Œå¹¶ä¸”åœ¨æ‹¬å·ä¹‹å‰å†™ä¸€ä¸ªåæ–œæ ï¼š
let apples = 3
let oranges = 5
let appleSummary = "I have \(apples) apples."
let fruitSummary = "I have \(apples + oranges) pieces of fruit."
```

### é›†åˆ

#### æ•°ç»„

```swift
//åˆ›å»ºæ•°ç»„çš„æ–¹å¼ï¼š
var someInts = [Int]()

var threeDoubles = Array(repeating: 0.0, count: 3)


var anotherThreeDoubles = Array(repeating: 2.5, count: 3)
// anotherThreeDoubles è¢«æ¨æ–­ä¸º [Double]ï¼Œç­‰ä»·äº [2.5, 2.5, 2.5]

var sixDoubles = threeDoubles + anotherThreeDoubles
// sixDoubles è¢«æ¨æ–­ä¸º [Double]ï¼Œç­‰ä»·äº [0.0, 0.0, 0.0, 2.5, 2.5, 2.5]

var shoppingList: [String] = ["Eggs", "Milk"]


//æ•°ç»„çš„éå†
for item in shoppingList {
    print(item)
}
//éå†åŒæ—¶æ‹¿åˆ°æ•°ç»„çš„ç´¢å¼•å’Œvalue
for (index, value) in shoppingList. enumerated() {
    print("Item \(String(index + 1)): \(value)")
}

```

#### é›†åˆï¼ˆSetsï¼‰
ç”¨æ¥å­˜å‚¨ç›¸åŒç±»å‹å¹¶ä¸”æ²¡æœ‰ç¡®å®šé¡ºåºçš„å€¼
å½“é›†åˆå…ƒç´ é¡ºåºä¸é‡è¦æ—¶æˆ–è€…å¸Œæœ›ç¡®ä¿æ¯ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡æ—¶å¯ä»¥ä½¿ç”¨é›†åˆè€Œä¸æ˜¯æ•°ç»„


```swift

var letters = Set<Character>()
letters.insert("a")
print("letters is of type Set<Character> with \(letters.count) items.")

letters = []
// letters ç°åœ¨æ˜¯ä¸€ä¸ªç©ºçš„ Set, ä½†æ˜¯å®ƒä¾ç„¶æ˜¯ Set<Character> ç±»å‹


var favoriteGenres: Set<String> = ["Rock", "Classical", "Hip hop"]

//æ•°ç»„å­—é¢é‡ä¸­çš„æ‰€æœ‰å…ƒç´ ç±»å‹ç›¸åŒï¼ŒSwift å¯ä»¥æ¨æ–­å‡ºSet<String>ä½œä¸ºfavoriteGenreså˜é‡çš„æ­£ç¡®ç±»å‹
var favoriteGenres: Set = ["Rock", "Classical", "Hip hop"]

//remove(_:)æ–¹æ³•å»åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœè¯¥å€¼æ˜¯è¯¥Setçš„ä¸€ä¸ªå…ƒç´ åˆ™åˆ é™¤è¯¥å…ƒç´ å¹¶ä¸”è¿”å›è¢«åˆ é™¤çš„å…ƒç´ å€¼ï¼Œå¦åˆ™å¦‚æœè¯¥Setä¸åŒ…å«è¯¥å€¼ï¼Œåˆ™è¿”å›nil
if let removedGenre = favoriteGenres.remove("Rock") {
    print("\(removedGenre)? I'm over it.")
} else {
    print("I never much cared for that.")
}
// æ‰“å° "Rock? I'm over it."


```

#### å­—å…¸


```swift
var namesOfIntegers = [Int: String]()

namesOfIntegers[16] = "sixteen"
// namesOfIntegers ç°åœ¨åŒ…å«ä¸€ä¸ªé”®å€¼å¯¹
namesOfIntegers = [:]
// namesOfIntegers åˆæˆä¸ºäº†ä¸€ä¸ª [Int: String] ç±»å‹çš„ç©ºå­—å…¸

var airports: [String: String] = ["YYZ": "Toronto Pearson", "DUB": "Dublin"]

var airports = ["YYZ": "Toronto Pearson", "DUB": "Dublin"]


//éå†
for (airportCode, airportName) in airports {
    print("\(airportCode): \(airportName)")
}
//éå†key
for airportCode in airports.keys {
    print("Airport code: \(airportCode)")
}
// Airport code: YYZ
// Airport code: LHR

//éå†value
for airportName in airports.values {
    print("Airport name: \(airportName)")
}
// Airport name: Toronto Pearson
// Airport name: London Heathrow


```




### åŸºæœ¬é›†åˆæ“ä½œ

* ä½¿ç”¨`intersection(_:)`æ–¹æ³•æ ¹æ®ä¸¤ä¸ªé›†åˆä¸­éƒ½åŒ…å«çš„å€¼åˆ›å»ºçš„ä¸€ä¸ªæ–°çš„é›†åˆã€‚
* ä½¿ç”¨`symmetricDifference(_:)`æ–¹æ³•æ ¹æ®åœ¨ä¸€ä¸ªé›†åˆä¸­ä½†ä¸åœ¨ä¸¤ä¸ªé›†åˆä¸­çš„å€¼åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚
* ä½¿ç”¨`union(_:)`æ–¹æ³•æ ¹æ®ä¸¤ä¸ªé›†åˆçš„å€¼åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚
* ä½¿ç”¨`subtracting(_:)`æ–¹æ³•æ ¹æ®ä¸åœ¨è¯¥é›†åˆä¸­çš„å€¼åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚



```swift
let oddDigits: Set = [1, 3, 5, 7, 9]
let evenDigits: Set = [0, 2, 4, 6, 8]
let singleDigitPrimeNumbers: Set = [2, 3, 5, 7]

oddDigits.union(evenDigits).sorted()
// [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
oddDigits.intersection(evenDigits).sorted()
// []
oddDigits.subtracting(singleDigitPrimeNumbers).sorted()
// [1, 9]
oddDigits.symmetricDifference(singleDigitPrimeNumbers).sorted()
// [1, 2, 9]
```

* ä½¿ç”¨â€œæ˜¯å¦ç›¸ç­‰â€è¿ç®—ç¬¦(==)æ¥åˆ¤æ–­ä¸¤ä¸ªé›†åˆæ˜¯å¦åŒ…å«å…¨éƒ¨ç›¸åŒçš„å€¼ã€‚
* ä½¿ç”¨isSubset(of:) iså­é›† æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªé›†åˆä¸­çš„å€¼æ˜¯å¦ä¹Ÿè¢«åŒ…å«åœ¨å¦å¤–ä¸€ä¸ªé›†åˆä¸­ã€‚
* ä½¿ç”¨isSuperset(of:) isè¶…é›† æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªé›†åˆä¸­åŒ…å«å¦ä¸€ä¸ªé›†åˆä¸­æ‰€æœ‰çš„å€¼ã€‚
* ä½¿ç”¨isStrictSubset(of:)æˆ–è€…isStrictSuperset(of:)æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªé›†åˆæ˜¯å¦æ˜¯å¦å¤–ä¸€ä¸ªé›†åˆçš„å­é›†åˆæˆ–è€…çˆ¶é›†åˆå¹¶ä¸”ä¸¤ä¸ªé›†åˆå¹¶ä¸ç›¸ç­‰ã€‚
* ä½¿ç”¨isDisjoint(with:) æ˜¯å¦æ²¡æœ‰äº¤é›†  æ–¹æ³•æ¥åˆ¤æ–­ä¸¤ä¸ªé›†åˆæ˜¯å¦ä¸å«æœ‰ç›¸åŒçš„å€¼ã€‚


```swift
let houseAnimals: Set = ["ğŸ¶", "ğŸ±"]
let farmAnimals: Set = ["ğŸ®", "ğŸ”", "ğŸ‘", "ğŸ¶", "ğŸ±"]
let cityAnimals: Set = ["ğŸ¦", "ğŸ­"]

houseAnimals.isSubset(of: farmAnimals)
// true
farmAnimals.isSuperset(of: houseAnimals)
// true
farmAnimals.isDisjoint(with: cityAnimals)
// true
```




### å…ƒç»„ï¼ˆtuplesï¼‰
æŠŠå¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªå¤åˆå€¼ã€‚å…ƒç»„å†…çš„å€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œå¹¶ä¸è¦æ±‚æ˜¯ç›¸åŒç±»å‹ã€‚
å¯ä»¥æŠŠä»»æ„é¡ºåºçš„ç±»å‹ç»„åˆæˆä¸€ä¸ªå…ƒç»„ï¼Œè¿™ä¸ªå…ƒç»„å¯ä»¥åŒ…å«æ‰€æœ‰ç±»å‹ã€‚åªè¦ä½ æƒ³ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç±»å‹ä¸º (Int, Int, Int) æˆ–è€… (String, Bool) æˆ–è€…å…¶ä»–ä»»ä½•ä½ æƒ³è¦çš„ç»„åˆçš„å…ƒç»„

ä½œä¸ºå‡½æ•°è¿”å›å€¼æ—¶ï¼Œå…ƒç»„éå¸¸æœ‰ç”¨ã€‚ä¸€ä¸ªç”¨æ¥è·å–ç½‘é¡µçš„å‡½æ•°å¯èƒ½ä¼šè¿”å›ä¸€ä¸ª (Int, String) å…ƒç»„æ¥æè¿°æ˜¯å¦è·å–æˆåŠŸã€‚å’Œåªèƒ½è¿”å›ä¸€ä¸ªç±»å‹çš„å€¼æ¯”è¾ƒèµ·æ¥ï¼Œä¸€ä¸ªåŒ…å«ä¸¤ä¸ªä¸åŒç±»å‹å€¼çš„å…ƒç»„å¯ä»¥è®©å‡½æ•°çš„è¿”å›ä¿¡æ¯æ›´æœ‰ç”¨

>å…ƒç»„åœ¨ä¸´æ—¶ç»„ç»‡å€¼çš„æ—¶å€™å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯å¹¶ä¸é€‚åˆåˆ›å»ºå¤æ‚çš„æ•°æ®ç»“æ„ã€‚å¦‚æœä½ çš„æ•°æ®ç»“æ„å¹¶ä¸æ˜¯ä¸´æ—¶ä½¿ç”¨ï¼Œè¯·ä½¿ç”¨ç±»æˆ–è€…ç»“æ„ä½“è€Œä¸æ˜¯å…ƒç»„

```swift
//ä¸€ä¸ªç±»å‹ä¸º (Int, String) çš„å…ƒç»„
let http404Error = (404, "Not Found")


//å°†ä¸€ä¸ªå…ƒç»„çš„å†…å®¹åˆ†è§£ï¼ˆdecomposeï¼‰æˆå•ç‹¬çš„å¸¸é‡å’Œå˜é‡
let (statusCode, statusMessage) = http404Error
print("The status code is \(statusCode)")
// è¾“å‡º "The status code is 404"
print("The status message is \(statusMessage)")
// è¾“å‡º "The status message is Not Found"


//å¦‚æœä½ åªéœ€è¦ä¸€éƒ¨åˆ†å…ƒç»„å€¼ï¼Œåˆ†è§£çš„æ—¶å€™å¯ä»¥æŠŠè¦å¿½ç•¥çš„éƒ¨åˆ†ç”¨ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰æ ‡è®°
let (justTheStatusCode, _) = http404Error
print("The status code is \(justTheStatusCode)")
// è¾“å‡º "The status code is 404"

//å¯ä»¥é€šè¿‡ä¸‹æ ‡æ¥è®¿é—®å…ƒç»„ä¸­çš„å•ä¸ªå…ƒç´ ï¼Œä¸‹æ ‡ä»é›¶å¼€å§‹
print("The status code is \(http404Error.0)")
// è¾“å‡º "The status code is 404"
print("The status message is \(http404Error.1)")
// è¾“å‡º "The status message is Not Found"


//å¯ä»¥åœ¨å®šä¹‰å…ƒç»„çš„æ—¶å€™ç»™å•ä¸ªå…ƒç´ å‘½å
let http200Status = (statusCode: 200, description: "OK")
//é€šè¿‡åå­—æ¥è·å–è¿™äº›å…ƒç´ çš„å€¼
print("The status code is \(http200Status.statusCode)")
// è¾“å‡º "The status code is 200"
print("The status message is \(http200Status.description)")
// è¾“å‡º "The status message is OK"

```

### å¯é€‰ç±»å‹optionals
å¤„ç†å€¼å¯èƒ½ç¼ºå¤±çš„æƒ…å†µ

>C å’Œ Objective-C ä¸­å¹¶æ²¡æœ‰å¯é€‰ç±»å‹è¿™ä¸ªæ¦‚å¿µã€‚æœ€æ¥è¿‘çš„æ˜¯ Objective-C ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä¸€ä¸ªæ–¹æ³•è¦ä¸è¿”å›ä¸€ä¸ªå¯¹è±¡è¦ä¸è¿”å›nilï¼Œnilè¡¨ç¤ºâ€œç¼ºå°‘ä¸€ä¸ªåˆæ³•çš„å¯¹è±¡â€ã€‚ç„¶è€Œï¼Œè¿™åªå¯¹å¯¹è±¡èµ·ä½œç”¨â€”â€”å¯¹äºç»“æ„ä½“ï¼ŒåŸºæœ¬çš„ C ç±»å‹æˆ–è€…æšä¸¾ç±»å‹ä¸èµ·ä½œç”¨ã€‚å¯¹äºè¿™äº›ç±»å‹ï¼ŒObjective-C æ–¹æ³•ä¸€èˆ¬ä¼šè¿”å›ä¸€ä¸ªç‰¹æ®Šå€¼ï¼ˆæ¯”å¦‚NSNotFoundï¼‰æ¥æš—ç¤ºå€¼ç¼ºå¤±ã€‚è¿™ç§æ–¹æ³•å‡è®¾æ–¹æ³•çš„è°ƒç”¨è€…çŸ¥é“å¹¶è®°å¾—å¯¹ç‰¹æ®Šå€¼è¿›è¡Œåˆ¤æ–­ã€‚ç„¶è€Œï¼ŒSwift çš„å¯é€‰ç±»å‹å¯ä»¥è®©ä½ æš—ç¤ºä»»æ„ç±»å‹çš„å€¼ç¼ºå¤±ï¼Œå¹¶ä¸éœ€è¦ä¸€ä¸ªç‰¹æ®Šå€¼ã€‚

example:
Swift çš„ Int ç±»å‹æœ‰ä¸€ç§æ„é€ å™¨ï¼Œä½œç”¨æ˜¯å°†ä¸€ä¸ª String å€¼è½¬æ¢æˆä¸€ä¸ª Int å€¼ã€‚ç„¶è€Œï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­—ç¬¦ä¸²éƒ½å¯ä»¥è½¬æ¢æˆä¸€ä¸ªæ•´æ•°ã€‚å­—ç¬¦ä¸² "123" å¯ä»¥è¢«è½¬æ¢æˆæ•°å­— 123 ï¼Œä½†æ˜¯å­—ç¬¦ä¸² "hello, world" ä¸è¡Œã€‚

```swift
let possibleNumber = "123"
let convertedNumber = Int(possibleNumber)
// convertedNumber è¢«æ¨æµ‹ä¸ºç±»å‹ "Int?"ï¼Œ æˆ–è€…ç±»å‹ "optional Int"
// é—®å·æš—ç¤ºåŒ…å«çš„å€¼æ˜¯å¯é€‰ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´å¯èƒ½åŒ…å« Int å€¼ä¹Ÿå¯èƒ½ä¸åŒ…å«å€¼ã€‚ï¼ˆä¸èƒ½åŒ…å«å…¶ä»–ä»»ä½•å€¼æ¯”å¦‚ Bool å€¼æˆ–è€… String å€¼ã€‚åªèƒ½æ˜¯ Int æˆ–è€…ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ï¼‰
```

### nil
ç»™**å¯é€‰å˜é‡**èµ‹å€¼ä¸ºnilæ¥è¡¨ç¤ºå®ƒæ²¡æœ‰å€¼

```swift
var serverResponseCode: Int? = 404
// serverResponseCode åŒ…å«ä¸€ä¸ªå¯é€‰çš„ Int å€¼ 404
serverResponseCode = nil
// serverResponseCode ç°åœ¨ä¸åŒ…å«å€¼
```

nilä¸èƒ½ç”¨äºéå¯é€‰çš„å¸¸é‡å’Œå˜é‡ã€‚å¦‚æœä½ çš„ä»£ç ä¸­æœ‰å¸¸é‡æˆ–è€…å˜é‡éœ€è¦å¤„ç†å€¼ç¼ºå¤±çš„æƒ…å†µï¼Œè¯·æŠŠå®ƒä»¬å£°æ˜æˆå¯¹åº”çš„å¯é€‰ç±»å‹ã€‚

>Swift çš„ nil å’Œ Objective-C ä¸­çš„ nil å¹¶ä¸ä¸€æ ·ã€‚åœ¨ Objective-C ä¸­ï¼Œnil æ˜¯ä¸€ä¸ªæŒ‡å‘ä¸å­˜åœ¨å¯¹è±¡çš„æŒ‡é’ˆã€‚åœ¨ Swift ä¸­ï¼Œnil ä¸æ˜¯æŒ‡é’ˆâ€”â€”å®ƒæ˜¯ä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œç”¨æ¥è¡¨ç¤ºå€¼ç¼ºå¤±ã€‚ä»»ä½•ç±»å‹çš„å¯é€‰çŠ¶æ€éƒ½å¯ä»¥è¢«è®¾ç½®ä¸º nilï¼Œä¸åªæ˜¯å¯¹è±¡ç±»å‹ã€‚


å¼ºåˆ¶è§£æ
åœ¨å¯é€‰çš„åå­—åé¢åŠ ä¸€ä¸ªæ„Ÿå¹å·ï¼ˆ!ï¼‰æ¥è·å–å€¼

```swift
if convertedNumber != nil {
    print("convertedNumber has an integer value of \(convertedNumber!).")
}

```
å¯é€‰ç»‘å®š
åˆ¤æ–­å¯é€‰ç±»å‹æ˜¯å¦åŒ…å«å€¼ï¼Œå¦‚æœåŒ…å«å°±æŠŠå€¼èµ‹ç»™ä¸€ä¸ªä¸´æ—¶å¸¸é‡æˆ–è€…å˜é‡

```swift
if let constantName = someOptional {
    statements
}


let possibleNumber = "123"

//è¿™æ®µä»£ç å¯ä»¥è¢«ç†è§£ä¸ºï¼š
//â€œå¦‚æœ Int(possibleNumber) è¿”å›çš„å¯é€‰ Int åŒ…å«ä¸€ä¸ªå€¼ï¼Œåˆ›å»ºä¸€ä¸ªå«åš actualNumber çš„æ–°å¸¸é‡å¹¶å°†å¯é€‰åŒ…å«çš„å€¼èµ‹ç»™å®ƒã€‚â€
if let actualNumber = Int(possibleNumber) {
    print("\'\(possibleNumber)\' has an integer value of \(actualNumber)")
} else {
    print("\'\(possibleNumber)\' could not be converted to an integer")
}
// è¾“å‡º "'123' has an integer value of 123"

```

### éšå¼è§£æå¯é€‰ç±»å‹
æœ‰æ—¶å€™åœ¨ç¨‹åºæ¶æ„ä¸­ï¼Œç¬¬ä¸€æ¬¡è¢«èµ‹å€¼ä¹‹åï¼Œå¯ä»¥ç¡®å®šä¸€ä¸ªå¯é€‰ç±»å‹æ€»ä¼šæœ‰å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯æ¬¡éƒ½è¦åˆ¤æ–­å’Œè§£æå¯é€‰å€¼æ˜¯éå¸¸ä½æ•ˆçš„ï¼Œå› ä¸ºå¯ä»¥ç¡®å®šå®ƒæ€»ä¼šæœ‰å€¼ã€‚

è¿™ç§ç±»å‹çš„å¯é€‰çŠ¶æ€è¢«å®šä¹‰ä¸ºéšå¼è§£æå¯é€‰ç±»å‹ï¼ˆimplicitly unwrapped optionalsï¼‰ã€‚æŠŠæƒ³è¦ç”¨ä½œå¯é€‰çš„ç±»å‹çš„åé¢çš„é—®å·ï¼ˆString?ï¼‰æ”¹æˆæ„Ÿå¹å·ï¼ˆString!ï¼‰æ¥å£°æ˜ä¸€ä¸ª**éšå¼è§£æå¯é€‰ç±»å‹**ã€‚

éšå¼è§£æå¯é€‰ç±»å‹ä¸»è¦è¢«ç”¨åœ¨ Swift ä¸­ç±»çš„æ„é€ è¿‡ç¨‹ä¸­ï¼š


```swift

let possibleString: String? = "An optional string."
let forcedString: String = possibleString! // éœ€è¦æ„Ÿå¹å·æ¥è·å–å€¼

let assumedString: String! = "An implicitly unwrapped optional string."
let implicitString: String = assumedString  // ä¸éœ€è¦æ„Ÿå¹å·

```



## æ§åˆ¶æµ

ä½¿ç”¨ if å’Œ switch æ¥è¿›è¡Œæ¡ä»¶æ“ä½œï¼Œä½¿ç”¨ for-inã€ forã€ while å’Œ repeat-while æ¥è¿›è¡Œå¾ªç¯ã€‚åŒ…è£¹æ¡ä»¶å’Œå¾ªç¯å˜é‡æ‹¬å·å¯ä»¥çœç•¥ï¼Œä½†æ˜¯è¯­å¥ä½“çš„å¤§æ‹¬å·æ˜¯å¿…é¡»çš„ã€‚


```swift
let individualScores = [75, 43, 103, 87, 12]
var teamScore = 0
for score in individualScores {
    if score > 50 {
        teamScore += 3
    } else {
        teamScore += 1
    }
}
print(teamScore)

```


ä½¿ç”¨ if å’Œ let æ¥å¤„ç†å€¼ç¼ºå¤±çš„æƒ…å†µã€‚è¿™äº›å€¼å¯ç”±å¯é€‰å€¼æ¥ä»£è¡¨ã€‚ä¸€ä¸ªå¯é€‰çš„å€¼æ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼æˆ–è€…æ˜¯ nil ä»¥è¡¨ç¤ºå€¼ç¼ºå¤±ã€‚åœ¨ç±»å‹åé¢åŠ ä¸€ä¸ªé—®å·æ¥æ ‡è®°è¿™ä¸ªå˜é‡çš„å€¼æ˜¯å¯é€‰çš„ã€‚


```swift
//ï¼Ÿæ ‡è®°å¯é€‰optional
var optionalString: String? = "Hello"
print(optionalString == nil)

//var optionalName: String? = nil
var optionalName: String? = "John Appleseed"
var greeting = "Hello!"

if let name = optionalName {
    greeting = "Hello, \(name)"
}else{
    greeting = "Hello no name"
}
print(greeting)
//Hello, John Appleseed

```

å¦ä¸€ç§å¤„ç†å¯é€‰å€¼çš„æ–¹æ³•æ˜¯é€šè¿‡ä½¿ç”¨ ?? æ“ä½œç¬¦æ¥æä¾›ä¸€ä¸ªé»˜è®¤å€¼ã€‚å¦‚æœå¯é€‰å€¼ç¼ºå¤±çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼æ¥ä»£æ›¿ã€‚

```swift
let nickName: String? = nil
let fullName: String = "John Appleseed"
let informalGreeting = "Hi \(nickName ?? fullName)"
//Hi John Appleseed
```

switch æ”¯æŒä»»æ„ç±»å‹çš„æ•°æ®ä»¥åŠå„ç§æ¯”è¾ƒæ“ä½œâ€”â€”ä¸ä»…ä»…æ˜¯æ•´æ•°ä»¥åŠæµ‹è¯•ç›¸ç­‰ï¼Œ
defaultè¯­å¥å¿…é¡»è¦æœ‰ï¼š
è¿è¡Œ switch ä¸­åŒ¹é…åˆ°çš„å­å¥ä¹‹åï¼Œç¨‹åºä¼šé€€å‡º switch è¯­å¥ï¼Œå¹¶ä¸ä¼šç»§ç»­å‘ä¸‹è¿è¡Œï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨æ¯ä¸ªå­å¥ç»“å°¾å†™ breakã€‚
```swift
let vegetable = "red pepper"
switch vegetable {
case "celery":
    print("Add some raisins and make ants on a log.")
case "cucumber", "watercress":
    print("That would make a good tea sandwich.")
case let x where x.hasSuffix("pepper")://åç¼€
    print("Is it a spicy \(x)?")
default:
    print("Everything tastes good in soup.")
}
//Is it a spicy red pepper?
```



fallthroughï¼š Cé£æ ¼çš„è´¯ç©¿çš„ç‰¹æ€§

```swift
let integerToDescribe = 5
var description = "The number \(integerToDescribe) is"
switch integerToDescribe {
case 2, 3, 5, 7, 11, 13, 17, 19:
    description += " a prime number, and also"
    fallthrough
default:
    description += " an integer."
}
print(description)
// è¾“å‡º "The number 5 is a prime number, and also an integer."
```




ä½¿ç”¨ for-in æ¥éå†å­—å…¸ï¼Œéœ€è¦ä¸¤ä¸ªå˜é‡æ¥è¡¨ç¤ºæ¯ä¸ªé”®å€¼å¯¹ã€‚å­—å…¸æ˜¯ä¸€ä¸ªæ— åºçš„é›†åˆï¼Œæ‰€ä»¥ä»–ä»¬çš„é”®å’Œå€¼ä»¥ä»»æ„é¡ºåºè¿­ä»£ç»“æŸ

```swift
let interestingNumbers = [
    "Prime": [2, 3, 5, 7, 11, 13],
    "Fibonacci": [1, 1, 2, 3, 5, 8],
    "Square": [1, 4, 9, 16, 25],
]
var largest = 0
var largestKind:String = ""

for (kind, numbers) in interestingNumbers {
    print(kind)
    print(numbers)
    for number in numbers {
        if number > largest {
            largest = number
            largestKind = kind
        }
    }
}

print("the largest is \(largest)")
print("the largestKind is \(largestKind)")
```


ä½¿ç”¨ while æ¥é‡å¤è¿è¡Œä¸€æ®µä»£ç ç›´åˆ°ä¸æ»¡è¶³æ¡ä»¶ã€‚
å¾ªç¯æ¡ä»¶ä¹Ÿå¯ä»¥åœ¨ç»“å°¾ï¼Œrepeat-whileä¿è¯èƒ½è‡³å°‘å¾ªç¯ä¸€æ¬¡ã€‚


```swift
var n = 2
while n < 100 {
    n = n * 2
}
print(n)

var m = 2
repeat {
    m = m * 2
} while m < 100
print(m)

//åœ¨å¾ªç¯ä¸­ä½¿ç”¨ ..< æ¥è¡¨ç¤ºèŒƒå›´
var total = 0
for i in 0..<4 {
    total += i
}
print(total)

//ä½¿ç”¨ ..< åˆ›å»ºçš„èŒƒå›´ä¸åŒ…å«ä¸Šç•Œï¼Œå¦‚æœæƒ³åŒ…å«çš„è¯éœ€è¦ä½¿ç”¨ ...
var total_ = 0
for i in 0...4 {
    total_ += i
}
print(total_)

```

## å‡½æ•°

### å£°æ˜
ä½¿ç”¨ func æ¥å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨åå­—å’Œå‚æ•°æ¥è°ƒç”¨å‡½æ•°ã€‚ä½¿ç”¨ -> æ¥æŒ‡å®šå‡½æ•°è¿”å›å€¼çš„ç±»å‹

```swift
func greet(person: String, day: String) -> String {
    return "Hello \(person), today is \(day)."
}
var result = greet(person:"Bob", day: "Tuesday")
print(result)

//é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°ä½¿ç”¨å®ƒä»¬çš„å‚æ•°åç§°ä½œä¸ºå®ƒä»¬å‚æ•°çš„æ ‡ç­¾
//åœ¨å‚æ•°åç§°å‰å¯ä»¥è‡ªå®šä¹‰å‚æ•°æ ‡ç­¾ï¼Œæˆ–è€…ä½¿ç”¨ _ è¡¨ç¤ºä¸ä½¿ç”¨å‚æ•°æ ‡ç­¾ã€‚
func greet(_ person: String, on day: String) -> String {
    return "Hello \(person), today is \(day)."
}
var result2 = greet("John", on: "Wednesday")
print(result2)

```


### å¤šé‡è¿”å›å€¼å‡½æ•° 
ä½¿ç”¨å…ƒç»„æ¥è®©ä¸€ä¸ªå‡½æ•°è¿”å›å¤šä¸ªå€¼
è¯¥å…ƒç»„çš„å…ƒç´ å¯ä»¥ç”¨åç§°æˆ–æ•°å­—æ¥è¡¨ç¤ºã€‚


```swift
func calculateStatistics(scores: [Int]) -> (min: Int, max: Int, sum: Int) {
    var min = scores[0]
    var max = scores[0]
    var sum = 0

    for score in scores {
        if score > max {
            max = score
        } else if score < min {
            min = score
        }
        sum += score
    }

    return (min, max, sum)
}
let statistics = calculateStatistics(scores:[10, 10, 100, 1, 9])
print(statistics.sum)
print(statistics.2)
print(statistics.max)
print(statistics.1)
print(statistics.min)
print(statistics.0)
```

å¯é€‰å…ƒç»„è¿”å›ç±»å‹
å¦‚æœå‡½æ•°è¿”å›çš„å…ƒç»„ç±»å‹æœ‰å¯èƒ½æ•´ä¸ªå…ƒç»„éƒ½â€œæ²¡æœ‰å€¼â€ï¼Œä½ å¯ä»¥ä½¿ç”¨å¯é€‰çš„ï¼ˆ optional ï¼‰ å…ƒç»„è¿”å›ç±»å‹åæ˜ æ•´ä¸ªå…ƒç»„å¯ä»¥æ˜¯nilçš„äº‹å®

### é»˜è®¤å‚æ•°å€¼

```swift
func someFunction(parameterWithoutDefault: Int, parameterWithDefault: Int = 12) {
    // å¦‚æœä½ åœ¨è°ƒç”¨æ—¶å€™ä¸ä¼ ç¬¬äºŒä¸ªå‚æ•°ï¼ŒparameterWithDefault ä¼šå€¼ä¸º 12 ä¼ å…¥åˆ°å‡½æ•°ä½“ä¸­ã€‚
}
someFunction(parameterWithoutDefault: 3, parameterWithDefault: 6) // parameterWithDefault = 6
someFunction(parameterWithoutDefault: 4) // parameterWithDefault = 12
```

### å¯å˜å‚æ•°
å‡½æ•°å¯ä»¥å¸¦æœ‰å¯å˜ä¸ªæ•°çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°åœ¨å‡½æ•°å†…è¡¨ç°ä¸ºæ•°ç»„çš„å½¢å¼ï¼š


```swift
func sumOf(numbers: Int...) -> Int {
    var sum = 0
    for number in numbers {
        sum += number
    }
    return sum
}
sumOf()
sumOf(numbers: 42, 597, 12)
```

### è¾“å…¥è¾“å‡ºå‚æ•° inout
åœ¨å‚æ•°å®šä¹‰å‰åŠ  `inout` å…³é”®å­—
ä¸€ä¸ªè¾“å…¥è¾“å‡ºå‚æ•°æœ‰ä¼ å…¥å‡½æ•°çš„å€¼ï¼Œè¿™ä¸ªå€¼è¢«å‡½æ•°ä¿®æ”¹ï¼Œç„¶åè¢«ä¼ å‡ºå‡½æ•°ï¼Œæ›¿æ¢åŸæ¥çš„å€¼
ä½ åªèƒ½ä¼ é€’å˜é‡ç»™è¾“å…¥è¾“å‡ºå‚æ•°ã€‚ä½ ä¸èƒ½ä¼ å…¥å¸¸é‡æˆ–è€…å­—é¢é‡ï¼Œå› ä¸ºè¿™äº›é‡æ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„ã€‚

å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºè¾“å…¥è¾“å‡ºå‚æ•°æ—¶ï¼Œéœ€è¦åœ¨å‚æ•°åå‰åŠ  `&` ç¬¦ï¼Œè¡¨ç¤ºè¿™ä¸ªå€¼å¯ä»¥è¢«å‡½æ•°ä¿®æ”¹ã€‚ç±»ä¼¼Cè¯­è¨€

>æ³¨æ„ è¾“å…¥è¾“å‡ºå‚æ•°ä¸èƒ½æœ‰é»˜è®¤å€¼ï¼Œè€Œä¸”å¯å˜å‚æ•°ä¸èƒ½ç”¨ `inout` æ ‡è®°ã€‚


```swift
func swapTwoInts(_ a: inout Int, _ b: inout Int) {
    let temporaryA = a
    a = b
    b = temporaryA
}

var someInt = 3
var anotherInt = 107
//æ³¨æ„å‚æ•°å‰çš„&ç¬¦å·
swapTwoInts(&someInt, &anotherInt)
print("someInt is now \(someInt), and anotherInt is now \(anotherInt)")
// æ‰“å° "someInt is now 107, and anotherInt is now 3"
```


### å‡½æ•°ç±»å‹
æ¯ä¸ªå‡½æ•°éƒ½æœ‰ç§ç‰¹å®šçš„å‡½æ•°ç±»å‹ï¼Œå‡½æ•°çš„ç±»å‹ç”±å‡½æ•°çš„å‚æ•°ç±»å‹å’Œè¿”å›ç±»å‹ç»„æˆ



```swift
//è¿™ä¸¤ä¸ªå‡½æ•°çš„ç±»å‹æ˜¯ (Int, Int) -> Int
func addTwoInts(_ a: Int, _ b: Int) -> Int {
    return a + b
}
func multiplyTwoInts(_ a: Int, _ b: Int) -> Int {
    return a * b
}


//è¿™ä¸ªå‡½æ•°çš„ç±»å‹æ˜¯ï¼š() -> Void
func printHelloWorld() {
    print("hello, world")
}
```


### ä½¿ç”¨å‡½æ•°ç±»å‹
ä½¿ç”¨å‡½æ•°ç±»å‹å°±åƒä½¿ç”¨å…¶ä»–ç±»å‹ä¸€æ ·ã€‚
ä¾‹å¦‚ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªç±»å‹ä¸ºå‡½æ•°çš„å¸¸é‡æˆ–å˜é‡ï¼Œå¹¶å°†é€‚å½“çš„å‡½æ•°èµ‹å€¼ç»™å®ƒï¼š

```swift
//â€å®šä¹‰ä¸€ä¸ªå«åš mathFunction çš„å˜é‡ï¼Œç±»å‹æ˜¯â€˜ä¸€ä¸ªæœ‰ä¸¤ä¸ª Int å‹çš„å‚æ•°å¹¶è¿”å›ä¸€ä¸ª Int å‹çš„å€¼çš„å‡½æ•°â€™ï¼Œå¹¶è®©è¿™ä¸ªæ–°å˜é‡æŒ‡å‘ addTwoInts å‡½æ•°â€ã€‚
var mathFunction: (Int, Int) -> Int = addTwoInts


//ç°åœ¨ï¼Œä½ å¯ä»¥ç”¨ mathFunction æ¥è°ƒç”¨è¢«èµ‹å€¼çš„å‡½æ•°äº†ï¼š
print("Result: \(mathFunction(2, 3))")
// Prints "Result: 5"

```

æœ‰ç›¸åŒåŒ¹é…ç±»å‹çš„ä¸åŒå‡½æ•°å¯ä»¥è¢«èµ‹å€¼ç»™åŒä¸€ä¸ªå˜é‡ï¼Œå°±åƒéå‡½æ•°ç±»å‹çš„å˜é‡ä¸€æ ·ï¼š

```swift
mathFunction = multiplyTwoInts
print("Result: \(mathFunction(2, 3))")
// Prints "Result: 6"
```

å°±åƒå…¶ä»–ç±»å‹ä¸€æ ·ï¼Œå½“èµ‹å€¼ä¸€ä¸ªå‡½æ•°ç»™å¸¸é‡æˆ–å˜é‡æ—¶ï¼Œä½ å¯ä»¥è®© Swift æ¥æ¨æ–­å…¶å‡½æ•°ç±»å‹:

```swift
let anotherMathFunction = addTwoInts
// anotherMathFunction è¢«æ¨æ–­ä¸º (Int, Int) -> Int ç±»å‹
```


### åµŒå¥—å‡½æ•°ï¼ˆnested functionsï¼‰
è¢«åµŒå¥—çš„å‡½æ•°å¯ä»¥è®¿é—®å¤–ä¾§å‡½æ•°çš„å˜é‡ï¼Œä½ å¯ä»¥ä½¿ç”¨åµŒå¥—å‡½æ•°æ¥é‡æ„ä¸€ä¸ªå¤ªé•¿æˆ–è€…å¤ªå¤æ‚çš„å‡½æ•°ã€‚

```swift
func returnFifteen() -> Int {
    var y = 10
    func add() {
        y += 5
    }
    add()
    return y
}
print("returnFifteen:")
print(returnFifteen())
```

### å‡½æ•°ä½œä¸ºè¿”å›å€¼
å¯ä»¥ç”¨å‡½æ•°ç±»å‹ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„è¿”å›ç±»å‹ã€‚ä½ éœ€è¦åšçš„æ˜¯åœ¨è¿”å›ç®­å¤´`->`åå†™ä¸€ä¸ªå®Œæ•´çš„å‡½æ•°ç±»å‹ã€‚

```swift
//è¿”å›çš„addOneå‡½æ•°ç±»å‹æ˜¯ (Int) -> Int
func makeIncrementer() -> ((Int) -> Int) {
    func addOne(number: Int) -> Int {
        return 1 + number
    }
    return addOne
}
//incrementå˜é‡æŒ‡å‘makeIncrementerå‡½æ•°è¿”å›çš„addOneå‡½æ•°
var increment = makeIncrementer()
//ä¼ å…¥addOneå‡½æ•°çš„å‚æ•°ç±»å‹Intï¼Œè¿”å›Int
increment(7)
//8
```

å¦ä¸€ä¸ªä¾‹å­ï¼š

```swift
func stepForward(_ input: Int) -> Int {
    return input + 1
}
func stepBackward(_ input: Int) -> Int {
    return input - 1
}

//è¿”å›çš„å‡½æ•°ç±»å‹(Int) -> Int
func chooseStepFunction(backward: Bool) -> (Int) -> Int {
    return backward ? stepBackward : stepForward
}

//ç°åœ¨å¯ä»¥ç”¨ chooseStepFunction(backward:) æ¥è·å¾—ä¸¤ä¸ªå‡½æ•°å…¶ä¸­çš„ä¸€ä¸ª
let moveNearerToZero = chooseStepFunction(backward: true)
// moveNearerToZero ç°åœ¨æŒ‡å‘ stepBackward() å‡½æ•°ã€‚

//è¾“å‡º4
moveNearerToZero(5)

```


### å‡½æ•°ä½œä¸ºå‚æ•°
å‡½æ•°ä¹Ÿå¯ä»¥å½“åšå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°

```swift
//ä¼ å…¥conditionå‡½æ•°çš„ç±»å‹æ˜¯(Int) -> Bool)
func hasAnyMatches(list: [Int], condition: (Int) -> Bool) -> Bool {
    for item in list {
        if condition(item) {
            return true
        }
    }
    return false
}

func lessThanTen(number: Int) -> Bool {
    return number < 10
}
var numbers = [20, 19, 7, 12]
//lessThanTenä½œä¸ºconditionå‡½æ•°ä¼ å…¥hasAnyMatcheså‡½æ•°
hasAnyMatches(list: numbers, condition: lessThanTen)
//true
```

## é—­åŒ…ï¼ˆClosuresï¼‰


é—­åŒ…æ˜¯è‡ªåŒ…å«çš„å‡½æ•°ä»£ç å—ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­è¢«ä¼ é€’å’Œä½¿ç”¨ã€‚Swift ä¸­çš„é—­åŒ…ä¸ C å’Œ Objective-C ä¸­çš„ä»£ç å—ï¼ˆblocksï¼‰ä»¥åŠå…¶ä»–ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­çš„åŒ¿åå‡½æ•°æ¯”è¾ƒç›¸ä¼¼ã€‚

é—­åŒ…å¯ä»¥æ•è·å’Œå­˜å‚¨å…¶æ‰€åœ¨ä¸Šä¸‹æ–‡ä¸­ä»»æ„å¸¸é‡å’Œå˜é‡çš„å¼•ç”¨ã€‚è¢«ç§°ä¸ºåŒ…è£¹å¸¸é‡å’Œå˜é‡ã€‚ Swift ä¼šä¸ºä½ ç®¡ç†åœ¨æ•è·è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ‰€æœ‰å†…å­˜æ“ä½œã€‚

åœ¨å‡½æ•°ç« èŠ‚ä¸­ä»‹ç»çš„å…¨å±€å’ŒåµŒå¥—å‡½æ•°å®é™…ä¸Šä¹Ÿæ˜¯ç‰¹æ®Šçš„é—­åŒ…ï¼Œé—­åŒ…é‡‡å–å¦‚ä¸‹ä¸‰ç§å½¢å¼ä¹‹ä¸€ï¼š

* å…¨å±€å‡½æ•°æ˜¯ä¸€ä¸ªæœ‰åå­—ä½†ä¸ä¼šæ•è·ä»»ä½•å€¼çš„é—­åŒ…
* åµŒå¥—å‡½æ•°æ˜¯ä¸€ä¸ªæœ‰åå­—å¹¶å¯ä»¥æ•è·å…¶å°é—­å‡½æ•°åŸŸå†…å€¼çš„é—­åŒ…
* é—­åŒ…è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªåˆ©ç”¨è½»é‡çº§è¯­æ³•æ‰€å†™çš„å¯ä»¥æ•è·å…¶ä¸Šä¸‹æ–‡ä¸­å˜é‡æˆ–å¸¸é‡å€¼çš„åŒ¿åé—­åŒ…

Swift çš„é—­åŒ…è¡¨è¾¾å¼æ‹¥æœ‰ç®€æ´çš„é£æ ¼ï¼Œå¹¶é¼“åŠ±åœ¨å¸¸è§åœºæ™¯ä¸­è¿›è¡Œè¯­æ³•ä¼˜åŒ–ï¼Œä¸»è¦ä¼˜åŒ–å¦‚ä¸‹ï¼š

* åˆ©ç”¨ä¸Šä¸‹æ–‡æ¨æ–­å‚æ•°å’Œè¿”å›å€¼ç±»å‹
* éšå¼è¿”å›å•è¡¨è¾¾å¼é—­åŒ…ï¼Œå³å•è¡¨è¾¾å¼é—­åŒ…å¯ä»¥çœç•¥ return å…³é”®å­—
* å‚æ•°åç§°ç¼©å†™
* å°¾éšé—­åŒ…è¯­æ³•

example:
`sorted(by:) `æ–¹æ³•æ¥å—ä¸€ä¸ªé—­åŒ…ï¼Œè¯¥é—­åŒ…å‡½æ•°éœ€è¦ä¼ å…¥ä¸æ•°ç»„å…ƒç´ ç±»å‹ç›¸åŒçš„ä¸¤ä¸ªå€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¸ƒå°”ç±»å‹å€¼æ¥è¡¨æ˜å½“æ’åºç»“æŸåä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ’åœ¨ç¬¬äºŒä¸ªå‚æ•°å‰é¢è¿˜æ˜¯åé¢
å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°å€¼å‡ºç°åœ¨ç¬¬äºŒä¸ªå‚æ•°å€¼å‰é¢ï¼Œæ’åºé—­åŒ…å‡½æ•°éœ€è¦è¿”å›trueï¼Œåä¹‹è¿”å›falseã€‚
è¯¥ä¾‹å­å¯¹ä¸€ä¸ª String ç±»å‹çš„æ•°ç»„è¿›è¡Œæ’åºï¼Œå› æ­¤æ’åºé—­åŒ…å‡½æ•°ç±»å‹éœ€ä¸º (String, String) -> Boolã€‚

```swift
//å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆs1ï¼‰å¤§äºç¬¬äºŒä¸ªå­—ç¬¦ä¸²ï¼ˆs2ï¼‰ï¼Œbackward(_:_:) å‡½æ•°ä¼šè¿”å› trueï¼Œè¡¨ç¤ºåœ¨sortedåçš„æ•°ç»„ä¸­ s1 åº”è¯¥å‡ºç°åœ¨ s2 å‰
func backward(_ s1: String, _ s2: String) -> Bool {
    return s1 > s2
}

var reversedNames = names.sorted(by: backward)
// reversedNames ä¸º ["Ewa", "Daniella", "Chris", "Barry", "Alex"]

```


### é—­åŒ…è¡¨è¾¾å¼è¯­æ³•
é—­åŒ…è¡¨è¾¾å¼å‚æ•° å¯ä»¥æ˜¯ `in-out` å‚æ•°ï¼Œä½†ä¸èƒ½è®¾å®šé»˜è®¤å€¼ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å…·åçš„å¯å˜å‚æ•°ï¼ˆè¯‘è€…æ³¨ï¼šä½†æ˜¯å¦‚æœå¯å˜å‚æ•°ä¸æ”¾åœ¨å‚æ•°åˆ—è¡¨çš„æœ€åä¸€ä½çš„è¯ï¼Œè°ƒç”¨é—­åŒ…çš„æ—¶æ—¶ç¼–è¯‘å™¨å°†æŠ¥é”™ï¼‰ã€‚å…ƒç»„ä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°å’Œè¿”å›å€¼ã€‚


```swift
//é—­åŒ…çš„å‡½æ•°ä½“éƒ¨åˆ†ç”±å…³é”®å­—inå¼•å…¥ã€‚è¯¥å…³é”®å­—è¡¨ç¤ºé—­åŒ…çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹å®šä¹‰å·²ç»å®Œæˆï¼Œé—­åŒ…å‡½æ•°ä½“å³å°†å¼€å§‹ã€‚
{ (parameters) -> returnType in
    statements
}

//ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†ä¹‹å‰ backward(_:_:) å‡½æ•°å¯¹åº”çš„é—­åŒ…è¡¨è¾¾å¼ç‰ˆæœ¬çš„ä»£ç 
reversedNames = names.sorted(by: { (s1: String, s2: String) -> Bool in
    return s1 > s2
})

```

### æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­ç±»å‹
å› ä¸ºæ’åºé—­åŒ…å‡½æ•°æ˜¯ä½œä¸º sorted(by:) æ–¹æ³•çš„å‚æ•°ä¼ å…¥çš„ï¼ŒSwift å¯ä»¥æ¨æ–­å…¶å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹ã€‚sorted(by:) æ–¹æ³•è¢«ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„è°ƒç”¨ï¼Œå› æ­¤å…¶å‚æ•°å¿…é¡»æ˜¯ (String, String) -> Bool ç±»å‹çš„å‡½æ•°ã€‚è¿™æ„å‘³ç€ (String, String) å’Œ Bool ç±»å‹å¹¶ä¸éœ€è¦ä½œä¸ºé—­åŒ…è¡¨è¾¾å¼å®šä¹‰çš„ä¸€éƒ¨åˆ†ã€‚å› ä¸ºæ‰€æœ‰çš„ç±»å‹éƒ½å¯ä»¥è¢«æ­£ç¡®æ¨æ–­ï¼Œè¿”å›ç®­å¤´ï¼ˆ->ï¼‰å’Œå›´ç»•åœ¨å‚æ•°å‘¨å›´çš„æ‹¬å·ä¹Ÿå¯ä»¥è¢«çœç•¥ï¼š


```swift
reversedNames = names.sorted(by: { s1, s2 in return s1 > s2 } )
```

å®é™…ä¸Šï¼Œé€šè¿‡å†…è”é—­åŒ…è¡¨è¾¾å¼æ„é€ çš„é—­åŒ…ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°æˆ–æ–¹æ³•æ—¶ï¼Œæ€»æ˜¯èƒ½å¤Ÿæ¨æ–­å‡ºé—­åŒ…çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ã€‚è¿™æ„å‘³ç€é—­åŒ…ä½œä¸ºå‡½æ•°æˆ–è€…æ–¹æ³•çš„å‚æ•°æ—¶ï¼Œä½ å‡ ä¹ä¸éœ€è¦åˆ©ç”¨å®Œæ•´æ ¼å¼æ„é€ å†…è”é—­åŒ…

### å•è¡¨è¾¾å¼é—­åŒ…éšå¼è¿”å›

å•è¡Œè¡¨è¾¾å¼é—­åŒ…å¯ä»¥é€šè¿‡çœç•¥ return å…³é”®å­—æ¥éšå¼è¿”å›å•è¡Œè¡¨è¾¾å¼çš„ç»“æœ

å¦‚ä¸Šç‰ˆæœ¬çš„ä¾‹å­å¯ä»¥æ”¹å†™ä¸ºï¼š
```swift
reversedNames = names.sorted(by: { s1, s2 in s1 > s2 } )
```

### å‚æ•°åç§°ç¼©å†™

Swift è‡ªåŠ¨ä¸ºå†…è”é—­åŒ…æä¾›äº†å‚æ•°åç§°ç¼©å†™åŠŸèƒ½ï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡ `$0`,`$1`ï¼Œ`$2` æ¥é¡ºåºè°ƒç”¨é—­åŒ…çš„å‚æ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚

```swift
//$0å’Œ$1è¡¨ç¤ºé—­åŒ…ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ª String ç±»å‹çš„å‚æ•°
reversedNames = names.sorted(by: { $0 > $1 } )
```

### è¿ç®—ç¬¦æ–¹æ³•
Swift çš„ String ç±»å‹å®šä¹‰äº†å…³äºå¤§äºå·ï¼ˆ>ï¼‰çš„å­—ç¬¦ä¸²å®ç°ï¼Œå…¶ä½œä¸ºä¸€ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ª String ç±»å‹çš„å‚æ•°å¹¶è¿”å› Bool ç±»å‹çš„å€¼ã€‚è€Œè¿™æ­£å¥½ä¸ sorted(by:) æ–¹æ³•çš„å‚æ•°éœ€è¦çš„å‡½æ•°ç±»å‹ç›¸ç¬¦åˆã€‚å› æ­¤ï¼Œä½ å¯ä»¥ç®€å•åœ°ä¼ é€’ä¸€ä¸ªå¤§äºå·ï¼ŒSwift å¯ä»¥è‡ªåŠ¨æ¨æ–­å‡ºä½ æƒ³ä½¿ç”¨å¤§äºå·çš„å­—ç¬¦ä¸²å‡½æ•°å®ç°ï¼š

```swift
reversedNames = names.sorted(by: >)
```

### å°¾éšé—­åŒ…
å¦‚æœä½ éœ€è¦å°†ä¸€ä¸ªå¾ˆé•¿çš„é—­åŒ…è¡¨è¾¾å¼ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å°¾éšé—­åŒ…æ¥å¢å¼ºå‡½æ•°çš„å¯è¯»æ€§ã€‚å°¾éšé—­åŒ…æ˜¯ä¸€ä¸ªä¹¦å†™åœ¨å‡½æ•°æ‹¬å·ä¹‹åçš„é—­åŒ…è¡¨è¾¾å¼ï¼Œå‡½æ•°æ”¯æŒå°†å…¶ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°è°ƒç”¨ã€‚åœ¨ä½¿ç”¨å°¾éšé—­åŒ…æ—¶ï¼Œä½ ä¸ç”¨å†™å‡ºå®ƒçš„å‚æ•°æ ‡ç­¾ï¼š

```swift
func someFunctionThatTakesAClosure(closure: () -> Void) {
    // å‡½æ•°ä½“éƒ¨åˆ†
    closure()
    print("å‡½æ•°ä½“éƒ¨åˆ†")
}

// ä»¥ä¸‹æ˜¯ä¸ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨
someFunctionThatTakesAClosure(closure: {
    // é—­åŒ…ä¸»ä½“éƒ¨åˆ†
    print("é—­åŒ…ä¸»ä½“éƒ¨åˆ†11")
})

// ä»¥ä¸‹æ˜¯ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œçœç•¥äº†é—­åŒ…åclosure
someFunctionThatTakesAClosure() {
    // é—­åŒ…ä¸»ä½“éƒ¨åˆ†
    print("é—­åŒ…ä¸»ä½“éƒ¨åˆ†22")
}

//è¾“å‡º
//é—­åŒ…ä¸»ä½“éƒ¨åˆ†11
//å‡½æ•°ä½“éƒ¨åˆ†

//é—­åŒ…ä¸»ä½“éƒ¨åˆ†22
//å‡½æ•°ä½“éƒ¨åˆ†
```

ä½œä¸º sorted(by:) æ–¹æ³•å‚æ•°çš„å­—ç¬¦ä¸²æ’åºé—­åŒ…å¯ä»¥æ”¹å†™ä¸ºï¼š
```swift
reversedNames = names.sorted() { $0 > $1 }
```
å¦‚æœé—­åŒ…è¡¨è¾¾å¼æ˜¯å‡½æ•°æˆ–æ–¹æ³•çš„å”¯ä¸€å‚æ•°ï¼Œåˆ™å½“ä½ ä½¿ç”¨å°¾éšé—­åŒ…æ—¶ï¼Œä½ ç”šè‡³å¯ä»¥æŠŠ () çœç•¥æ‰ï¼š

```swift
reversedNames = names.sorted { $0 > $1 }
```

å½“é—­åŒ…éå¸¸é•¿ä»¥è‡³äºä¸èƒ½åœ¨ä¸€è¡Œä¸­è¿›è¡Œä¹¦å†™æ—¶ï¼Œå°¾éšé—­åŒ…å˜å¾—éå¸¸æœ‰ç”¨


```swift
let digitNames = [
    0: "Zero", 1: "One", 2: "Two",   3: "Three", 4: "Four",
    5: "Five", 6: "Six", 7: "Seven", 8: "Eight", 9: "Nine"
]
let numbers_new = [16, 58, 510]


//åœ¨è¯¥ä¾‹ä¸­ï¼Œå±€éƒ¨å˜é‡ number çš„å€¼ç”±é—­åŒ…ä¸­çš„ number å‚æ•°è·å¾—ï¼Œå› æ­¤å¯ä»¥åœ¨é—­åŒ…å‡½æ•°ä½“å†…å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œ(é—­åŒ…æˆ–è€…å‡½æ•°çš„å‚æ•°æ€»æ˜¯å¸¸é‡)ï¼Œé—­åŒ…è¡¨è¾¾å¼æŒ‡å®šäº†è¿”å›ç±»å‹ä¸º Stringï¼Œä»¥è¡¨æ˜å­˜å‚¨æ˜ å°„å€¼çš„æ–°æ•°ç»„ç±»å‹ä¸º Stringã€‚
//map(_:) ä¸ºæ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ è°ƒç”¨äº†ä¸€æ¬¡é—­åŒ…è¡¨è¾¾å¼ã€‚ä½ ä¸éœ€è¦æŒ‡å®šé—­åŒ…çš„è¾“å…¥å‚æ•° number çš„ç±»å‹ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡è¦æ˜ å°„çš„æ•°ç»„ç±»å‹è¿›è¡Œæ¨æ–­,åœ¨è¿™é‡Œå°±æ˜¯intç±»å‹
let strings = numbers_new.map {
    (number) -> String in
    var number = number
    var output = ""
    repeat {
        output = digitNames[number % 10]! + output
        number /= 10
    } while number > 0
    return output
}
print(strings)
// strings å¸¸é‡è¢«æ¨æ–­ä¸ºå­—ç¬¦ä¸²ç±»å‹æ•°ç»„ï¼Œå³ [String]
// å…¶å€¼ä¸º ["OneSix", "FiveEight", "FiveOneZero"]
```

### å€¼æ•è·
é—­åŒ…å¯ä»¥åœ¨å…¶è¢«å®šä¹‰çš„ä¸Šä¸‹æ–‡ä¸­æ•è·å¸¸é‡æˆ–å˜é‡ã€‚å³ä½¿å®šä¹‰è¿™äº›å¸¸é‡å’Œå˜é‡çš„åŸä½œç”¨åŸŸå·²ç»ä¸å­˜åœ¨ï¼Œé—­åŒ…ä»ç„¶å¯ä»¥åœ¨é—­åŒ…å‡½æ•°ä½“å†…å¼•ç”¨å’Œä¿®æ”¹è¿™äº›å€¼ã€‚
Swift ä¸­ï¼Œå¯ä»¥æ•è·å€¼çš„é—­åŒ…çš„æœ€ç®€å•å½¢å¼æ˜¯åµŒå¥—å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰åœ¨å…¶ä»–å‡½æ•°çš„å‡½æ•°ä½“å†…çš„å‡½æ•°ã€‚åµŒå¥—å‡½æ•°å¯ä»¥æ•è·å…¶å¤–éƒ¨å‡½æ•°æ‰€æœ‰çš„å‚æ•°ä»¥åŠå®šä¹‰çš„å¸¸é‡å’Œå˜é‡ã€‚

> ä¸ºäº†ä¼˜åŒ–ï¼Œå¦‚æœä¸€ä¸ªå€¼ä¸ä¼šè¢«é—­åŒ…æ”¹å˜ï¼Œæˆ–è€…åœ¨é—­åŒ…åˆ›å»ºåä¸ä¼šæ”¹å˜ï¼ŒSwift å¯èƒ½ä¼šæ”¹ä¸ºæ•è·å¹¶ä¿å­˜ä¸€ä»½å¯¹å€¼çš„æ‹·è´ã€‚ Swift ä¹Ÿä¼šè´Ÿè´£è¢«æ•è·å˜é‡çš„æ‰€æœ‰å†…å­˜ç®¡ç†å·¥ä½œï¼ŒåŒ…æ‹¬é‡Šæ”¾ä¸å†éœ€è¦çš„å˜é‡ã€‚

example:
åµŒå¥—å‡½æ•°`incrementer()` å¹¶æ²¡æœ‰ä»»ä½•å‚æ•°ï¼Œä½†æ˜¯åœ¨å‡½æ•°ä½“å†…è®¿é—®äº† `runningTotal` å’Œ `amount` å˜é‡ã€‚å®ƒä»å¤–å›´å‡½æ•°æ•è·äº† `runningTotal` å’Œ `amount` å˜é‡çš„**å¼•ç”¨**ã€‚æ•è·å¼•ç”¨ä¿è¯äº† `runningTotal` å’Œ `amount` å˜é‡åœ¨è°ƒç”¨å®Œ `makeIncrementer` åä¸ä¼šæ¶ˆå¤±ï¼Œå¹¶ä¸”ä¿è¯äº†åœ¨ä¸‹ä¸€æ¬¡æ‰§è¡Œ `incrementer` å‡½æ•°æ—¶ï¼Œ`runningTotal` ä¾æ—§å­˜åœ¨ã€‚

```swift
func makeIncrementer(forIncrement amount: Int) -> () -> Int {
    var runningTotal = 0
    func incrementer() -> Int {
        runningTotal += amount
        return runningTotal
    }
    return incrementer
}

let incrementByTen = makeIncrementer(forIncrement: 10)
incrementByTen();//10
incrementByTen();//20
incrementByTen();//30
incrementByTen();//40
```
å¦‚æœä½ åˆ›å»ºäº†å¦ä¸€ä¸ª `incrementer`ï¼Œå®ƒä¼šæœ‰å±äºè‡ªå·±çš„å¼•ç”¨ï¼ŒæŒ‡å‘ä¸€ä¸ªå…¨æ–°ã€ç‹¬ç«‹çš„ `runningTotal` å˜é‡ï¼š

```swift
let incrementBySeven = makeIncrementer(forIncrement: 7)
incrementBySeven()
// è¿”å›çš„å€¼ä¸º7
```

å†æ¬¡è°ƒç”¨åŸæ¥çš„ incrementByTen ä¼šç»§ç»­å¢åŠ å®ƒè‡ªå·±çš„ runningTotal å˜é‡ï¼Œè¯¥å˜é‡å’Œ incrementBySeven ä¸­æ•è·çš„å˜é‡æ²¡æœ‰ä»»ä½•è”ç³»ï¼š


```swift
incrementByTen()
// è¿”å›çš„å€¼ä¸º40
```

>å¦‚æœä½ å°†é—­åŒ…èµ‹å€¼ç»™ä¸€ä¸ªç±»å®ä¾‹çš„å±æ€§ï¼Œå¹¶ä¸”è¯¥é—­åŒ…é€šè¿‡è®¿é—®è¯¥å®ä¾‹æˆ–å…¶æˆå‘˜è€Œæ•è·äº†è¯¥å®ä¾‹ï¼Œä½ å°†åœ¨é—­åŒ…å’Œè¯¥å®ä¾‹é—´åˆ›å»ºä¸€ä¸ªå¾ªç¯å¼ºå¼•ç”¨ã€‚Swift ä½¿ç”¨**æ•è·åˆ—è¡¨**æ¥æ‰“ç ´è¿™ç§å¾ªç¯å¼ºå¼•ç”¨.ç±»ä¼¼javaåŒ¿åå†…éƒ¨ç±»å¼ºå¼•ç”¨å¤–éƒ¨ç±»å®ä¾‹å¼•ç”¨ã€‚

**é—­åŒ…æ˜¯å¼•ç”¨ç±»å‹**
ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ`incrementBySeven` å’Œ `incrementByTen` éƒ½æ˜¯å¸¸é‡ï¼Œä½†æ˜¯è¿™äº›å¸¸é‡æŒ‡å‘çš„é—­åŒ…ä»ç„¶å¯ä»¥å¢åŠ å…¶æ•è·çš„å˜é‡çš„å€¼ã€‚è¿™æ˜¯å› ä¸ºå‡½æ•°å’Œé—­åŒ…éƒ½æ˜¯å¼•ç”¨ç±»å‹ã€‚

æ— è®ºä½ å°†å‡½æ•°æˆ–é—­åŒ…èµ‹å€¼ç»™ä¸€ä¸ªå¸¸é‡è¿˜æ˜¯å˜é‡ï¼Œä½ å®é™…ä¸Šéƒ½æ˜¯å°†å¸¸é‡æˆ–å˜é‡çš„å€¼è®¾ç½®ä¸ºå¯¹åº”å‡½æ•°æˆ–é—­åŒ…çš„å¼•ç”¨ã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒæŒ‡å‘é—­åŒ…çš„**å¼•ç”¨** `incrementByTen` æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œè€Œå¹¶éé—­åŒ…å†…å®¹æœ¬èº«ã€‚

è¿™ä¹Ÿæ„å‘³ç€å¦‚æœä½ å°†é—­åŒ…èµ‹å€¼ç»™äº†ä¸¤ä¸ªä¸åŒçš„å¸¸é‡æˆ–å˜é‡ï¼Œä¸¤ä¸ªå€¼éƒ½ä¼šæŒ‡å‘åŒä¸€ä¸ªé—­åŒ…ï¼š


```swift
let alsoIncrementByTen = incrementByTen
alsoIncrementByTen()
// è¿”å›çš„å€¼ä¸º50
```



### æ•è·åˆ—è¡¨

ä½¿ç”¨æ•è·åˆ—è¡¨ï¼Œé—­åŒ…æ•è·çš„å°†ä¸æ˜¯åŸå§‹å€¼çš„å¼•ç”¨ï¼Œè€Œæ˜¯åœ¨é—­åŒ…å†…éƒ¨ç”Ÿæˆäº†ä¸€ä¸ªåŸå§‹å€¼çš„å‰¯æœ¬

```swift
var a = 0
var b = 0
//å¸¸è§„é—­åŒ…ï¼Œæ•è·å¤–éƒ¨å¼•ç”¨
let closure : () -> () = { print(a, b) }
a = 3
b = 5
closure()// 3 5


var c = 0
var d = 0
//[c,d]å®šä¹‰äº†æ•è·åˆ—è¡¨ã€‚
//ä½¿ç”¨æ•è·åˆ—è¡¨ï¼Œé—­åŒ…æ•è·çš„å°†ä¸æ˜¯åŸå§‹å€¼çš„å¼•ç”¨ï¼Œè€Œæ˜¯åœ¨é—­åŒ…å†…éƒ¨ç”Ÿæˆäº†ä¸€ä¸ªåŸå§‹å€¼çš„copyå‰¯æœ¬
let anotherClosure : () -> () = {  [c, d]  in
    print(c, d)
}

c = 3
d = 7
anotherClosure()// 0 0

```

### é€ƒé€¸é—­åŒ…

Swiftä¸­çš„é—­åŒ…æœ‰ä¸¤ç§ï¼šé€ƒé€¸é—­åŒ…å’Œéé€ƒé€¸é—­åŒ…ã€‚
é€ƒé€¸é—­åŒ…è¡¨ç¤ºé—­åŒ…å°†åœ¨å‡½æ•°è¿”å›ä¹‹åæ‰§è¡Œï¼›è€Œéé€ƒé€¸é—­åŒ…åˆ™è¡¨ç¤ºåœ¨å‡½æ•°è¿”å›å‰æ‰§è¡Œï¼Œå³å‡½æ•°å†…éƒ¨æ‰§è¡Œã€‚

æœ‰2ç§æ–¹æ³•å¯ä»¥è®©é—­åŒ…é€ƒé€¸å…¶æ‰€å¤„çš„å‡½æ•°:

* å¼‚æ­¥æ‰§è¡Œ:å¦‚æœä½ åœ¨ä¸€ä¸ªè°ƒåº¦é˜Ÿåˆ—ä¸­å¼‚æ­¥æ‰§è¡Œé—­åŒ…, é‚£ä¹ˆè¿™ä¸ªé˜Ÿåˆ—å°†ä¼šå¯¹è¿™ä¸ªé—­åŒ…å¼ºå¼•ç”¨, ä½ ä¸çŸ¥é“é—­åŒ…ä»€ä¹ˆæ—¶å€™ä¼šæ‰§è¡Œ, ä¹Ÿæ— æ³•ä¿è¯åœ¨å‡½æ•°æ‰§è¡Œç»“æŸä¹‹åé—­åŒ…ä¼šæ‰§è¡Œå®Œæ¯•

* å­˜å‚¨:å°†é—­åŒ…ä½œä¸ºå…¨å±€çš„å˜é‡æˆ–è€…å±æ€§å­˜å‚¨, æ„å‘³ç€é—­åŒ…åŒæ ·å¯ä»¥é€ƒé€¸


Swift3.0ä¸­ï¼šæ‰€æœ‰çš„é—­åŒ…éƒ½é»˜è®¤ä¸ºéé€ƒé€¸é—­åŒ…ã€‚å¦‚æœéœ€è¦è¡¨ç¤ºé€ƒé€¸é—­åŒ…ï¼Œåˆ™ä½¿ç”¨`@escaping`å…³é”®å­—æ¥ä¿®é¥°é—­åŒ….
æ³¨æ„ï¼šå°†ä¸€ä¸ªé—­åŒ…æ ‡è®°ä¸º `@escaping` æ„å‘³ç€ä½ å¿…é¡»åœ¨é—­åŒ…ä¸­æ˜¾å¼åœ°å¼•ç”¨ã€‚


```swift
//å£°æ˜é—­åŒ…æ•°ç»„å­˜å‚¨é€ƒé€¸é—­åŒ…
var completionHandlers: [() -> Void] = []
//@escapingä¿®é¥°é€ƒé€¸é—­åŒ…
func someFunctionWithEscapingClosure(completionHandler: @escaping () -> Void) {
    completionHandlers.append(completionHandler)
}

//éé€ƒé€¸é—­åŒ…å‚æ•°
func someFunctionWithNonescapingClosure(closure: () -> Void) {
    closure()
}

class SomeClass {
    var x = 10
    func doSomething() {
        //é€ƒé€¸é—­åŒ…ä¸ºå‚æ•°çš„å‡½æ•°ï¼Œé—­åŒ…å°†åœ¨å‡½æ•°è¿”å›ä¹‹åæ‰§è¡Œ
        someFunctionWithEscapingClosure { self.x = 100 }
        //éé€ƒé€¸é—­åŒ…ä¸ºå‚æ•°çš„å‡½æ•°ï¼Œåœ¨å‡½æ•°è¿”å›å‰æ‰§è¡Œ
        someFunctionWithNonescapingClosure { x = 200 }
    }
}

let instance = SomeClass()
instance.doSomething()
print(instance.x)
// è¾“å‡º "200"


completionHandlers[0]()
//æ­¤æ—¶é€ƒé€¸é—­åŒ…æ‰ä¼šæ‰§è¡Œ
print(instance.x)
// è¾“å‡º "100"
```
ç¬¬ä¸€ä¸ªprintè¾“å‡º200ï¼Œå› ä¸ºå½“è°ƒç”¨`doSomethig`çš„æ—¶å€™ï¼Œ`someFunctionWithNonescapingClosure`ä¼šç›´æ¥è°ƒç”¨é—­åŒ…`{x = 200}`,æ­¤æ—¶`instance.x`å˜æˆ200
å½“`completionHandlers[0]()`ä¹‹åï¼Œ`someFunctionWithEscapingClosure`ä¼ å…¥çš„é€ƒé€¸é—­åŒ…æ‰ä¼šçœŸæ­£æ‰§è¡Œï¼Œæ­¤æ—¶`instance.x`å˜æˆ100
å¯ä»¥çœ‹åˆ°ï¼Œ**é€ƒé€¸é—­åŒ…å¼•ç”¨å¤–éƒ¨å®ä¾‹å˜é‡æ—¶å¿…é¡»æ˜¾ç¤ºæŒ‡æ˜self**ï¼Œè€Œæ™®é€šçš„é—­åŒ…å¯ä»¥ç›´æ¥ä½¿ç”¨x

æ˜¾ç„¶ï¼Œé€ƒé€¸é—­åŒ…å¯ä»¥ç”¨äº**å¼‚æ­¥çš„å›è°ƒå¤„ç†**ã€‚

### è‡ªåŠ¨é—­åŒ…

è‡ªåŠ¨é—­åŒ…æ˜¯ä¸€ç§è‡ªåŠ¨åˆ›å»ºçš„é—­åŒ…ï¼Œç”¨äºåŒ…è£…ä¼ é€’ç»™å‡½æ•°ä½œä¸ºå‚æ•°çš„è¡¨è¾¾å¼ã€‚
è¿™ç§é—­åŒ…ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œå½“å®ƒè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šè¿”å›è¢«åŒ…è£…åœ¨å…¶ä¸­çš„è¡¨è¾¾å¼çš„å€¼ã€‚
è¿™ç§ä¾¿åˆ©è¯­æ³•è®©ä½ èƒ½å¤Ÿçœç•¥é—­åŒ…çš„èŠ±æ‹¬å·ï¼Œç”¨ä¸€ä¸ªæ™®é€šçš„è¡¨è¾¾å¼æ¥ä»£æ›¿æ˜¾å¼çš„é—­åŒ…ã€‚

æˆ‘ä»¬ç»å¸¸ä¼šè°ƒç”¨é‡‡ç”¨è‡ªåŠ¨é—­åŒ…çš„å‡½æ•°ï¼Œä½†æ˜¯å¾ˆå°‘å»å®ç°è¿™æ ·çš„å‡½æ•°


è‡ªåŠ¨é—­åŒ…è®©ä½ èƒ½å¤Ÿå»¶è¿Ÿæ±‚å€¼ï¼Œå› ä¸ºç›´åˆ°ä½ è°ƒç”¨è¿™ä¸ªé—­åŒ…ï¼Œä»£ç æ®µæ‰ä¼šè¢«æ‰§è¡Œã€‚å»¶è¿Ÿæ±‚å€¼å¯¹äºé‚£äº›æœ‰å‰¯ä½œç”¨ï¼ˆSide Effectï¼‰å’Œé«˜è®¡ç®—æˆæœ¬çš„ä»£ç æ¥è¯´æ˜¯å¾ˆæœ‰ç›Šå¤„çš„ï¼Œå› ä¸ºå®ƒä½¿å¾—ä½ èƒ½æ§åˆ¶ä»£ç çš„æ‰§è¡Œæ—¶æœº


```swift
var customersInLine = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]
print(customersInLine.count)
// æ‰“å°å‡º "5"

//è¯·æ³¨æ„ï¼ŒcustomerProvider çš„ç±»å‹ä¸æ˜¯ Stringï¼Œè€Œæ˜¯ () -> String
let customerProvider = { customersInLine.remove(at: 0) }
print(customersInLine.count)
// æ‰“å°å‡º "5"

//è°ƒç”¨è¿™ä¸ªé—­åŒ…æ‰ä¼šè¿è¡Œè¿™ä¸ªé—­åŒ…
print("Now running closure \(customerProvider())!")
// Prints "Now serving Chris!"
print(customersInLine.count)
// æ‰“å°å‡º "4"


// customersInLine is ["Alex", "Ewa", "Barry", "Daniella"]
func serve(customer customerProvider: () -> String) {
    print("Now running \(customerProvider())!")
}

serve(customer: { customersInLine.remove(at: 0) } )
// æ‰“å°å‡º "Now serving Alex!"
```

ä¸Šé¢çš„ `serve(customer:)` å‡½æ•°æ¥å—ä¸€ä¸ªè¿”å›é¡¾å®¢åå­—çš„æ˜¾å¼çš„é—­åŒ…ã€‚ä¸‹é¢è¿™ä¸ªç‰ˆæœ¬çš„ `serve(customer:)` å®Œæˆäº†ç›¸åŒçš„æ“ä½œï¼Œä¸è¿‡å®ƒå¹¶æ²¡æœ‰æ¥å—ä¸€ä¸ªæ˜¾å¼çš„é—­åŒ…ï¼Œè€Œæ˜¯é€šè¿‡å°†å‚æ•°æ ‡è®°ä¸º `@autoclosure` æ¥æ¥æ”¶ä¸€ä¸ªè‡ªåŠ¨é—­åŒ…ã€‚ç°åœ¨ä½ å¯ä»¥å°†è¯¥å‡½æ•°å½“ä½œæ¥å— String ç±»å‹å‚æ•°ï¼ˆè€Œéé—­åŒ…ï¼‰çš„å‡½æ•°æ¥è°ƒç”¨ã€‚`customerProvider` **å‚æ•°å°†è‡ªåŠ¨è½¬åŒ–ä¸ºä¸€ä¸ªé—­åŒ…**ï¼Œå› ä¸ºè¯¥å‚æ•°è¢«æ ‡è®°äº†`@autoclosure` ç‰¹æ€§ã€‚


```swift
// customersInLine is ["Ewa", "Barry", "Daniella"]
func serve(customer customerProvider: @autoclosure () -> String) {
    print("Now serving \(customerProvider())!")
}
serve(customer: customersInLine.remove(at: 0))
// æ‰“å° "Now serving Ewa!"

```
å¦‚æœä½ æƒ³è®©ä¸€ä¸ªè‡ªåŠ¨é—­åŒ…å¯ä»¥â€œé€ƒé€¸â€ï¼Œåˆ™åº”è¯¥åŒæ—¶ä½¿ç”¨ `@autoclosure` å’Œ `@escaping` å±æ€§

```swift
// customersInLine i= ["Barry", "Daniella"]
var customerProviders: [() -> String] = []
func collectCustomerProviders(_ customerProvider: @autoclosure @escaping () -> String) {
    customerProviders.append(customerProvider)
}
collectCustomerProviders(customersInLine.remove(at: 0))
collectCustomerProviders(customersInLine.remove(at: 0))

print("Collected \(customerProviders.count) closures.")
// æ‰“å° "Collected 2 closures."
for customerProvider in customerProviders {
    print("Now serving \(customerProvider())!")
}
// æ‰“å° "Now serving Barry!"
// æ‰“å° "Now serving Daniella!"

```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`collectCustomerProviders(_:)` å‡½æ•°å¹¶æ²¡æœ‰è°ƒç”¨ä¼ å…¥çš„ `customerProvider` é—­åŒ…ï¼Œè€Œæ˜¯å°†é—­åŒ…è¿½åŠ åˆ°äº† `customerProviders` æ•°ç»„ä¸­ã€‚è¿™ä¸ªæ•°ç»„å®šä¹‰åœ¨å‡½æ•°ä½œç”¨åŸŸèŒƒå›´å¤–ï¼Œè¿™æ„å‘³ç€æ•°ç»„å†…çš„é—­åŒ…èƒ½å¤Ÿåœ¨å‡½æ•°è¿”å›ä¹‹åè¢«è°ƒç”¨ã€‚å› æ­¤ï¼Œ`customerProvider` å‚æ•°å¿…é¡»å…è®¸â€œé€ƒé€¸â€å‡ºå‡½æ•°ä½œç”¨åŸŸã€‚




## å¯¹è±¡å’Œç±»

Swift ä¸­ç±»å’Œç»“æ„ä½“æœ‰å¾ˆå¤šå…±åŒç‚¹ã€‚å…±åŒå¤„åœ¨äºï¼š

* å®šä¹‰å±æ€§ç”¨äºå­˜å‚¨å€¼
* å®šä¹‰æ–¹æ³•ç”¨äºæä¾›åŠŸèƒ½
* å®šä¹‰ä¸‹æ ‡æ“ä½œä½¿å¾—å¯ä»¥é€šè¿‡ä¸‹æ ‡è¯­æ³•æ¥è®¿é—®å®ä¾‹æ‰€åŒ…å«çš„å€¼
* å®šä¹‰æ„é€ å™¨ç”¨äºç”Ÿæˆåˆå§‹åŒ–å€¼
* é€šè¿‡æ‰©å±•ä»¥å¢åŠ é»˜è®¤å®ç°çš„åŠŸèƒ½
* å®ç°åè®®ä»¥æä¾›æŸç§æ ‡å‡†åŠŸèƒ½

ä¸ç»“æ„ä½“ç›¸æ¯”ï¼Œç±»è¿˜æœ‰å¦‚ä¸‹çš„é™„åŠ åŠŸèƒ½ï¼š

* ç»§æ‰¿ å…è®¸ä¸€ä¸ªç±»ç»§æ‰¿å¦ä¸€ä¸ªç±»çš„ç‰¹å¾
* ç±»å‹è½¬æ¢ å…è®¸åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œè§£é‡Šä¸€ä¸ªç±»å®ä¾‹çš„ç±»å‹
* ææ„å™¨ å…è®¸ä¸€ä¸ªç±»å®ä¾‹é‡Šæ”¾ä»»ä½•å…¶æ‰€è¢«åˆ†é…çš„èµ„æº
* å¼•ç”¨è®¡æ•° å…è®¸å¯¹ä¸€ä¸ªç±»çš„å¤šæ¬¡å¼•ç”¨

æœ€å¤§çš„ä¸åŒç‚¹ï¼š
* ç»“æ„ä½“æ€»æ˜¯é€šè¿‡è¢«å¤åˆ¶çš„æ–¹å¼åœ¨ä»£ç ä¸­ä¼ é€’ï¼Œä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°ã€‚


### ç±»çš„å®šä¹‰
```swift
//å®šä¹‰
class Shape {
    var numberOfSides = 0
    func simpleDescription() -> String {
        return "A shape with \(numberOfSides) sides."
    }
}
//åˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹
var shape = Shape()
shape.numberOfSides = 7
var shapeDescription = shape.simpleDescription()

```

### æ„é€ å‡½æ•°

ä¸ Objective-C ä¸­çš„æ„é€ å™¨ä¸åŒï¼ŒSwift çš„æ„é€ å™¨æ— éœ€è¿”å›å€¼ï¼Œå®ƒä»¬çš„ä¸»è¦ä»»åŠ¡æ˜¯ä¿è¯æ–°å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨å‰å®Œæˆæ­£ç¡®çš„åˆå§‹åŒ–ã€‚

ä½¿ç”¨ init æ¥åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°

```swift
class NamedShape {
    var numberOfSides: Int = 0
    var name: String
    var otherName: String
    
    //æ„é€ å™¨
    init(name: String) {
        // self è¢«ç”¨æ¥åŒºåˆ«å®ä¾‹å˜é‡ name å’Œæ„é€ å™¨çš„å‚æ•° name
        self.name = name
    }
    //é‡è½½æ„é€ å™¨
    init(otherName: String) {
        // self è¢«ç”¨æ¥åŒºåˆ«å®ä¾‹å˜é‡ name å’Œæ„é€ å™¨çš„å‚æ•° name
        self.otherName = name
    }
    
    func simpleDescription() -> String {
        return "A \(name) shape with \(numberOfSides) sides."
    }
    //å¦‚æœä½ éœ€è¦åœ¨åˆ é™¤å¯¹è±¡ä¹‹å‰è¿›è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œä½¿ç”¨ deinit åˆ›å»ºä¸€ä¸ªææ„å‡½æ•°
    deinit {
        print("deintied!")
    }

}

var nameShape = NamedShape(name:"uuuu")
nameShape.numberOfSides = 9
var nameShapeDescription = nameShape.simpleDescription()
//"A uuuu shape with 9 sides."
```

>æ³¨æ„
å½“ä½ ä¸ºå­˜å‚¨å‹å±æ€§è®¾ç½®é»˜è®¤å€¼æˆ–è€…åœ¨æ„é€ å™¨ä¸­ä¸ºå…¶èµ‹å€¼æ—¶ï¼Œå®ƒä»¬çš„å€¼æ˜¯è¢«ç›´æ¥è®¾ç½®çš„ï¼Œä¸ä¼šè§¦å‘ä»»ä½•å±æ€§è§‚å¯Ÿè€…ã€‚

å¯¹äºç±»çš„å®ä¾‹æ¥è¯´ï¼Œå®ƒçš„å¸¸é‡å±æ€§åªèƒ½åœ¨å®šä¹‰å®ƒçš„ç±»çš„æ„é€ è¿‡ç¨‹ä¸­ä¿®æ”¹ï¼›ä¸èƒ½åœ¨å­ç±»ä¸­ä¿®æ”¹ã€‚



```swift
//ç»“æ„ä½“æ„é€ å™¨
struct Fahrenheit {
    var temperature: Double
    init() {
        temperature = 32.0
    }
}
var f = Fahrenheit()
print("The default temperature is \(f.temperature)Â° Fahrenheit")
// æ‰“å° "The default temperature is 32.0Â° Fahrenheit"

```


**é»˜è®¤æ„é€ å™¨**
å¦‚æœç»“æ„ä½“æˆ–ç±»çš„æ‰€æœ‰å±æ€§éƒ½æœ‰é»˜è®¤å€¼ï¼ŒåŒæ—¶æ²¡æœ‰è‡ªå®šä¹‰çš„æ„é€ å™¨ï¼Œé‚£ä¹ˆ Swift ä¼šç»™è¿™äº›ç»“æ„ä½“æˆ–ç±»æä¾›ä¸€ä¸ªé»˜è®¤æ„é€ å™¨ï¼ˆdefault initializersï¼‰ã€‚è¿™ä¸ªé»˜è®¤æ„é€ å™¨å°†ç®€å•åœ°åˆ›å»ºä¸€ä¸ªæ‰€æœ‰å±æ€§å€¼éƒ½è®¾ç½®ä¸ºé»˜è®¤å€¼çš„å®ä¾‹ã€‚

```swift
class ShoppingListItem {
    var name: String?
    var quantity = 1
    var purchased = false
}
var item = ShoppingListItem()
```
å¦‚æœç»“æ„ä½“æ²¡æœ‰æä¾›è‡ªå®šä¹‰çš„æ„é€ å™¨ï¼Œå®ƒä»¬å°†è‡ªåŠ¨è·å¾—ä¸€ä¸ªé€ä¸€æˆå‘˜æ„é€ å™¨ï¼Œå³ä½¿ç»“æ„ä½“çš„å­˜å‚¨å‹å±æ€§æ²¡æœ‰é»˜è®¤å€¼ã€‚

```swift
struct Size {
    var width = 0.0, height = 0.0
}
let twoByTwo = Size(width: 2.0, height: 2.0)
```

å¿…è¦æ„é€ å™¨
åœ¨ç±»çš„æ„é€ å™¨å‰æ·»åŠ `required`ä¿®é¥°ç¬¦è¡¨æ˜æ‰€æœ‰è¯¥ç±»çš„å­ç±»éƒ½å¿…é¡»å®ç°è¯¥æ„é€ å™¨ï¼š

```swift
class SomeClass {
    required init() {
        // æ„é€ å™¨çš„å®ç°ä»£ç 
    }
}

//å­ç±»é‡å†™çˆ¶ç±»çš„å¿…è¦æ„é€ å™¨æ—¶ï¼Œå¿…é¡»åœ¨å­ç±»çš„æ„é€ å™¨å‰ä¹Ÿæ·»åŠ requiredä¿®é¥°ç¬¦ï¼Œè¡¨æ˜è¯¥æ„é€ å™¨è¦æ±‚ä¹Ÿåº”ç”¨äºç»§æ‰¿é“¾åé¢çš„å­ç±»
class SomeSubclass: SomeClass {
    required init() {
        // æ„é€ å™¨çš„å®ç°ä»£ç 
    }
}

```

å¦ä¸€ç§æƒ…å†µï¼š
```swift
//åè®®å£°æ˜æ„é€ å‡½æ•°
protocol SomeProtocol {
    init(someParameter: Int)
}
//å®ç°è¯¥åè®®ï¼Œå¿…é¡»ä¸ºæ„é€ å™¨å®ç°æ ‡ä¸Š required ä¿®é¥°ç¬¦
class SomeClass: SomeProtocol {
    required init(someParameter: Int) {
        // è¿™é‡Œæ˜¯æ„é€ å™¨çš„å®ç°éƒ¨åˆ†
    }
}

```

>æ³¨æ„
å¦‚æœç±»å·²ç»è¢«æ ‡è®°ä¸º finalï¼Œé‚£ä¹ˆä¸éœ€è¦åœ¨åè®®æ„é€ å™¨çš„å®ç°ä¸­ä½¿ç”¨ required ä¿®é¥°ç¬¦ï¼Œå› ä¸º final ç±»ä¸èƒ½æœ‰å­ç±»ã€‚å…³äº final ä¿®é¥°ç¬¦çš„æ›´å¤šå†…å®¹ï¼Œ

### ææ„è¿‡ç¨‹
ææ„å™¨åªé€‚ç”¨äºç±»ç±»å‹ï¼Œå½“ä¸€ä¸ªç±»çš„å®ä¾‹è¢«é‡Šæ”¾ä¹‹å‰ï¼Œææ„å™¨ä¼šè¢«ç«‹å³è°ƒç”¨ã€‚ææ„å™¨ç”¨å…³é”®å­—`deinit`æ¥æ ‡ç¤ºï¼Œç±»ä¼¼äºæ„é€ å™¨è¦ç”¨`init`æ¥æ ‡ç¤ºã€‚
é€šå¸¸å½“ä½ çš„å®ä¾‹è¢«é‡Šæ”¾æ—¶ä¸éœ€è¦æ‰‹åŠ¨åœ°å»æ¸…ç†ã€‚ä½†æ˜¯ï¼Œå½“ä½¿ç”¨è‡ªå·±çš„èµ„æºæ—¶ï¼Œä½ å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›é¢å¤–çš„æ¸…ç†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåˆ›å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»æ¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å†™å…¥ä¸€äº›æ•°æ®ï¼Œä½ å¯èƒ½éœ€è¦åœ¨ç±»å®ä¾‹è¢«é‡Šæ”¾ä¹‹å‰æ‰‹åŠ¨å»å…³é—­è¯¥æ–‡ä»¶ã€‚

```swift
deinit {
    // æ‰§è¡Œææ„è¿‡ç¨‹
}
```
ææ„å™¨æ˜¯åœ¨å®ä¾‹é‡Šæ”¾å‘ç”Ÿå‰è¢«è‡ªåŠ¨è°ƒç”¨ã€‚ä½ ä¸èƒ½ä¸»åŠ¨è°ƒç”¨ææ„å™¨ã€‚å­ç±»ç»§æ‰¿äº†çˆ¶ç±»çš„ææ„å™¨ï¼Œå¹¶ä¸”åœ¨å­ç±»ææ„å™¨å®ç°çš„æœ€åï¼Œçˆ¶ç±»çš„ææ„å™¨ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚å³ä½¿å­ç±»æ²¡æœ‰æä¾›è‡ªå·±çš„ææ„å™¨ï¼Œçˆ¶ç±»çš„ææ„å™¨ä¹ŸåŒæ ·ä¼šè¢«è°ƒç”¨ã€‚

æ‰€ä»¥ææ„å™¨å¯ä»¥è®¿é—®å®ä¾‹çš„æ‰€æœ‰å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®é‚£äº›å±æ€§å¯ä»¥ä¿®æ”¹å®ƒçš„è¡Œä¸ºï¼ˆæ¯”å¦‚æŸ¥æ‰¾ä¸€ä¸ªéœ€è¦è¢«å…³é—­çš„æ–‡ä»¶

### å±æ€§

#### å¸¸é‡ç»“æ„ä½“çš„å­˜å‚¨å±æ€§
å¦‚æœåˆ›å»ºäº†ä¸€ä¸ªç»“æ„ä½“çš„å®ä¾‹å¹¶å°†å…¶èµ‹å€¼ç»™ä¸€ä¸ªå¸¸é‡ï¼Œåˆ™æ— æ³•ä¿®æ”¹è¯¥å®ä¾‹çš„ä»»ä½•å±æ€§ï¼Œå³ä½¿æœ‰å±æ€§è¢«å£°æ˜ä¸ºå˜é‡ä¹Ÿä¸è¡Œï¼š

```swift
let rangeOfFourItems = FixedLengthRange(firstValue: 0, length: 4)
// è¯¥åŒºé—´è¡¨ç¤ºæ•´æ•°0ï¼Œ1ï¼Œ2ï¼Œ3
rangeOfFourItems.firstValue = 6
// å°½ç®¡ firstValue æ˜¯ä¸ªå˜é‡å±æ€§ï¼Œè¿™é‡Œè¿˜æ˜¯ä¼šæŠ¥é”™
```

è¿™ç§è¡Œä¸ºæ˜¯ç”±äºç»“æ„ä½“ï¼ˆstructï¼‰å±äºå€¼ç±»å‹ã€‚å½“å€¼ç±»å‹çš„å®ä¾‹è¢«å£°æ˜ä¸ºå¸¸é‡çš„æ—¶å€™ï¼Œå®ƒçš„æ‰€æœ‰å±æ€§ä¹Ÿå°±æˆäº†å¸¸é‡ã€‚

å±äºå¼•ç”¨ç±»å‹çš„ç±»ï¼ˆclassï¼‰åˆ™ä¸ä¸€æ ·ã€‚æŠŠä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å®ä¾‹èµ‹ç»™ä¸€ä¸ªå¸¸é‡åï¼Œä»ç„¶å¯ä»¥ä¿®æ”¹è¯¥å®ä¾‹çš„å˜é‡å±æ€§ã€‚

#### å»¶è¿Ÿå­˜å‚¨å±æ€§
å»¶è¿Ÿå­˜å‚¨å±æ€§æ˜¯æŒ‡å½“ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™æ‰ä¼šè®¡ç®—å…¶åˆå§‹å€¼çš„å±æ€§ã€‚
åœ¨å±æ€§å£°æ˜å‰ä½¿ç”¨ `lazy` æ¥æ ‡ç¤ºä¸€ä¸ªå»¶è¿Ÿå­˜å‚¨å±æ€§ã€‚

>æ³¨æ„
å¿…é¡»å°†å»¶è¿Ÿå­˜å‚¨å±æ€§å£°æ˜æˆå˜é‡ï¼ˆä½¿ç”¨ var å…³é”®å­—ï¼‰ï¼Œå› ä¸ºå±æ€§çš„åˆå§‹å€¼å¯èƒ½åœ¨å®ä¾‹æ„é€ å®Œæˆä¹‹åæ‰ä¼šå¾—åˆ°ã€‚è€Œå¸¸é‡å±æ€§åœ¨æ„é€ è¿‡ç¨‹å®Œæˆä¹‹å‰å¿…é¡»è¦æœ‰åˆå§‹å€¼ï¼Œå› æ­¤æ— æ³•å£°æ˜æˆå»¶è¿Ÿå±æ€§ã€‚

å»¶è¿Ÿå±æ€§å¾ˆæœ‰ç”¨ï¼Œå½“å±æ€§çš„å€¼ä¾èµ–äºåœ¨å®ä¾‹çš„æ„é€ è¿‡ç¨‹ç»“æŸåæ‰ä¼šçŸ¥é“å½±å“å€¼çš„å¤–éƒ¨å› ç´ æ—¶ï¼Œæˆ–è€…å½“è·å¾—å±æ€§çš„åˆå§‹å€¼éœ€è¦å¤æ‚æˆ–å¤§é‡è®¡ç®—æ—¶ï¼Œå¯ä»¥åªåœ¨éœ€è¦çš„æ—¶å€™è®¡ç®—å®ƒã€‚



```swift
class DataImporter {
    /* DataImporter æ˜¯ä¸€ä¸ªè´Ÿè´£å°†å¤–éƒ¨æ–‡ä»¶ä¸­çš„æ•°æ®å¯¼å…¥çš„ç±»ã€‚ è¿™ä¸ªç±»çš„åˆå§‹åŒ–ä¼šæ¶ˆè€—ä¸å°‘æ—¶é—´ã€‚ */
    var fileName = "data.txt"
    // è¿™é‡Œä¼šæä¾›æ•°æ®å¯¼å…¥åŠŸèƒ½
}

class DataManager {
    lazy var importer = DataImporter()
    var data = [String]()
    // è¿™é‡Œä¼šæä¾›æ•°æ®ç®¡ç†åŠŸèƒ½
}

let manager = DataManager()
manager.data.append("Some data")
manager.data.append("Some more data")
// DataImporter å®ä¾‹çš„ importer å±æ€§è¿˜æ²¡æœ‰è¢«åˆ›å»º

print(manager.importer.fileName)
// DataImporter å®ä¾‹çš„ importer å±æ€§ç°åœ¨è¢«åˆ›å»ºäº†
// è¾“å‡º "data.txtâ€
```

>æ³¨æ„
å¦‚æœä¸€ä¸ªè¢«æ ‡è®°ä¸º `lazy` çš„å±æ€§åœ¨æ²¡æœ‰åˆå§‹åŒ–æ—¶å°±åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œåˆ™æ— æ³•ä¿è¯è¯¥å±æ€§åªä¼šè¢«åˆå§‹åŒ–ä¸€æ¬¡ã€‚



#### è®¡ç®—å±æ€§
é™¤å­˜å‚¨å±æ€§å¤–ï¼Œç±»ã€ç»“æ„ä½“å’Œæšä¸¾å¯ä»¥å®šä¹‰è®¡ç®—å±æ€§ã€‚è®¡ç®—å±æ€§ä¸ç›´æ¥å­˜å‚¨å€¼ï¼Œè€Œæ˜¯æä¾›ä¸€ä¸ª `getter` å’Œä¸€ä¸ªå¯é€‰çš„ `setter`ï¼Œæ¥é—´æ¥è·å–å’Œè®¾ç½®å…¶ä»–å±æ€§æˆ–å˜é‡çš„å€¼ã€‚


```swift
class EquilateralTriangle: NamedShape {
    var sideLength: Double = 0.0
    
    init(sideLength: Double, name: String) {
        self.sideLength = sideLength
        super.init(name: name)
        numberOfSides = 3
    }
    
    //getter å’Œ setter
    //è®¡ç®—å±æ€§çš„ setter æ²¡æœ‰å®šä¹‰è¡¨ç¤ºæ–°å€¼çš„å‚æ•°åï¼Œåˆ™å¯ä»¥ä½¿ç”¨é»˜è®¤åç§° newValue
    var perimeter: Double {
        get {
            return 3.0 * sideLength
        }
        set {
            sideLength = newValue / 3.0
        }
        /*è‡ªå®šä¹‰æ–°å€¼çš„åå­—
        set(newYourValue) {
            origin.x = newCenter.x - (size.width / 2)
            origin.y = newCenter.y - (size.height / 2)
        }
        */
    }
    
    override func simpleDescription() -> String {
        return "An equilateral triangle with sides of length \(sideLength)."
    }
}
var triangle = EquilateralTriangle(sideLength: 3.1, name: "a triangle")
print(triangle.perimeter)//9.3 = 3* sideLength
triangle.perimeter = 9.9
print(triangle.sideLength)//3.3 = newValue / 3.0

```

æ³¨æ„ EquilateralTriangle ç±»çš„æ„é€ å™¨æ‰§è¡Œäº†ä¸‰æ­¥ï¼š

* è®¾ç½®å­ç±»å£°æ˜çš„å±æ€§å€¼
* è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨
* æ”¹å˜çˆ¶ç±»å®šä¹‰çš„å±æ€§å€¼ã€‚å…¶ä»–çš„å·¥ä½œæ¯”å¦‚è°ƒç”¨æ–¹æ³•ã€getters å’Œ setters ä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªé˜¶æ®µå®Œæˆã€‚


**åªè¯»è®¡ç®—å±æ€§**
åªæœ‰ `getter` æ²¡æœ‰ `setter` çš„è®¡ç®—å±æ€§å°±æ˜¯åªè¯»è®¡ç®—å±æ€§ã€‚
åªè¯»è®¡ç®—å±æ€§æ€»æ˜¯è¿”å›ä¸€ä¸ªå€¼ï¼Œå¯ä»¥é€šè¿‡ç‚¹è¿ç®—ç¬¦è®¿é—®ï¼Œä½†ä¸èƒ½è®¾ç½®æ–°çš„å€¼ã€‚

>æ³¨æ„
å¿…é¡»ä½¿ç”¨ `var` å…³é”®å­—å®šä¹‰è®¡ç®—å±æ€§ï¼ŒåŒ…æ‹¬åªè¯»è®¡ç®—å±æ€§ï¼Œå› ä¸ºå®ƒä»¬çš„å€¼ä¸æ˜¯å›ºå®šçš„ã€‚`let` å…³é”®å­—åªç”¨æ¥å£°æ˜å¸¸é‡å±æ€§ï¼Œè¡¨ç¤ºåˆå§‹åŒ–åå†ä¹Ÿæ— æ³•ä¿®æ”¹çš„å€¼ã€‚

åªè¯»è®¡ç®—å±æ€§çš„å£°æ˜å¯ä»¥å»æ‰ `get` å…³é”®å­—å’ŒèŠ±æ‹¬å·ï¼š

```swift
struct Cuboid {
    var width = 0.0, height = 0.0, depth = 0.0
    var volume: Double {
        return width * height * depth
    }
}
let fourByFiveByTwo = Cuboid(width: 4.0, height: 5.0, depth: 2.0)
print("the volume of fourByFiveByTwo is \(fourByFiveByTwo.volume)")
// æ‰“å° "the volume of fourByFiveByTwo is 40.0"
```

#### å±æ€§è§‚å¯Ÿå™¨

`willSet`å’Œ`didSet`è¿™ä¸¤ä¸ªç‰¹æ€§æ¥ç›‘è§†å±æ€§çš„é™¤åˆå§‹åŒ–ä¹‹å¤–çš„å±æ€§å€¼å˜åŒ–

å¯ä»¥ä¸º**é™¤äº†å»¶è¿Ÿå­˜å‚¨å±æ€§ä¹‹å¤–**çš„å…¶ä»–å­˜å‚¨å±æ€§æ·»åŠ å±æ€§è§‚å¯Ÿå™¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é‡å†™å±æ€§çš„æ–¹å¼ä¸ºç»§æ‰¿çš„å±æ€§ï¼ˆåŒ…æ‹¬å­˜å‚¨å±æ€§å’Œè®¡ç®—å±æ€§ï¼‰æ·»åŠ å±æ€§è§‚å¯Ÿå™¨ã€‚
ä½ ä¸å¿…ä¸ºéé‡å†™çš„è®¡ç®—å±æ€§æ·»åŠ å±æ€§è§‚å¯Ÿå™¨ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡å®ƒçš„ `setter` ç›´æ¥ç›‘æ§å’Œå“åº”å€¼çš„å˜åŒ–ã€‚

* `willSet` åœ¨æ–°çš„å€¼è¢«è®¾ç½®ä¹‹å‰è°ƒç”¨
* `didSet` åœ¨æ–°çš„å€¼è¢«è®¾ç½®ä¹‹åç«‹å³è°ƒç”¨

`willSet` è§‚å¯Ÿå™¨ä¼šå°†æ–°çš„å±æ€§å€¼ä½œä¸ºå¸¸é‡å‚æ•°ä¼ å…¥ï¼Œåœ¨ `willSet` çš„å®ç°ä»£ç ä¸­å¯ä»¥ä¸ºè¿™ä¸ªå‚æ•°æŒ‡å®šä¸€ä¸ªåç§°ï¼Œå¦‚æœä¸æŒ‡å®šåˆ™å‚æ•°ä»ç„¶å¯ç”¨ï¼Œè¿™æ—¶ä½¿ç”¨é»˜è®¤åç§° `newValue` è¡¨ç¤ºã€‚

åŒæ ·ï¼Œ`didSet` è§‚å¯Ÿå™¨ä¼šå°†æ—§çš„å±æ€§å€¼ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå¯ä»¥ä¸ºè¯¥å‚æ•°å‘½åæˆ–è€…ä½¿ç”¨é»˜è®¤å‚æ•°å `oldValue`ã€‚å¦‚æœåœ¨ `didSet` æ–¹æ³•ä¸­å†æ¬¡å¯¹è¯¥å±æ€§èµ‹å€¼ï¼Œé‚£ä¹ˆæ–°å€¼ä¼šè¦†ç›–æ—§çš„å€¼ã€‚

```swift
class People 
{
    //æ™®é€šå±æ€§
    var firstName:String = ""
    var lastName:String  = ""
    var nickName:String  = ""
    
    //è®¡ç®—å±æ€§
    var fullName:String
    {
        get
        {
            return nickName + " " + firstName + " " + lastName
        }
    }
    
    //å¸¦å±æ€§ç›‘è§†å™¨çš„æ™®é€šå±æ€§
    var age:Int = 0
    {
        //åœ¨ageå±æ€§å˜åŒ–å‰.   æ–°å€¼é»˜è®¤åç§°newValue
        willSet
        {
            print("Will set an new value \(newValue) to age")
        }
        //åœ¨ageå±æ€§å‘ç”Ÿå˜åŒ–åï¼Œ    æ—§å€¼é»˜è®¤å‚æ•°åoldValue
        didSet
        {
            print("age filed changed form \(oldValue) to \(age)")
            if age<10
            {
                nickName = "Little"
            }else
            {
                nickName = "Big"
            }
        }
    }
    
    func toString() -> String
    {
        return "Full Name: \(fullName) " + ", Age: \(age) "
    }
    
}

var me = People()
me.firstName = "Zhang"
me.lastName  = "San"
me.age = 20

print(me.toString())

/*ç¨‹åºè¾“å‡º
Will set an new value 20 to age
age filed changed form 0 to 20
Full Name: Big Zhang San , Age: 20
*/

```
>æ³¨æ„
çˆ¶ç±»çš„å±æ€§åœ¨å­ç±»çš„æ„é€ å™¨ä¸­è¢«èµ‹å€¼æ—¶ï¼Œå®ƒåœ¨çˆ¶ç±»ä¸­çš„ `willSet` å’Œ `didSet` è§‚å¯Ÿå™¨ä¼šè¢«è°ƒç”¨ï¼Œéšåæ‰ä¼šè°ƒç”¨å­ç±»çš„è§‚å¯Ÿå™¨ã€‚åœ¨çˆ¶ç±»åˆå§‹åŒ–æ–¹æ³•è°ƒç”¨ä¹‹å‰ï¼Œå­ç±»ç»™å±æ€§èµ‹å€¼æ—¶ï¼Œè§‚å¯Ÿå™¨ä¸ä¼šè¢«è°ƒç”¨ã€‚ 

>å¦‚æœå°†å±æ€§é€šè¿‡ in-out æ–¹å¼ä¼ å…¥å‡½æ•°ï¼ŒwillSet å’Œ didSet ä¹Ÿä¼šè°ƒç”¨ã€‚è¿™æ˜¯å› ä¸º in-out å‚æ•°é‡‡ç”¨äº†æ‹·å…¥æ‹·å‡ºæ¨¡å¼ï¼šå³åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„æ˜¯å‚æ•°çš„ copyï¼Œå‡½æ•°ç»“æŸåï¼Œåˆå¯¹å‚æ•°é‡æ–°èµ‹å€¼



#### å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡
è®¡ç®—å±æ€§å’Œå±æ€§è§‚å¯Ÿå™¨æ‰€æè¿°çš„åŠŸèƒ½ä¹Ÿå¯ä»¥ç”¨äºå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚
å…¨å±€å˜é‡æ˜¯åœ¨å‡½æ•°ã€æ–¹æ³•ã€é—­åŒ…æˆ–ä»»ä½•ç±»å‹ä¹‹å¤–å®šä¹‰çš„å˜é‡ã€‚
å±€éƒ¨å˜é‡æ˜¯åœ¨å‡½æ•°ã€æ–¹æ³•æˆ–é—­åŒ…å†…éƒ¨å®šä¹‰çš„å˜é‡ã€‚

>æ³¨æ„
å…¨å±€çš„å¸¸é‡æˆ–å˜é‡éƒ½æ˜¯å»¶è¿Ÿè®¡ç®—çš„ï¼Œè·Ÿå»¶è¿Ÿå­˜å‚¨å±æ€§ç›¸ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œå…¨å±€çš„å¸¸é‡æˆ–å˜é‡ä¸éœ€è¦æ ‡è®°lazyä¿®é¥°ç¬¦ã€‚
å±€éƒ¨èŒƒå›´çš„å¸¸é‡æˆ–å˜é‡ä»ä¸å»¶è¿Ÿè®¡ç®—ã€‚



å¤„ç†å˜é‡çš„å¯é€‰å€¼æ—¶ï¼Œä½ å¯ä»¥åœ¨æ“ä½œï¼ˆæ¯”å¦‚æ–¹æ³•ã€å±æ€§å’Œå­è„šæœ¬ï¼‰ä¹‹å‰åŠ  ?ã€‚å¦‚æœ ? ä¹‹å‰çš„å€¼æ˜¯ nilï¼Œ? åé¢çš„ä¸œè¥¿éƒ½ä¼šè¢«å¿½ç•¥ï¼Œå¹¶ä¸”æ•´ä¸ªè¡¨è¾¾å¼è¿”å› nilã€‚å¦åˆ™ï¼Œ? ä¹‹åçš„ä¸œè¥¿éƒ½ä¼šè¢«è¿è¡Œã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„å€¼ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰å€¼ã€‚


```swift
var optionalSquare: Square? = Square(sideLength: 2.5, name: "optional square")
//optionalSquare = nil
let sideLength = optionalSquare?.sideLength
```

#### ç±»å‹å±æ€§
ä¸ºç±»å‹æœ¬èº«å®šä¹‰å±æ€§ï¼Œæ— è®ºåˆ›å»ºäº†å¤šå°‘ä¸ªè¯¥ç±»å‹çš„å®ä¾‹ï¼Œè¿™äº›å±æ€§éƒ½åªæœ‰å”¯ä¸€ä¸€ä»½ã€‚è¿™ç§å±æ€§å°±æ˜¯ç±»å‹å±æ€§ã€‚

å­˜å‚¨å‹ç±»å‹å±æ€§å¯ä»¥æ˜¯å˜é‡æˆ–å¸¸é‡ï¼Œè®¡ç®—å‹ç±»å‹å±æ€§è·Ÿå®ä¾‹çš„è®¡ç®—å‹å±æ€§ä¸€æ ·åªèƒ½å®šä¹‰æˆå˜é‡å±æ€§ã€‚


>æ³¨æ„
è·Ÿå®ä¾‹çš„å­˜å‚¨å‹å±æ€§ä¸åŒï¼Œå¿…é¡»ç»™å­˜å‚¨å‹ç±»å‹å±æ€§æŒ‡å®šé»˜è®¤å€¼ï¼Œå› ä¸ºç±»å‹æœ¬èº«æ²¡æœ‰æ„é€ å™¨ï¼Œä¹Ÿå°±æ— æ³•åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ä½¿ç”¨æ„é€ å™¨ç»™ç±»å‹å±æ€§èµ‹å€¼ã€‚
å­˜å‚¨å‹ç±»å‹å±æ€§æ˜¯å»¶è¿Ÿåˆå§‹åŒ–çš„ï¼Œå®ƒä»¬åªæœ‰åœ¨ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„æ—¶å€™æ‰ä¼šè¢«åˆå§‹åŒ–ã€‚å³ä½¿å®ƒä»¬è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œç³»ç»Ÿä¹Ÿä¿è¯åªä¼šå¯¹å…¶è¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–ï¼Œå¹¶ä¸”ä¸éœ€è¦å¯¹å…¶ä½¿ç”¨ `lazy` ä¿®é¥°ç¬¦ã€‚


**ç±»å‹å±æ€§è¯­æ³•**
åœ¨ C æˆ– Objective-C ä¸­ï¼Œä¸æŸä¸ªç±»å‹å…³è”çš„é™æ€å¸¸é‡å’Œé™æ€å˜é‡ï¼Œæ˜¯ä½œä¸ºå…¨å±€ï¼ˆglobalï¼‰é™æ€å˜é‡å®šä¹‰çš„ã€‚ä½†æ˜¯åœ¨ Swift ä¸­ï¼Œç±»å‹å±æ€§æ˜¯ä½œä¸ºç±»å‹å®šä¹‰çš„ä¸€éƒ¨åˆ†å†™åœ¨ç±»å‹æœ€å¤–å±‚çš„èŠ±æ‹¬å·å†…ï¼Œå› æ­¤å®ƒçš„ä½œç”¨èŒƒå›´ä¹Ÿå°±åœ¨ç±»å‹æ”¯æŒçš„èŒƒå›´å†…ã€‚

ä½¿ç”¨å…³é”®å­— `static` æ¥å®šä¹‰ç±»å‹å±æ€§ã€‚åœ¨ä¸ºç±»å®šä¹‰è®¡ç®—å‹ç±»å‹å±æ€§æ—¶ï¼Œå¯ä»¥æ”¹ç”¨å…³é”®å­— `class` æ¥æ”¯æŒå­ç±»å¯¹çˆ¶ç±»çš„å®ç°è¿›è¡Œé‡å†™


```swift
struct SomeStructure {
    static var storedTypeProperty = "Some value."
    static var computedTypeProperty: Int {
        return 1
    }
}
enum SomeEnumeration {
    static var storedTypeProperty = "Some value."
    static var computedTypeProperty: Int {
        return 6
    }
}
class SomeClass_ {
    static var storedTypeProperty = "Some value."
    static var computedTypeProperty: Int {
        return 27
    }
    //å…³é”®å­—classæ”¯æŒå­ç±»å¯¹çˆ¶ç±»çš„å®ç°è¿›è¡Œé‡å†™
    class var overrideableComputedTypeProperty: Int {
        return 107
    }
}
print(SomeStructure.storedTypeProperty)
// æ‰“å° "Some value."
SomeStructure.storedTypeProperty = "Another value."
print(SomeStructure.storedTypeProperty)
// æ‰“å° "Another value.â€
print(SomeEnumeration.computedTypeProperty)
// æ‰“å° "6"
print(SomeClass_.computedTypeProperty)
// æ‰“å° "27"
```


### æ–¹æ³•

#### åœ¨å®ä¾‹æ–¹æ³•ä¸­ä¿®æ”¹ å€¼ç±»å‹ çš„å±æ€§

**é»˜è®¤æƒ…å†µä¸‹ï¼Œå€¼ç±»å‹çš„å±æ€§ä¸èƒ½åœ¨å®ƒçš„å®ä¾‹æ–¹æ³•ä¸­è¢«ä¿®æ”¹ã€‚**

ç»“æ„ä½“å’Œæšä¸¾æ˜¯å€¼ç±»å‹ã€‚

ä½†æ˜¯ä½ å¯ä»¥ä¸ºè¿™ä¸ªæ–¹æ³•é€‰æ‹©å¯å˜(`mutating`)è¡Œä¸ºï¼Œç„¶åå°±å¯ä»¥ä»å…¶æ–¹æ³•å†…éƒ¨æ”¹å˜å®ƒçš„å±æ€§ã€‚æ–¹æ³•è¿˜å¯ä»¥ç»™å®ƒéšå«çš„selfå±æ€§èµ‹äºˆä¸€ä¸ªå…¨æ–°çš„å®ä¾‹ï¼Œè¿™ä¸ªæ–°å®ä¾‹åœ¨æ–¹æ³•ç»“æŸæ—¶ä¼šæ›¿æ¢ç°å­˜å®ä¾‹ã€‚

```swift
struct Point_ {
    var x = 0.0, y = 0.0
    mutating func moveByX(_ deltaX: Double, _ deltaY: Double) {
        x += deltaX
        y += deltaY
    }
}
var somePoint = Point_(x: 1.0, y: 1.0)
somePoint.moveByX(2.0,3.0)
print("The point is now at (\(somePoint.x), \(somePoint.y))")
// æ‰“å° "The point is now at (3.0, 4.0)"
```
ä¸èƒ½åœ¨å¸¸é‡ç»“æ„ä½“ç±»å‹ï¼ˆa constant of structure typeï¼‰ä¸Šè°ƒç”¨å¯å˜æ–¹æ³•ï¼Œå› ä¸ºå…¶å±æ€§ä¸èƒ½è¢«æ”¹å˜ï¼Œå³ä½¿å±æ€§æ˜¯å˜é‡å±æ€§

```swift
let fixedPoint = Point(x: 3.0, y: 3.0)
fixedPoint.moveByX(2.0, y: 3.0)
// è¿™é‡Œå°†ä¼šæŠ¥å‘Šä¸€ä¸ªé”™è¯¯
```

åœ¨å¯å˜æ–¹æ³•ä¸­ç»™ `self` èµ‹å€¼
å¯å˜æ–¹æ³•èƒ½å¤Ÿèµ‹ç»™éšå«å±æ€§`self`ä¸€ä¸ªå…¨æ–°çš„å®ä¾‹ã€‚ä¸Šé¢Pointçš„ä¾‹å­å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹å¼æ”¹å†™ï¼š

```swift
struct Point {
    var x = 0.0, y = 0.0
    mutating func moveBy(x deltaX: Double, y deltaY: Double) {
        self = Point(x: x + deltaX, y: y + deltaY)
    }
}

```

#### ç±»å‹æ–¹æ³•

åœ¨æ–¹æ³•çš„`func`å…³é”®å­—ä¹‹å‰åŠ ä¸Šå…³é”®å­—`static`ï¼Œæ¥æŒ‡å®šç±»å‹æ–¹æ³•ã€‚ç±»è¿˜å¯ä»¥ç”¨å…³é”®å­—`class`æ¥å…è®¸å­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•å®ç°ã€‚

>æ³¨æ„
åœ¨ Objective-C ä¸­ï¼Œä½ åªèƒ½ä¸º Objective-C çš„ç±»ç±»å‹ï¼ˆclassesï¼‰å®šä¹‰ç±»å‹æ–¹æ³•ï¼ˆtype-level methodsï¼‰ã€‚åœ¨ Swift ä¸­ï¼Œä½ å¯ä»¥ä¸ºæ‰€æœ‰çš„ç±»ã€ç»“æ„ä½“å’Œæšä¸¾å®šä¹‰ç±»å‹æ–¹æ³•ã€‚æ¯ä¸€ä¸ªç±»å‹æ–¹æ³•éƒ½è¢«å®ƒæ‰€æ”¯æŒçš„ç±»å‹æ˜¾å¼åŒ…å«ã€‚



## ä¸‹æ ‡
ä¸‹æ ‡å¯ä»¥å®šä¹‰åœ¨ç±»ã€ç»“æ„ä½“å’Œæšä¸¾ä¸­ï¼Œæ˜¯è®¿é—®é›†åˆï¼Œåˆ—è¡¨æˆ–åºåˆ—ä¸­å…ƒç´ çš„å¿«æ·æ–¹å¼
ä¸€ä¸ªç±»å‹å¯ä»¥å®šä¹‰å¤šä¸ªä¸‹æ ‡ï¼Œé€šè¿‡ä¸åŒç´¢å¼•ç±»å‹è¿›è¡Œé‡è½½

å®šä¹‰ä¸‹æ ‡ä½¿ç”¨`subscript`å…³é”®å­—ï¼ŒæŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥å‚æ•°å’Œè¿”å›ç±»å‹ï¼›ä¸å®ä¾‹æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œä¸‹æ ‡å¯ä»¥è®¾å®šä¸ºè¯»å†™æˆ–åªè¯»ã€‚è¿™ç§è¡Œä¸ºç”± `getter` å’Œ `setter` å®ç°ï¼Œæœ‰ç‚¹ç±»ä¼¼è®¡ç®—å‹å±æ€§ï¼š

```swift
subscript(index: Int) -> Int {
    get {
      // è¿”å›ä¸€ä¸ªé€‚å½“çš„ Int ç±»å‹çš„å€¼
    }

    set(newValue) {
      // æ‰§è¡Œé€‚å½“çš„èµ‹å€¼æ“ä½œ
    }
}

//å¦‚åŒåªè¯»è®¡ç®—å‹å±æ€§ï¼Œå¯ä»¥çœç•¥åªè¯»ä¸‹æ ‡çš„getå…³é”®å­—ï¼š
subscript(index: Int) -> Int {
    // è¿”å›ä¸€ä¸ªé€‚å½“çš„ Int ç±»å‹çš„å€¼
}

```

example:

```swift
struct Matrix {
    let rows: Int, columns: Int
    //Doubleç±»å‹çš„å€¼çš„æ•°ç»„
    var grid: [Double]
    
    init(rows: Int, columns: Int) {
        self.rows = rows
        self.columns = columns
        grid = Array(count: rows * columns, repeatedValue: 0.0)
    }
    
    func indexIsValid(row: Int, column: Int) -> Bool {
        return row >= 0 && row < rows && column >= 0 && column < columns
    }
    
    subscript(row: Int, column: Int) -> Double {
        get {
            assert(indexIsValid(row: row, column: column), "Index out of range")
            return grid[(row * columns) + column]
        }
        set {
            assert(indexIsValid(row: row, column: column), "Index out of range")
            grid[(row * columns) + column] = newValue
        }
    }
}

var matrix = Matrix(rows: 3, columns: 3)
matrix[1,1] = 102;
print(matrix)
//Matrix(rows: 3, columns: 3, grid: [0.0, 0.0, 0.0, 0.0, 102.0, 0.0, 0.0, 0.0, 0.0])
```

## ç»§æ‰¿


```swift
//åŸºç±»
class Vehicle {
    var currentSpeed = 0.0
    var description: String {
        return "traveling at \(currentSpeed) miles per hour"
    }
    func makeNoise() {
        // ä»€ä¹ˆä¹Ÿä¸åš-å› ä¸ºè½¦è¾†ä¸ä¸€å®šä¼šæœ‰å™ªéŸ³
    }
}

//å­ç±»
class Bicycle: Vehicle {
    var hasBasket = false
}

//é‡å†™ override å…³é”®å­—
class Train: Vehicle {
    override func makeNoise() {
        print("Choo Choo")
    }
}

```
é˜²æ­¢é‡å†™
æŠŠæ–¹æ³•ï¼Œå±æ€§æˆ–ä¸‹æ ‡æ ‡è®°ä¸º`final`æ¥é˜²æ­¢å®ƒä»¬è¢«é‡å†™
é€šè¿‡åœ¨å…³é”®å­—`class`å‰æ·»åŠ `final`ä¿®é¥°ç¬¦ï¼ˆfinal classï¼‰æ¥å°†æ•´ä¸ªç±»æ ‡è®°ä¸º `final` çš„ã€‚è¿™æ ·çš„ç±»æ˜¯ä¸å¯è¢«ç»§æ‰¿çš„ã€‚



## æšä¸¾å’Œç»“æ„ä½“

æ‰€æœ‰çš„ç»“æ„ä½“å’Œæšä¸¾ç±»å‹éƒ½æ˜¯å€¼ç±»å‹
è¿™æ„å‘³ç€å®ƒä»¬çš„å®ä¾‹ï¼Œä»¥åŠå®ä¾‹ä¸­æ‰€åŒ…å«çš„ä»»ä½•å€¼ç±»å‹å±æ€§ï¼Œåœ¨ä»£ç ä¸­ä¼ é€’çš„æ—¶å€™éƒ½ä¼šè¢«å¤åˆ¶ã€‚

### æšä¸¾ç±»çš„å®šä¹‰ï¼š
```swift
enum Rank: Int {
    //èµ·å§‹çš„å€¼=10
    case ace = 10
    case two, three, four, five, six, seven, eight, nine, ten
    case jack, queen, king
    //å®šä¹‰æ–¹æ³•
    func simpleDescription() -> String {
        switch self {
        case .ace:
            return "ace"
        case .jack:
            print("here")
            return "jack"
        case .queen:
            return "queen"
        case .king:
            return "king"
        default:
            return String(self.rawValue)
        }
    }
}
let ace = Rank.jack//ace = jack
let aceRawValue = ace.rawValue//ace = 20
print(ace.simpleDescription())
//here
//jack
```

ä½¿ç”¨ init?(rawValue:) åˆå§‹åŒ–æ„é€ å™¨æ¥åˆ›å»ºä¸€ä¸ªå¸¦æœ‰åŸå§‹å€¼çš„æšä¸¾æˆå‘˜ã€‚å¦‚æœå­˜åœ¨ä¸åŸå§‹å€¼ç›¸åº”çš„æšä¸¾æˆå‘˜å°±è¿”å›è¯¥æšä¸¾æˆå‘˜ï¼Œå¦åˆ™å°±è¿”å› nil

```swift
if let convertedRank = Rank(rawValue: 11) {
    let threeDescription = convertedRank.simpleDescription()
}
```


å¦‚æœæ²¡æœ‰æ¯”è¾ƒæœ‰æ„ä¹‰çš„åŸå§‹å€¼ï¼Œä½ å°±ä¸éœ€è¦æä¾›åŸå§‹å€¼
```swift
enum Suit {
    case spades, hearts, diamonds, clubs
    func simpleDescription() -> String {
        switch self {
        case .spades:
            return "spades"
        case .hearts:
            return "hearts"
        case .diamonds:
            return "diamonds"
        case .clubs:
            return "clubs"
        }
    }
}
let hearts = Suit.hearts
let heartsDescription = hearts.simpleDescription()
```

æ³¨æ„åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ç”¨äº†ä¸¤ç§æ–¹å¼å¼•ç”¨ hearts æšä¸¾æˆå‘˜ï¼šç»™ hearts å¸¸é‡èµ‹å€¼æ—¶ï¼Œæšä¸¾æˆå‘˜ Suit.hearts éœ€è¦ç”¨å…¨åæ¥å¼•ç”¨ï¼Œå› ä¸ºå¸¸é‡æ²¡æœ‰æ˜¾å¼æŒ‡å®šç±»å‹ã€‚åœ¨ switch é‡Œï¼Œæšä¸¾æˆå‘˜ä½¿ç”¨ç¼©å†™ .hearts æ¥å¼•ç”¨ï¼Œå› ä¸º self å·²ç»æ˜¯ä¸€ä¸ª suit ç±»å‹ï¼Œåœ¨å·²çŸ¥å˜é‡ç±»å‹çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ç¼©å†™ã€‚


### ç»“æ„ä½“
ä½¿ç”¨ struct æ¥åˆ›å»ºä¸€ä¸ªç»“æ„ä½“ã€‚
ç»“æ„ä½“å’Œç±»æœ‰å¾ˆå¤šç›¸åŒçš„åœ°æ–¹ï¼Œæ¯”å¦‚æ–¹æ³•å’Œæ„é€ å™¨ã€‚å®ƒä»¬ä¹‹é—´æœ€å¤§çš„ä¸€ä¸ªåŒºåˆ«å°±æ˜¯ç»“æ„ä½“æ˜¯ä¼ å€¼ï¼Œç±»æ˜¯ä¼ å¼•ç”¨


```swift
struct MarksStruct {
   var mark: Int

   init(mark: Int) {
      self.mark = mark
   }
}
var aStruct = MarksStruct(mark: 98)
var bStruct = aStruct // aStruct å’Œ bStruct æ˜¯ä½¿ç”¨ç›¸åŒå€¼çš„ç»“æ„ä½“ï¼
bStruct.mark = 97
print(aStruct.mark) // 98
print(bStruct.mark) // 97

```

ç»“æ„ä½“ç±»å‹çš„æˆå‘˜é€ä¸€æ„é€ å™¨
æ‰€æœ‰ç»“æ„ä½“éƒ½æœ‰ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆçš„æˆå‘˜é€ä¸€æ„é€ å™¨ï¼Œç”¨äºåˆå§‹åŒ–æ–°ç»“æ„ä½“å®ä¾‹ä¸­æˆå‘˜çš„å±æ€§ã€‚æ–°å®ä¾‹ä¸­å„ä¸ªå±æ€§çš„åˆå§‹å€¼å¯ä»¥é€šè¿‡å±æ€§çš„åç§°ä¼ é€’åˆ°æˆå‘˜é€ä¸€æ„é€ å™¨ä¹‹ä¸­ï¼š


```swift
let vga = Resolution(width:640, height: 480)
```
ä¸ç»“æ„ä½“ä¸åŒï¼Œç±»å®ä¾‹æ²¡æœ‰é»˜è®¤çš„æˆå‘˜é€ä¸€æ„é€ å™¨


### ç±»å’Œç»“æ„ä½“çš„é€‰æ‹©
æŒ‰ç…§é€šç”¨çš„å‡†åˆ™ï¼Œå½“ç¬¦åˆä¸€æ¡æˆ–å¤šæ¡ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œè¯·è€ƒè™‘æ„å»ºç»“æ„ä½“ï¼š

* è¯¥æ•°æ®ç»“æ„çš„ä¸»è¦ç›®çš„æ˜¯ç”¨æ¥å°è£…å°‘é‡ç›¸å…³ç®€å•æ•°æ®å€¼ã€‚
* æœ‰ç†ç”±é¢„è®¡è¯¥æ•°æ®ç»“æ„çš„å®ä¾‹åœ¨è¢«èµ‹å€¼æˆ–ä¼ é€’æ—¶ï¼Œå°è£…çš„æ•°æ®å°†ä¼šè¢«æ‹·è´è€Œä¸æ˜¯è¢«å¼•ç”¨ã€‚
* è¯¥æ•°æ®ç»“æ„ä¸­å‚¨å­˜çš„å€¼ç±»å‹å±æ€§ï¼Œä¹Ÿåº”è¯¥è¢«æ‹·è´ï¼Œè€Œä¸æ˜¯è¢«å¼•ç”¨ã€‚
* è¯¥æ•°æ®ç»“æ„ä¸éœ€è¦å»ç»§æ‰¿å¦ä¸€ä¸ªæ—¢æœ‰ç±»å‹çš„å±æ€§æˆ–è€…è¡Œä¸ºã€‚

ä¸¾ä¾‹æ¥è¯´ï¼Œä»¥ä¸‹æƒ…å¢ƒä¸­é€‚åˆä½¿ç”¨ç»“æ„ä½“ï¼š

* å‡ ä½•å½¢çŠ¶çš„å¤§å°ï¼Œå°è£…ä¸€ä¸ªwidthå±æ€§å’Œheightå±æ€§ï¼Œä¸¤è€…å‡ä¸ºDoubleç±»å‹ã€‚
* ä¸€å®šèŒƒå›´å†…çš„è·¯å¾„ï¼Œå°è£…ä¸€ä¸ªstartå±æ€§å’Œlengthå±æ€§ï¼Œä¸¤è€…å‡ä¸ºIntç±»å‹ã€‚
* ä¸‰ç»´åæ ‡ç³»å†…ä¸€ç‚¹ï¼Œå°è£…xï¼Œyå’Œzå±æ€§ï¼Œä¸‰è€…å‡ä¸ºDoubleç±»å‹ã€‚

åœ¨æ‰€æœ‰å…¶å®ƒæ¡ˆä¾‹ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªç±»ï¼Œç”Ÿæˆä¸€ä¸ªå®ƒçš„å®ä¾‹ï¼Œå¹¶é€šè¿‡å¼•ç”¨æ¥ç®¡ç†å’Œä¼ é€’ã€‚å®é™…ä¸­ï¼Œè¿™æ„å‘³ç€ç»å¤§éƒ¨åˆ†çš„è‡ªå®šä¹‰æ•°æ®æ„é€ éƒ½åº”è¯¥æ˜¯ç±»ï¼Œè€Œéç»“æ„ä½“ã€‚


**å­—ç¬¦ä¸²ã€æ•°ç»„ã€å’Œå­—å…¸ç±»å‹çš„èµ‹å€¼ä¸å¤åˆ¶è¡Œä¸º**

Swift ä¸­ï¼Œè®¸å¤šåŸºæœ¬ç±»å‹ï¼Œè¯¸å¦‚`String`ï¼Œ`Array`å’Œ`Dictionary`ç±»å‹å‡ä»¥ç»“æ„ä½“çš„å½¢å¼å®ç°ã€‚è¿™æ„å‘³ç€è¢«èµ‹å€¼ç»™æ–°çš„å¸¸é‡æˆ–å˜é‡ï¼Œæˆ–è€…è¢«ä¼ å…¥å‡½æ•°æˆ–æ–¹æ³•ä¸­æ—¶ï¼Œå®ƒä»¬çš„å€¼ä¼šè¢«æ‹·è´ã€‚

Objective-C ä¸­`NSString`ï¼Œ`NSArray`å’Œ`NSDictionary`ç±»å‹å‡ä»¥ç±»çš„å½¢å¼å®ç°ï¼Œè€Œå¹¶éç»“æ„ä½“ã€‚å®ƒä»¬åœ¨è¢«èµ‹å€¼æˆ–è€…è¢«ä¼ å…¥å‡½æ•°æˆ–æ–¹æ³•æ—¶ï¼Œä¸ä¼šå‘ç”Ÿå€¼æ‹·è´ï¼Œè€Œæ˜¯ä¼ é€’ç°æœ‰å®ä¾‹çš„å¼•ç”¨ã€‚

>æ³¨æ„:
ä»¥ä¸Šæ˜¯å¯¹å­—ç¬¦ä¸²ã€æ•°ç»„ã€å­—å…¸çš„â€œæ‹·è´â€è¡Œä¸ºçš„æè¿°ã€‚åœ¨ä½ çš„ä»£ç ä¸­ï¼Œæ‹·è´è¡Œä¸ºçœ‹èµ·æ¥ä¼¼ä¹æ€»ä¼šå‘ç”Ÿã€‚ç„¶è€Œï¼ŒSwift åœ¨å¹•ååªåœ¨ç»å¯¹å¿…è¦æ—¶æ‰æ‰§è¡Œå®é™…çš„æ‹·è´ã€‚Swift ç®¡ç†æ‰€æœ‰çš„å€¼æ‹·è´ä»¥ç¡®ä¿æ€§èƒ½æœ€ä¼˜åŒ–ï¼Œæ‰€ä»¥ä½ æ²¡å¿…è¦å»å›é¿èµ‹å€¼æ¥ä¿è¯æ€§èƒ½æœ€ä¼˜åŒ–ã€‚


## è‡ªåŠ¨å¼•ç”¨è®¡æ•°

Swift ä½¿ç”¨è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼ˆARCï¼‰æœºåˆ¶æ¥è·Ÿè¸ªå’Œç®¡ç†ä½ çš„åº”ç”¨ç¨‹åºçš„å†…å­˜

>æ³¨æ„
å¼•ç”¨è®¡æ•°ä»…ä»…åº”ç”¨äºç±»çš„å®ä¾‹ã€‚ç»“æ„ä½“å’Œæšä¸¾ç±»å‹æ˜¯å€¼ç±»å‹ï¼Œä¸æ˜¯å¼•ç”¨ç±»å‹ï¼Œä¹Ÿä¸æ˜¯é€šè¿‡å¼•ç”¨çš„æ–¹å¼å­˜å‚¨å’Œä¼ é€’ã€‚

ä¸ºäº†ç¡®ä¿ä½¿ç”¨ä¸­çš„å®ä¾‹ä¸ä¼šè¢«é”€æ¯ï¼ŒARC ä¼šè·Ÿè¸ªå’Œè®¡ç®—æ¯ä¸€ä¸ªå®ä¾‹æ­£åœ¨è¢«å¤šå°‘å±æ€§ï¼Œå¸¸é‡å’Œå˜é‡æ‰€å¼•ç”¨ã€‚å“ªæ€•å®ä¾‹çš„å¼•ç”¨æ•°ä¸º1ï¼ŒARCéƒ½ä¸ä¼šé”€æ¯è¿™ä¸ªå®ä¾‹

example:
```swift
class Person {
    let name: String
    init(name: String) {
        self.name = name
        print("\(name) is being initialized")
    }
    deinit {
        print("\(name) is being deinitialized")
    }
}


var reference1: Person?
var reference2: Person?
var reference3: Person?

reference1 = Person(name: "John Appleseed")
// æ‰“å° "John Appleseed is being initialized"

reference2 = reference1
reference3 = reference1


reference1 = nil
reference2 = nil

reference3 = nil
// æ‰“å° "John Appleseed is being deinitialized"
```

### å¾ªç¯å¼ºå¼•ç”¨
é€šè¿‡å®šä¹‰ç±»ä¹‹é—´çš„å…³ç³»ä¸ºå¼±å¼•ç”¨æˆ–æ— ä¸»å¼•ç”¨ï¼Œä»¥æ›¿ä»£å¼ºå¼•ç”¨ï¼Œä»è€Œè§£å†³å¾ªç¯å¼ºå¼•ç”¨çš„é—®é¢˜


**å¼ºå¼•ç”¨exampleï¼š**
å¯¹äºä¸€èˆ¬ç±»å‹çš„å±æ€§ï¼ŒSwfitè¦æ±‚åœ¨ä¸€ä¸ªç±»çš„åˆå§‹åŒ–æ–¹æ³•ä¸­ä¿è¯å®ƒä¸€å®šæœ‰å€¼,å› æ­¤swiftä¸­å‡ºç°å¾ªç¯å¼•ç”¨çš„æƒ…å†µåªèƒ½æ˜¯ä¸¤ä¸ªå˜é‡è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯optionç±»å‹ã€‚

* ä¸¤ä¸ªéƒ½æ˜¯optionç±»å‹ï¼Œä½¿ç”¨weakå¼±å¼•ç”¨
* æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ˜¯optionç±»å‹ï¼Œä½¿ç”¨unownedæ— ä¸»å¼•ç”¨

```swift
class Person {
    let name: String
    init(name: String) { self.name = name }
    var apartment: Apartment?
    deinit { print("\(name) is being deinitialized") }
}

class Apartment {
    let unit: String
    init(unit: String) { self.unit = unit }
    var tenant: Person?
    deinit { print("Apartment \(unit) is being deinitialized") }
}


var john: Person?
var unit4A: Apartment?

john = Person(name: "John Appleseed")
unit4A = Apartment(unit: "4A")

//äº§ç”Ÿå¾ªç¯å¼ºå¼•ç”¨
john!.apartment = unit4A
unit4A!.tenant = john

//ä¸ä¼šææ„
john = nil
unit4A = nil

```

Swift æä¾›äº†ä¸¤ç§åŠæ³•ç”¨æ¥è§£å†³ä½ åœ¨ä½¿ç”¨ç±»çš„å±æ€§æ—¶æ‰€é‡åˆ°çš„å¾ªç¯å¼ºå¼•ç”¨é—®é¢˜ï¼š
* å¼±å¼•ç”¨ï¼ˆweak referenceï¼‰ï¼Œå£°æ˜å±æ€§æˆ–è€…å˜é‡æ—¶ï¼Œåœ¨å‰é¢åŠ ä¸Š`weak`å…³é”®å­—è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå¼±å¼•ç”¨
* æ— ä¸»å¼•ç”¨ï¼ˆunowned referenceï¼‰

å¼±å¼•ç”¨å’Œæ— ä¸»å¼•ç”¨å…è®¸å¾ªç¯å¼•ç”¨ä¸­çš„ä¸€ä¸ªå®ä¾‹å¼•ç”¨è€Œå¦å¤–ä¸€ä¸ªå®ä¾‹ä¸ä¿æŒå¼ºå¼•ç”¨ã€‚
è¿™æ ·å®ä¾‹èƒ½å¤Ÿäº’ç›¸å¼•ç”¨è€Œä¸äº§ç”Ÿå¾ªç¯å¼ºå¼•ç”¨ã€‚

* å½“å…¶ä»–çš„å®ä¾‹æœ‰æ›´çŸ­çš„ç”Ÿå‘½å‘¨æœŸæ—¶ï¼ˆä¹Ÿå°±æ˜¯å…¶ä»–å®ä¾‹ææ„åœ¨å…ˆæ—¶ï¼‰ï¼Œä½¿ç”¨å¼±å¼•ç”¨ã€‚
* å½“å…¶ä»–å®ä¾‹æœ‰ç›¸åŒçš„æˆ–è€…æ›´é•¿ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œä½¿ç”¨æ— ä¸»å¼•ç”¨

### å¼±å¼•ç”¨
å¼±å¼•ç”¨ä¸ä¼šä¿æŒæ‰€å¼•ç”¨çš„å®ä¾‹ï¼Œå³ä½¿å¼•ç”¨å­˜åœ¨ï¼Œå®ä¾‹ä¹Ÿå¯ä»¥è¢«é”€æ¯ã€‚

å› æ­¤ï¼Œ`ARC` ä¼šåœ¨å¼•ç”¨çš„å®ä¾‹è¢«é”€æ¯åè‡ªåŠ¨å°†å…¶èµ‹å€¼ä¸º`nil`ã€‚
å¹¶ä¸”å› ä¸ºå¼±å¼•ç”¨å¯ä»¥å…è®¸å®ƒä»¬çš„å€¼åœ¨è¿è¡Œæ—¶è¢«èµ‹å€¼ä¸º`nil`ï¼Œæ‰€ä»¥å®ƒä»¬ä¼šè¢«å®šä¹‰ä¸º**å¯é€‰ç±»å‹å˜é‡**ï¼Œè€Œä¸æ˜¯å¸¸é‡ã€‚

>æ³¨æ„
å½“ ARC è®¾ç½®å¼±å¼•ç”¨ä¸ºnilæ—¶ï¼Œå±æ€§è§‚å¯Ÿä¸ä¼šè¢«è§¦å‘ã€‚


```swift
class Person {
    let name: String
    init(name: String) { self.name = name }
    var apartment: Apartment?
    deinit { print("\(name) is being deinitialized") }
}

class Apartment {
    let unit: String
    init(unit: String) { self.unit = unit }
    //å¼±å¼•ç”¨ï¼ŒPersonçš„ç”Ÿå‘½å‘¨æœŸæ›´çŸ­çš„æƒ…å†µä¸‹ä½¿ç”¨
    weak var tenant: Person?
    deinit { print("Apartment \(unit) is being deinitialized") }
}

var john: Person?
var unit4A: Apartment?

john = Person(name: "John Appleseed")
unit4A = Apartment(unit: "4A")

//å¾ªç¯å¼•ç”¨
john!.apartment = unit4A
unit4A!.tenant = john

//ææ„
john = nil
//John Appleseed is being deinitialized
//è¡¨æ˜å¾ªç¯å¼•ç”¨è¢«æ‰“ç ´

unit4A = nil
//Apartment 4A is being deinitialized
```

![](media/15343995130141/15363045169582.jpg)

![](media/15343995130141/15363045355868.jpg)


>æ³¨æ„
åœ¨ä½¿ç”¨åƒåœ¾æ”¶é›†çš„ç³»ç»Ÿé‡Œï¼Œå¼±æŒ‡é’ˆæœ‰æ—¶ç”¨æ¥å®ç°ç®€å•çš„ç¼“å†²æœºåˆ¶ï¼Œå› ä¸ºæ²¡æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡åªä¼šåœ¨å†…å­˜å‹åŠ›è§¦å‘åƒåœ¾æ”¶é›†æ—¶æ‰è¢«é”€æ¯ã€‚ä½†æ˜¯åœ¨ `ARC` ä¸­ï¼Œ**å¦‚æœå¯¹è±¡çš„æœ€åä¸€ä¸ªå¼ºå¼•ç”¨è¢«ç§»é™¤ï¼Œå°±ä¼šè¢«ç«‹å³é”€æ¯ï¼Œè¿™å¯¼è‡´å¼±å¼•ç”¨å¹¶ä¸é€‚åˆä¸Šé¢çš„ç”¨é€”**ã€‚


### æ— ä¸»å¼•ç”¨
å’Œå¼±å¼•ç”¨ç±»ä¼¼ï¼Œæ— ä¸»å¼•ç”¨ä¸ä¼šç‰¢ç‰¢ä¿æŒä½å¼•ç”¨çš„å®ä¾‹ã€‚
å’Œå¼±å¼•ç”¨ä¸åŒçš„æ˜¯ï¼Œ**æ— ä¸»å¼•ç”¨åœ¨å…¶ä»–å®ä¾‹æœ‰ç›¸åŒæˆ–è€…æ›´é•¿çš„ç”Ÿå‘½å‘¨æœŸæ—¶ä½¿ç”¨**ã€‚
åœ¨å£°æ˜å±æ€§æˆ–è€…å˜é‡æ—¶ï¼Œåœ¨å‰é¢åŠ ä¸Šå…³é”®å­—`unowned`è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ— ä¸»å¼•ç”¨ã€‚

æ— ä¸»å¼•ç”¨é€šå¸¸éƒ½è¢«æœŸæœ›æ‹¥æœ‰å€¼ã€‚
ä¸è¿‡ `ARC` æ— æ³•åœ¨å®ä¾‹è¢«é”€æ¯åå°†æ— ä¸»å¼•ç”¨è®¾ä¸º`nil`ï¼Œå› ä¸ºéå¯é€‰ç±»å‹çš„å˜é‡ä¸å…è®¸è¢«èµ‹å€¼ä¸º`nil`ã€‚

`unowned`å£°æ˜çš„åªèƒ½å®šä¹‰ä¸º**éå¯é€‰ç±»å‹**

>é‡è¦
ä½¿ç”¨æ— ä¸»å¼•ç”¨ï¼Œä½ å¿…é¡»ç¡®ä¿å¼•ç”¨å§‹ç»ˆæŒ‡å‘ä¸€ä¸ªæœªé”€æ¯çš„å®ä¾‹ã€‚
å¦‚æœä½ è¯•å›¾åœ¨å®ä¾‹è¢«é”€æ¯åï¼Œè®¿é—®è¯¥å®ä¾‹çš„æ— ä¸»å¼•ç”¨ï¼Œä¼šè§¦å‘è¿è¡Œæ—¶é”™è¯¯ã€‚


```swift
class Customer {
    let name: String
    var card: CreditCard?
    init(name: String) {
        self.name = name
    }
    deinit { print("\(name) is being deinitialized") }
}

class CreditCard {
    let number: UInt64
    //unowned æ— ä¸»åº”ç”¨ï¼ŒCustomerå¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ›´é•¿çš„æƒ…å†µä¸‹ä½¿ç”¨
    //å½“Customerå¯¹è±¡è¢«ç½®ä¸ºnilï¼ŒCreditCardå¯¹è±¡ä¹Ÿä¼šè¢«è‡ªåŠ¨å›æ”¶
    unowned let customer: Customer
    init(number: UInt64, customer: Customer) {
        self.number = number
        self.customer = customer
    }
    deinit { print("Card #\(number) is being deinitialized") }
}

var customer: Customer?

customer = Customer(name: "customer John Appleseed")
customer!.card = CreditCard(number: 1234_5678_9012_3456, customer: customer!)
//æ— ä¸»å¼•ç”¨ç½®ä¸ºnil
customer = nil
//customer John Appleseed is being deinitialized
//Card #1234567890123456 is being deinitialized
```

### å¾ªç¯å¼•ç”¨çš„ç¬¬ä¸‰ç§åœºæ™¯ï¼Œæ— ä¸»å¼•ç”¨ä»¥åŠéšå¼è§£æå¯é€‰å±æ€§

* Personå’ŒApartmentçš„ä¾‹å­å±•ç¤ºäº†ä¸¤ä¸ªå±æ€§çš„å€¼éƒ½å…è®¸ä¸º`nil`ï¼Œå¹¶ä¼šæ½œåœ¨çš„äº§ç”Ÿå¾ªç¯å¼ºå¼•ç”¨ã€‚è¿™ç§åœºæ™¯æœ€é€‚åˆç”¨å¼±å¼•ç”¨æ¥è§£å†³ã€‚

* Customerå’ŒCreditCardçš„ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªå±æ€§çš„å€¼å…è®¸ä¸º`nil`ï¼Œè€Œå¦ä¸€ä¸ªå±æ€§çš„å€¼ä¸å…è®¸ä¸º`nil`ï¼Œè¿™ä¹Ÿå¯èƒ½ä¼šäº§ç”Ÿå¾ªç¯å¼ºå¼•ç”¨ã€‚è¿™ç§åœºæ™¯æœ€é€‚åˆé€šè¿‡æ— ä¸»å¼•ç”¨æ¥è§£å†³ã€‚

* ç„¶è€Œï¼Œå­˜åœ¨ç€ç¬¬ä¸‰ç§åœºæ™¯ï¼Œåœ¨è¿™ç§åœºæ™¯ä¸­ï¼Œ**ä¸¤ä¸ªå±æ€§éƒ½å¿…é¡»æœ‰å€¼**ï¼Œå¹¶ä¸”åˆå§‹åŒ–å®Œæˆåæ°¸è¿œä¸ä¼šä¸º`nil`ã€‚åœ¨è¿™ç§åœºæ™¯ä¸­ï¼Œéœ€è¦ä¸€ä¸ªç±»ä½¿ç”¨**æ— ä¸»å¼•ç”¨**ï¼Œè€Œå¦å¤–ä¸€ä¸ªç±»ä½¿ç”¨**éšå¼è§£æå¯é€‰ç±»å‹**å±æ€§ã€‚


```swift
class Country {
    let name: String
    //å£°æ˜ä¸ºéšå¼è§£æå¯é€‰ç±»å‹çš„å±æ€§ ï¼
    var capitalCity: City!
    init(name: String, capitalName: String) {
        self.name = name
        //Countryçš„æ„é€ å‡½æ•°è°ƒç”¨äº†Cityçš„æ„é€ å‡½æ•°
        self.capitalCity = City(name: capitalName, country: self)
    }
}

class City {
    let name: String
    //æ— ä¸»å¼•ç”¨
    unowned let country: Country
    init(name: String, country: Country) {
        self.name = name
        self.country = country
    }
}
```

`Country`çš„æ„é€ å‡½æ•°è°ƒç”¨äº†`City`çš„æ„é€ å‡½æ•°ï¼Œç„¶è€Œï¼Œåªæœ‰`Country`çš„å®ä¾‹å®Œå…¨åˆå§‹åŒ–åï¼Œ`Country`çš„æ„é€ å‡½æ•°æ‰èƒ½æŠŠ`self`ä¼ ç»™`City`çš„æ„é€ å‡½æ•°ã€‚
ä¸ºäº†æ»¡è¶³è¿™ç§éœ€æ±‚ï¼Œé€šè¿‡åœ¨ç±»å‹ç»“å°¾å¤„åŠ ä¸Šæ„Ÿå¹å·`City!`çš„æ–¹å¼ï¼Œå°†`Country`çš„`capitalCity`å±æ€§å£°æ˜ä¸ºéšå¼è§£æå¯é€‰ç±»å‹çš„å±æ€§ã€‚è¿™æ„å‘³ç€åƒå…¶ä»–å¯é€‰ç±»å‹ä¸€æ ·ï¼Œ`capitalCity`å±æ€§çš„é»˜è®¤å€¼ä¸º`nil`ï¼Œä½†æ˜¯ä¸éœ€è¦å±•å¼€å®ƒçš„å€¼å°±èƒ½è®¿é—®å®ƒã€‚

ç”±äº`capitalCity`é»˜è®¤å€¼ä¸º`nil`ï¼Œä¸€æ—¦`Country`çš„å®ä¾‹åœ¨æ„é€ å‡½æ•°ä¸­ç»™`name`å±æ€§èµ‹å€¼åï¼Œæ•´ä¸ªåˆå§‹åŒ–è¿‡ç¨‹å°±å®Œæˆäº†ã€‚è¿™æ„å‘³ç€ä¸€æ—¦`name`å±æ€§è¢«èµ‹å€¼åï¼Œ`Country`çš„æ„é€ å‡½æ•°å°±èƒ½å¼•ç”¨å¹¶ä¼ é€’éšå¼çš„`self`ã€‚`Country`çš„æ„é€ å‡½æ•°åœ¨èµ‹å€¼`capitalCity`æ—¶ï¼Œå°±èƒ½å°†`self`ä½œä¸ºå‚æ•°ä¼ é€’ç»™`City`çš„æ„é€ å‡½æ•°ã€‚

ä»¥ä¸Šçš„æ„ä¹‰åœ¨äºä½ å¯ä»¥é€šè¿‡ä¸€æ¡è¯­å¥åŒæ—¶åˆ›å»º`Country`å’Œ`City`çš„å®ä¾‹ï¼Œè€Œä¸äº§ç”Ÿå¾ªç¯å¼ºå¼•ç”¨ï¼Œå¹¶ä¸”`capitalCity`çš„å±æ€§èƒ½è¢«ç›´æ¥è®¿é—®ï¼Œè€Œä¸éœ€è¦é€šè¿‡æ„Ÿå¹å·æ¥å±•å¼€å®ƒçš„å¯é€‰å€¼.

```swift
var country = Country(name: "Canada", capitalName: "Ottawa")
print("\(country.name)'s capital city is called \(country.capitalCity.name)")
// æ‰“å° "Canada's capital city is called Ottawa"
```

### é—­åŒ…å¼•èµ·çš„å¾ªç¯å¼ºå¼•ç”¨


å¾ªç¯å¼ºå¼•ç”¨è¿˜ä¼šå‘ç”Ÿåœ¨å½“ä½ å°†ä¸€ä¸ªé—­åŒ…èµ‹å€¼ç»™ç±»å®ä¾‹çš„æŸä¸ªå±æ€§ï¼Œå¹¶ä¸”è¿™ä¸ªé—­åŒ…ä½“ä¸­åˆä½¿ç”¨äº†è¿™ä¸ªç±»å®ä¾‹æ—¶ã€‚è¿™ä¸ªé—­åŒ…ä½“ä¸­å¯èƒ½è®¿é—®äº†å®ä¾‹çš„æŸä¸ªå±æ€§ï¼Œä¾‹å¦‚`self.someProperty`ï¼Œæˆ–è€…é—­åŒ…ä¸­è°ƒç”¨äº†å®ä¾‹çš„æŸä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚`self.someMethod()`ã€‚è¿™ä¸¤ç§æƒ…å†µéƒ½å¯¼è‡´äº†é—­åŒ…â€œæ•è·â€`self`ï¼Œä»è€Œäº§ç”Ÿäº†å¾ªç¯å¼ºå¼•ç”¨ã€‚


>ç±»ä¼¼javaä¸­çš„åŒ¿åå†…éƒ¨ç±»æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨ï¼Œä½†æ˜¯æ³„éœ²çš„æœºåˆ¶æ˜¯ä¸åŒçš„ï¼Œjavaåªéœ€è¦éé™æ€å†…éƒ¨ç±»æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨å°±ä¼šå¯¼è‡´GCä¸èƒ½å›æ”¶å¤–éƒ¨ç±»èµ„æºï¼Œä½†æ˜¯Swiftçš„Arcæœºåˆ¶æ˜¯éœ€è¦é—­åŒ…å’Œå¤–éƒ¨ç±»ç›¸äº’å¾ªç¯å¼ºå¼•ç”¨ã€‚

Swift æä¾›äº†ä¸€ç§ä¼˜é›…çš„æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç§°ä¹‹ä¸º**é—­åŒ…æ•è·åˆ—è¡¨**ï¼ˆclosure capture listï¼‰

å¦‚æœé—­åŒ…æœ‰å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ï¼ŒæŠŠæ•è·åˆ—è¡¨æ”¾åœ¨å®ƒä»¬å‰é¢ï¼š


```swift
lazy var someClosure: (Int, String) -> String = {
    [unowned self, weak delegate = self.delegate!] (index: Int, stringToProcess: String) -> String in
    // è¿™é‡Œæ˜¯é—­åŒ…çš„å‡½æ•°ä½“
}

```

å¦‚æœé—­åŒ…æ²¡æœ‰æŒ‡æ˜å‚æ•°åˆ—è¡¨æˆ–è€…è¿”å›ç±»å‹ï¼Œå³å®ƒä»¬ä¼šé€šè¿‡ä¸Šä¸‹æ–‡æ¨æ–­ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠæ•è·åˆ—è¡¨å’Œå…³é”®å­—inæ”¾åœ¨é—­åŒ…æœ€å¼€å§‹çš„åœ°æ–¹ï¼š

```swift
lazy var someClosure: Void -> String = {
    [unowned self, weak delegate = self.delegate!] in
    // è¿™é‡Œæ˜¯é—­åŒ…çš„å‡½æ•°ä½“
}
```

>åœ¨é—­åŒ…å’Œæ•è·çš„å®ä¾‹æ€»æ˜¯äº’ç›¸å¼•ç”¨å¹¶ä¸”æ€»æ˜¯åŒæ—¶é”€æ¯æ—¶ï¼Œå°†é—­åŒ…å†…çš„æ•è·å®šä¹‰ä¸º**æ— ä¸»å¼•ç”¨**ã€‚
>ç›¸åçš„ï¼Œåœ¨è¢«æ•è·çš„å¼•ç”¨å¯èƒ½ä¼šå˜ä¸º`nil`æ—¶ï¼Œå°†é—­åŒ…å†…çš„æ•è·å®šä¹‰ä¸º**å¼±å¼•ç”¨**ã€‚å¼±å¼•ç”¨æ€»æ˜¯å¯é€‰ç±»å‹ï¼Œå¹¶ä¸”å½“å¼•ç”¨çš„å®ä¾‹è¢«é”€æ¯åï¼Œå¼±å¼•ç”¨çš„å€¼ä¼šè‡ªåŠ¨ç½®ä¸ºnilã€‚è¿™ä½¿æˆ‘ä»¬å¯ä»¥åœ¨é—­åŒ…ä½“å†…æ£€æŸ¥å®ƒä»¬æ˜¯å¦å­˜åœ¨ã€‚


```swift
class HTMLElement {

    let name: String
    let text: String?

    lazy var asHTML: (Void) -> String = {
    //æ•è·åˆ—è¡¨ è¡¨ç¤ºâ€œå°†selfæ•è·ä¸ºæ— ä¸»å¼•ç”¨è€Œä¸æ˜¯å¼ºå¼•ç”¨â€
        [unowned self] in
        if let text = self.text {
            return "<\(self.name)>\(text)</\(self.name)>"
        } else {
            return "<\(self.name) />"
        }
    }

    init(name: String, text: String? = nil) {
        self.name = name
        self.text = text
    }

    deinit {
        print("\(name) is being deinitialized")
    }

}
```




## åè®®å’Œæ‰©å±•

### åè®®protocol


#### åŸºæœ¬ä½¿ç”¨ï¼š
ç±»ä¼¼javaçš„æ¥å£`interface`
ä½¿ç”¨ `protocol` æ¥å£°æ˜ä¸€ä¸ªåè®®ï¼š

```swift
protocol ExampleProtocol {
    var simpleDescription: String { get }
    //mutatingå…³é”®å­—ç”¨æ¥æ ‡è®°ä¸€ä¸ªä¼šä¿®æ”¹ç»“æ„ä½“çš„æ–¹æ³• ç±»ä¼¼javaçš„æŠ½è±¡æ–¹æ³•
    mutating func adjust()
}

//ç±»ã€æšä¸¾å’Œç»“æ„ä½“éƒ½å¯ä»¥å®ç°åè®®
class SimpleClass: ExampleProtocol {
    var simpleDescription: String = "A very simple class."
    var anotherProperty: Int = 69105
    //ä¸éœ€è¦overrideå…³é”®å­—ï¼Œå’Œjavaä¸åŒ
    func adjust() {
        simpleDescription += " Now 100% adjusted."
    }
}
var a = SimpleClass()
a.adjust()
let aDescription = a.simpleDescription

//ç»“æ„ä½“
struct SimpleStructure: ExampleProtocol {
    var simpleDescription: String = "A simple structure"
    mutating func adjust() {
        simpleDescription += " (adjusted)"
    }
}
var b = SimpleStructure()
b.adjust()
let bDescription = b.simpleDescription
```
æ³¨æ„å£°æ˜ ç»“æ„ä½“`SimpleStructure` æ—¶å€™ `mutating` å…³é”®å­—ç”¨æ¥æ ‡è®°ä¸€ä¸ªä¼šä¿®æ”¹ç»“æ„ä½“çš„æ–¹æ³•ã€‚`SimpleClass` çš„å£°æ˜ä¸éœ€è¦æ ‡è®°ä»»ä½•æ–¹æ³•ï¼Œå› ä¸ºç±»ä¸­çš„æ–¹æ³•é€šå¸¸å¯ä»¥ä¿®æ”¹ç±»å±æ€§ï¼ˆç±»çš„æ€§è´¨ï¼‰ã€‚


```swift
protocol SomeClassOnlyProtocol: class, SomeInheritedProtocol {
    //classå…³é”®å­— è¿™é‡Œæ˜¯ç±»ç±»å‹ä¸“å±åè®®çš„å®šä¹‰éƒ¨åˆ†
}
```
#### æä¾›é»˜è®¤å®ç°
å¯ä»¥é€šè¿‡åè®®æ‰©å±•æ¥ä¸ºåè®®è¦æ±‚çš„å±æ€§ã€æ–¹æ³•ä»¥åŠä¸‹æ ‡æä¾›é»˜è®¤çš„å®ç°ã€‚
å¦‚æœéµå¾ªåè®®çš„ç±»å‹ä¸ºè¿™äº›è¦æ±‚æä¾›äº†è‡ªå·±çš„å®ç°ï¼Œé‚£ä¹ˆè¿™äº›è‡ªå®šä¹‰å®ç°å°†ä¼šæ›¿ä»£æ‰©å±•ä¸­çš„é»˜è®¤å®ç°è¢«ä½¿ç”¨ã€‚


```swift

protocol TextRepresentable {
    var textualDescription: String { get }
}


protocol PrettyTextRepresentable: TextRepresentable {
    var prettyTextualDescription: String { get }
}

//ä¸ºå…¶æä¾›ä¸€ä¸ªé»˜è®¤çš„ prettyTextualDescription å±æ€§
extension PrettyTextRepresentable {
    var prettyTextualDescription: String {
        return textualDescription
    }
}

```


#### ä¸ºåè®®æ‰©å±•æ·»åŠ é™åˆ¶æ¡ä»¶
åœ¨æ‰©å±•åè®®çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®šä¸€äº›é™åˆ¶æ¡ä»¶ï¼Œåªæœ‰éµå¾ªåè®®çš„ç±»å‹æ»¡è¶³è¿™äº›é™åˆ¶æ¡ä»¶æ—¶ï¼Œæ‰èƒ½è·å¾—åè®®æ‰©å±•æä¾›çš„é»˜è®¤å®ç°ã€‚è¿™äº›é™åˆ¶æ¡ä»¶å†™åœ¨åè®®åä¹‹åï¼Œä½¿ç”¨ `where` å­å¥æ¥æè¿°


```swift
//æ‰©å±• CollectionType åè®®ï¼Œä½†æ˜¯åªé€‚ç”¨äºé›†åˆä¸­çš„å…ƒç´ éµå¾ªäº† TextRepresentable åè®®çš„æƒ…å†µ
extension Collection where Iterator.Element: TextRepresentable {
    var textualDescription: String {
        let itemsAsText = self.map { $0.textualDescription }
        return "[" + itemsAsText.joined(separator: ", ") + "]"
    }
}
```

>æ³¨æ„
å¦‚æœå¤šä¸ªåè®®æ‰©å±•éƒ½ä¸ºåŒä¸€ä¸ªåè®®è¦æ±‚æä¾›äº†é»˜è®¤å®ç°ï¼Œè€Œéµå¾ªåè®®çš„ç±»å‹åˆåŒæ—¶æ»¡è¶³è¿™äº›åè®®æ‰©å±•çš„é™åˆ¶æ¡ä»¶ï¼Œé‚£ä¹ˆå°†ä¼šä½¿ç”¨é™åˆ¶æ¡ä»¶æœ€å¤šçš„é‚£ä¸ªåè®®æ‰©å±•æä¾›çš„é»˜è®¤å®ç°ã€‚

### æ‰©å±•extension
Swift ä¸­çš„æ‰©å±•å¯ä»¥ï¼š

* æ·»åŠ è®¡ç®—å‹å±æ€§å’Œè®¡ç®—å‹ç±»å‹å±æ€§
* å®šä¹‰å®ä¾‹æ–¹æ³•å’Œç±»å‹æ–¹æ³•
* æä¾›æ–°çš„æ„é€ å™¨
* å®šä¹‰ä¸‹æ ‡
* å®šä¹‰å’Œä½¿ç”¨æ–°çš„åµŒå¥—ç±»å‹
* ä½¿ä¸€ä¸ªå·²æœ‰ç±»å‹ç¬¦åˆæŸä¸ªåè®®

>æ³¨æ„
æ‰©å±•å¯ä»¥ä¸ºä¸€ä¸ªç±»å‹æ·»åŠ æ–°çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸èƒ½é‡å†™å·²æœ‰çš„åŠŸèƒ½ã€‚


ä½¿ç”¨ `extension` æ¥ä¸ºç°æœ‰çš„ç±»å‹æ·»åŠ `protocol`åŠŸèƒ½ï¼Œæ¯”å¦‚æ–°çš„æ–¹æ³•å’Œè®¡ç®—å±æ€§ã€‚
**ä½ å¯ä»¥ä½¿ç”¨æ‰©å±•è®©æŸä¸ªåœ¨åˆ«å¤„å£°æ˜çš„ç±»å‹æ¥éµå®ˆæŸä¸ªåè®®ï¼Œè¿™åŒæ ·é€‚ç”¨äºä»å¤–éƒ¨åº“æˆ–è€…æ¡†æ¶å¼•å…¥çš„ç±»å‹ã€‚**

```swift

extension SomeType {
    // ä¸º SomeType æ·»åŠ çš„æ–°åŠŸèƒ½å†™åˆ°è¿™é‡Œ
}


//è®¡ç®—å‹å®ä¾‹å±æ€§
extension Double {
    var km: Double { return self * 1_000.0 }
    var m : Double { return self }
    var cm: Double { return self / 100.0 }
    var mm: Double { return self / 1_000.0 }
    var ft: Double { return self / 3.28084 }
}
let oneInch = 25.4.mm
print("One inch is \(oneInch) meters")
// æ‰“å° â€œOne inch is 0.0254 metersâ€
let threeFeet = 3.ft
print("Three feet is \(threeFeet) meters")
// æ‰“å° â€œThree feet is 0.914399970739201 metersâ€

//å®ä¾‹æ–¹æ³•
extension Int {
    func repetitions(task: () -> Void) {
        for _ in 0..<self {
            task()
        }
    }
}

//å¯å˜å®ä¾‹æ–¹æ³•
extension Int {
//ç»“æ„ä½“å’Œæšä¸¾ç±»å‹ä¸­ä¿®æ”¹ self æˆ–å…¶å±æ€§çš„æ–¹æ³•å¿…é¡»å°†è¯¥å®ä¾‹æ–¹æ³•æ ‡æ³¨ä¸º mutating
    mutating func square() {
        self = self * self
    }
}
var someInt = 3
someInt.square()
// someInt çš„å€¼ç°åœ¨æ˜¯ 9


//ä¸‹æ ‡
extension Int {
    subscript(digitIndex: Int) -> Int {
        var decimalBase = 1
        for _ in 0..<digitIndex {
            decimalBase *= 10
        }
        return (self / decimalBase) % 10
    }
}
746381295[0]
// è¿”å› 5
746381295[1]
// è¿”å› 9
746381295[2]
// è¿”å› 2
746381295[8]
// è¿”å› 7



//åµŒå¥—ç±»å‹
extension Int {
    enum Kind {
        case Negative, Zero, Positive
    }
    var kind: Kind {
        switch self {
        case 0:
            return .Zero
        case let x where x > 0:
            return .Positive
        default:
            return .Negative
        }
    }
}
```

>æ³¨æ„
å¦‚æœä½ é€šè¿‡æ‰©å±•ä¸ºä¸€ä¸ªå·²æœ‰ç±»å‹æ·»åŠ æ–°åŠŸèƒ½ï¼Œé‚£ä¹ˆæ–°åŠŸèƒ½å¯¹è¯¥ç±»å‹çš„æ‰€æœ‰å·²æœ‰å®ä¾‹éƒ½æ˜¯å¯ç”¨çš„ï¼Œå³ä½¿å®ƒä»¬æ˜¯åœ¨è¿™ä¸ªæ‰©å±•å®šä¹‰ä¹‹å‰åˆ›å»ºçš„ã€‚

>æ³¨æ„
æ‰©å±•å¯ä»¥æ·»åŠ æ–°çš„è®¡ç®—å‹å±æ€§ï¼Œä½†æ˜¯ä¸å¯ä»¥æ·»åŠ å­˜å‚¨å‹å±æ€§ï¼Œä¹Ÿä¸å¯ä»¥ä¸ºå·²æœ‰å±æ€§æ·»åŠ å±æ€§è§‚å¯Ÿå™¨ã€‚

æ‰©å±•èƒ½ä¸ºç±»æ·»åŠ æ–°çš„ä¾¿åˆ©æ„é€ å™¨ï¼Œä½†æ˜¯å®ƒä»¬ä¸èƒ½ä¸ºç±»æ·»åŠ æ–°çš„æŒ‡å®šæ„é€ å™¨æˆ–ææ„å™¨ã€‚æŒ‡å®šæ„é€ å™¨å’Œææ„å™¨å¿…é¡»æ€»æ˜¯ç”±åŸå§‹çš„ç±»å®ç°æ¥æä¾›ã€‚




ä½ å¯ä»¥åƒä½¿ç”¨å…¶ä»–å‘½åç±»å‹ä¸€æ ·ä½¿ç”¨åè®®åâ€”â€”ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªæœ‰ä¸åŒç±»å‹ä½†æ˜¯éƒ½å®ç°ä¸€ä¸ªåè®®çš„å¯¹è±¡é›†åˆã€‚å½“ä½ å¤„ç†ç±»å‹æ˜¯åè®®çš„å€¼æ—¶ï¼Œåè®®å¤–å®šä¹‰çš„æ–¹æ³•ä¸å¯ç”¨ã€‚

```swift

protocol ExampleProtocol {
    var simpleDescription: String { get }
    //mutatingå…³é”®å­—ç”¨æ¥æ ‡è®°ä¸€ä¸ªä¼šä¿®æ”¹ç»“æ„ä½“çš„æ–¹æ³• ç±»ä¼¼javaçš„æŠ½è±¡æ–¹æ³•
    mutating func adjust()
}

class SimpleClass: ExampleProtocol {
    var simpleDescription: String = "A very simple class."
    var anotherProperty: Int = 69105
    func adjust() {
        simpleDescription += " Now 100% adjusted."
    }
}

var a1 = SimpleClass()
//å£°æ˜ExampleProtocolåè®®ç±»å‹çš„å˜é‡
let protocolValue: ExampleProtocol = a1
//åè®®å†…æ–¹æ³•å¯ç”¨
print(protocolValue.simpleDescription)

//è¿™å’Œjavaç±»ä¼¼ï¼Œç¼–è¯‘å™¨åªçŸ¥é“protocolValueæ˜¯ExampleProtocolç±»å‹ï¼Œè‡ªç„¶ä¸èƒ½ä½¿ç”¨å…¶å­ç±»SimpleClasså®šä¹‰çš„æ–¹æ³•ã€‚
//å³ä½¿ protocolValue å˜é‡è¿è¡Œæ—¶çš„ç±»å‹æ˜¯ simpleClass ï¼Œç¼–è¯‘å™¨è¿˜æ˜¯ä¼šæŠŠå®ƒçš„ç±»å‹å½“åšå£°æ˜æ—¶çš„ç±»å‹ExampleProtocolã€‚

//print(protocolValue.anotherProperty) // å»æ‰æ³¨é‡Šå¯ä»¥çœ‹åˆ°é”™è¯¯

```

## é”™è¯¯å¤„ç†

ä½¿ç”¨é‡‡ç”¨ `Error` **åè®®**çš„ç±»å‹æ¥è¡¨ç¤ºé”™è¯¯

### å®šä¹‰é”™è¯¯`Error`ï¼š
```swift
enum PrinterError: Error {
    case outOfPaper
    case noToner
    case onFire
}
```

### throw
ä½¿ç”¨ `throw` æ¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯å¹¶ä½¿ç”¨ `throws` æ¥è¡¨ç¤ºä¸€ä¸ªå¯ä»¥æŠ›å‡ºé”™è¯¯çš„å‡½æ•°
å¦‚æœåœ¨å‡½æ•°ä¸­æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™ä¸ªå‡½æ•°ä¼šç«‹åˆ»è¿”å›å¹¶ä¸”è°ƒç”¨è¯¥å‡½æ•°çš„ä»£ç ä¼šè¿›è¡Œé”™è¯¯å¤„ç†

>æ³¨æ„
åªæœ‰ throwing å‡½æ•°å¯ä»¥ä¼ é€’é”™è¯¯ã€‚ä»»ä½•åœ¨æŸä¸ªé throwing å‡½æ•°å†…éƒ¨æŠ›å‡ºçš„é”™è¯¯åªèƒ½åœ¨å‡½æ•°å†…éƒ¨å¤„ç†ã€‚


```swift
func canThrowAnError() throws {
    // è¿™ä¸ªå‡½æ•°æœ‰å¯èƒ½æŠ›å‡ºé”™è¯¯
}
```

```swift
//å¦‚æœè¿™ä¸ªå‡½æ•°æŒ‡æ˜äº†è¿”å›å€¼ç±»å‹ï¼Œthrowså…³é”®è¯éœ€è¦å†™åœ¨ç®­å¤´ï¼ˆ->ï¼‰çš„å‰é¢
func send(job: Int, toPrinter printerName: String) throws -> String {
    if printerName == "Never Has Toner" {
        throw PrinterError.noToner
    }
    return "Job sent"
}
```



>æ³¨æ„
Swift ä¸­çš„é”™è¯¯å¤„ç†å’Œå…¶ä»–è¯­è¨€ä¸­ç”¨tryï¼Œcatchå’Œthrowè¿›è¡Œå¼‚å¸¸å¤„ç†å¾ˆåƒã€‚å’Œå…¶ä»–è¯­è¨€ä¸­ï¼ˆåŒ…æ‹¬ Objective-C ï¼‰çš„å¼‚å¸¸å¤„ç†ä¸åŒçš„æ˜¯ï¼ŒSwift ä¸­çš„é”™è¯¯å¤„ç†å¹¶ä¸æ¶‰åŠè§£é™¤è°ƒç”¨æ ˆï¼Œè¿™æ˜¯ä¸€ä¸ªè®¡ç®—ä»£ä»·é«˜æ˜‚çš„è¿‡ç¨‹ã€‚å°±æ­¤è€Œè¨€ï¼Œ`throw`è¯­å¥çš„æ€§èƒ½ç‰¹æ€§æ˜¯å¯ä»¥å’Œ`return`è¯­å¥ç›¸åª²ç¾çš„ã€‚


**é”™è¯¯å¤„ç†çš„æ–¹æ³•ï¼š**

### do-catch
ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨ `do-catch` ã€‚åœ¨ do ä»£ç å—ä¸­ï¼Œä½¿ç”¨ `try` æ¥æ ‡è®°å¯ä»¥æŠ›å‡ºé”™è¯¯çš„ä»£ç ã€‚åœ¨ catch ä»£ç å—ä¸­ï¼Œé™¤éä½ å¦å¤–å‘½åï¼Œå¦åˆ™é”™è¯¯ä¼šè‡ªåŠ¨å‘½åä¸º error ã€‚

```swift
do {
    //ä½¿ç”¨ `try` æ¥æ ‡è®°å¯ä»¥æŠ›å‡ºé”™è¯¯çš„ä»£ç 
    let printerResponse = try send(job: 1040, toPrinter: "Bi Sheng")
    print(printerResponse)
} catch {
    print(error)
}
```

å¯ä»¥ä½¿ç”¨å¤šä¸ª `catch` å—æ¥å¤„ç†ç‰¹å®šçš„é”™è¯¯ã€‚å‚ç…§ switch ä¸­çš„ `case` é£æ ¼æ¥å†™ `catch`ã€‚

```swift

func send(job: Int, toPrinter printerName: String) throws -> String {
    if printerName == "Bi Sheng" {
        throw PrinterError.noToner
    }else if printerName == "Gutenberg"{
        throw PrinterError.onFire
    }
    return "Job sent"
}



do {
    let printerResponse = try send(job: 1440, toPrinter: "Gutenberg")
    print(printerResponse)
} catch PrinterError.onFire {
    print("I'll just put this over here, with the rest of the fire.")
} catch let printerError as PrinterError {
    print("Printer error: \(printerError).")
} catch {
    print(error)
}

```
### try?
å¦ä¸€ç§å¤„ç†é”™è¯¯çš„æ–¹å¼ä½¿ç”¨` try?` å°†ç»“æœè½¬æ¢ä¸ºå¯é€‰çš„ã€‚
å¦‚æœå‡½æ•°æŠ›å‡ºé”™è¯¯ï¼Œè¯¥é”™è¯¯ä¼šè¢«æŠ›å¼ƒå¹¶ä¸”ç»“æœä¸º `nil`ã€‚å¦åˆ™çš„è¯ï¼Œç»“æœä¼šæ˜¯ä¸€ä¸ªåŒ…å«å‡½æ•°è¿”å›å€¼çš„å¯é€‰å€¼ã€‚

```swift
let printerSuccess = try? send(job: 1884, toPrinter: "Gutenberg")
let printerFailure = try? send(job: 1885, toPrinter: "Never Has Toner")
```

### try!
æŸä¸ªthrowingå‡½æ•°å®é™…ä¸Šåœ¨è¿è¡Œæ—¶æ˜¯ä¸ä¼šæŠ›å‡ºé”™è¯¯çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åœ¨è¡¨è¾¾å¼å‰é¢å†™`try!`æ¥ç¦ç”¨é”™è¯¯ä¼ é€’ï¼Œè¿™ä¼šæŠŠè°ƒç”¨åŒ…è£…åœ¨ä¸€ä¸ªä¸ä¼šæœ‰é”™è¯¯æŠ›å‡ºçš„è¿è¡Œæ—¶æ–­è¨€ä¸­ã€‚å¦‚æœçœŸçš„æŠ›å‡ºäº†é”™è¯¯ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ã€‚

```swift
let photo = try! loadImage(atPath: "./Resources/John Appleseed.jpg")
```


### defer
ä½¿ç”¨ `defer` ä»£ç å—æ¥è¡¨ç¤ºåœ¨å‡½æ•°è¿”å›å‰ï¼Œå‡½æ•°ä¸­æœ€åæ‰§è¡Œçš„ä»£ç ã€‚
**æ— è®ºå‡½æ•°æ˜¯å¦ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè¿™æ®µä»£ç éƒ½å°†æ‰§è¡Œã€‚**
ä½¿ç”¨ `defer`ï¼Œå¯ä»¥æŠŠå‡½æ•°è°ƒç”¨ä¹‹åˆå°±è¦æ‰§è¡Œçš„ä»£ç å’Œå‡½æ•°è°ƒç”¨ç»“æŸæ—¶çš„æ‰«å°¾ä»£ç å†™åœ¨ä¸€èµ·ï¼Œè™½ç„¶è¿™ä¸¤è€…çš„æ‰§è¡Œæ—¶æœºæˆªç„¶ä¸åŒã€‚
ç±»ä¼¼javaä¸­çš„`finally`ã€‚

```swift
var fridgeIsOpen = false

func fridgeContains() {
    fridgeIsOpen = true
    defer {
        fridgeIsOpen = false
    }
}
print(fridgeIsOpen)

```

## ç±»å‹è½¬æ¢
ç±»å‹è½¬æ¢åœ¨ Swift ä¸­ä½¿ç”¨ is å’Œ as æ“ä½œç¬¦å®ç°ã€‚
ä¹Ÿå¯ä»¥ç”¨å®ƒæ¥æ£€æŸ¥ä¸€ä¸ªç±»å‹æ˜¯å¦å®ç°äº†æŸä¸ªåè®®


### æ£€æŸ¥ç±»å‹is
```swift
var movieCount = 0
var songCount = 0

for item in library {
    //åˆ¤æ–­ç±»å‹
    if item is Movie {
        movieCount += 1
    } else if item is Song {
        songCount += 1
    }
}

print("Media library contains \(movieCount) movies and \(songCount) songs")
// æ‰“å° â€œMedia library contains 2 movies and 3 songsâ€

```
### å‘ä¸‹è½¬å‹as
æŸç±»å‹çš„ä¸€ä¸ªå¸¸é‡æˆ–å˜é‡å¯èƒ½åœ¨å®é™…ä¸Šå±äºä¸€ä¸ªå­ç±»ã€‚
å°è¯•å‘ä¸‹è½¬åˆ°å®ƒçš„å­ç±»å‹ï¼Œç”¨ç±»å‹è½¬æ¢æ“ä½œç¬¦ï¼ˆ`as?` æˆ–` as!`ï¼‰ã€‚

å› ä¸ºå‘ä¸‹è½¬å‹å¯èƒ½ä¼šå¤±è´¥ï¼Œç±»å‹è½¬å‹æ“ä½œç¬¦å¸¦æœ‰ä¸¤ç§ä¸åŒå½¢å¼ã€‚æ¡ä»¶å½¢å¼`as?` è¿”å›ä¸€ä¸ªä½ è¯•å›¾å‘ä¸‹è½¬æˆçš„ç±»å‹çš„å¯é€‰å€¼ã€‚
å¼ºåˆ¶å½¢å¼ `as!` æŠŠè¯•å›¾å‘ä¸‹è½¬å‹å’Œå¼ºåˆ¶è§£åŒ…è½¬æ¢ç»“æœç»“åˆä¸ºä¸€ä¸ªæ“ä½œã€‚

å½“ä½ ä¸ç¡®å®šå‘ä¸‹è½¬å‹å¯ä»¥æˆåŠŸæ—¶ï¼Œç”¨ç±»å‹è½¬æ¢çš„æ¡ä»¶å½¢å¼ï¼ˆ`as?`ï¼‰ã€‚æ¡ä»¶å½¢å¼çš„ç±»å‹è½¬æ¢æ€»æ˜¯è¿”å›ä¸€ä¸ªå¯é€‰å€¼ï¼Œå¹¶ä¸”è‹¥ä¸‹è½¬æ˜¯ä¸å¯èƒ½çš„ï¼Œå¯é€‰å€¼å°†æ˜¯ `nil`ã€‚è¿™ä½¿ä½ èƒ½å¤Ÿæ£€æŸ¥å‘ä¸‹è½¬å‹æ˜¯å¦æˆåŠŸã€‚

åªæœ‰ä½ å¯ä»¥ç¡®å®šå‘ä¸‹è½¬å‹ä¸€å®šä¼šæˆåŠŸæ—¶ï¼Œæ‰ä½¿ç”¨å¼ºåˆ¶å½¢å¼ï¼ˆ`as!`ï¼‰ã€‚å½“ä½ è¯•å›¾å‘ä¸‹è½¬å‹ä¸ºä¸€ä¸ªä¸æ­£ç¡®çš„ç±»å‹æ—¶ï¼Œå¼ºåˆ¶å½¢å¼çš„ç±»å‹è½¬æ¢ä¼šè§¦å‘ä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ã€‚


```swift
for item in library {
    //ç»“åˆå¯é€‰ç»‘å®šä¸€èµ·ä½¿ç”¨
    if let movie = item as? Movie {
        print("Movie: '\(movie.name)', dir. \(movie.director)")
    } else if let song = item as? Song {
        print("Song: '\(song.name)', by \(song.artist)")
    }
}
```
å½“å‘ä¸‹è½¬å‹ä¸º Movie åº”ç”¨åœ¨ä¸¤ä¸ª Song å®ä¾‹æ—¶å°†ä¼šå¤±è´¥ã€‚
ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œä¸Šé¢çš„ä¾‹å­ä½¿ç”¨äº†å¯é€‰ç»‘å®šï¼ˆoptional bindingï¼‰æ¥æ£€æŸ¥å¯é€‰ Movie çœŸçš„åŒ…å«ä¸€ä¸ªå€¼ï¼ˆè¿™ä¸ªæ˜¯ä¸ºäº†åˆ¤æ–­ä¸‹è½¬æ˜¯å¦æˆåŠŸã€‚ï¼‰


### Any å’Œ AnyObject çš„ç±»å‹è½¬æ¢

Swift ä¸ºä¸ç¡®å®šç±»å‹æä¾›äº†ä¸¤ç§ç‰¹æ®Šçš„ç±»å‹åˆ«åï¼š

* `Any` å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»å‹ï¼ŒåŒ…æ‹¬å‡½æ•°ç±»å‹ã€‚
* `AnyObject` å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»ç±»å‹çš„å®ä¾‹ã€‚

åªæœ‰å½“ä½ ç¡®å®éœ€è¦å®ƒä»¬çš„è¡Œä¸ºå’ŒåŠŸèƒ½æ—¶æ‰ä½¿ç”¨ `Any` å’Œ `AnyObject`ã€‚åœ¨ä½ çš„ä»£ç é‡Œä½¿ç”¨ä½ æœŸæœ›çš„æ˜ç¡®ç±»å‹æ€»æ˜¯æ›´å¥½çš„ã€‚


```swift
var things = [Any]()

things.append(0)
things.append(0.0)
things.append(42)
things.append(3.14159)
things.append("hello")
things.append((3.0, 5.0))
things.append(Movie(name: "Ghostbusters", director: "Ivan Reitman"))
things.append({ (name: String) -> String in "Hello, \(name)" })

```


>æ³¨æ„
Anyç±»å‹å¯ä»¥è¡¨ç¤ºæ‰€æœ‰ç±»å‹çš„å€¼ï¼ŒåŒ…æ‹¬å¯é€‰ç±»å‹ã€‚Swift ä¼šåœ¨ä½ ç”¨Anyç±»å‹æ¥è¡¨ç¤ºä¸€ä¸ªå¯é€‰å€¼çš„æ—¶å€™ï¼Œç»™ä½ ä¸€ä¸ªè­¦å‘Šã€‚å¦‚æœä½ ç¡®å®æƒ³ä½¿ç”¨Anyç±»å‹æ¥æ‰¿è½½å¯é€‰å€¼ï¼Œä½ å¯ä»¥ä½¿ç”¨asæ“ä½œç¬¦æ˜¾å¼è½¬æ¢ä¸ºAnyï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```swift
let optionalNumber: Int? = 3
things.append(optionalNumber)        // è­¦å‘Š
things.append(optionalNumber as Any) // æ²¡æœ‰è­¦å‘Š
```

## åµŒå¥—ç±»å‹

è¦åœ¨ä¸€ä¸ªç±»å‹ä¸­åµŒå¥—å¦ä¸€ä¸ªç±»å‹ï¼Œå°†åµŒå¥—ç±»å‹çš„å®šä¹‰å†™åœ¨å…¶å¤–éƒ¨ç±»å‹çš„ `{}` å†…ï¼Œè€Œä¸”å¯ä»¥æ ¹æ®éœ€è¦å®šä¹‰å¤šçº§åµŒå¥—ã€‚


```swift
struct BlackjackCard {
    
    // åµŒå¥—çš„ Suit æšä¸¾
    enum Suit: Character {
        case spades = "â™ ", hearts = "â™¡", diamonds = "â™¢", clubs = "â™£"
    }
    
    // åµŒå¥—çš„ Rank æšä¸¾
    enum Rank: Int {
        case two = 2, three, four, five, six, seven, eight, nine, ten
        case jack, queen, king, ace
        //ç»“æ„ä½“ Values ä¸­å®šä¹‰äº†ä¸¤ä¸ªå±æ€§ï¼Œç”¨äºåæ˜ åªæœ‰ Ace æœ‰ä¸¤ä¸ªæ•°å€¼ï¼Œå…¶ä½™ç‰Œéƒ½åªæœ‰ä¸€ä¸ªæ•°å€¼
        struct Values {
            let first: Int, second: Int?
        }
        var values: Values {
            switch self {
            case .ace:
                return Values(first: 1, second: 11)
            case .jack, .queen, .king:
                return Values(first: 10, second: nil)
            default:
                return Values(first: self.rawValue, second: nil)
            }
        }
    }
    
    // BlackjackCard çš„å±æ€§å’Œæ–¹æ³•
    let rank: Rank, suit: Suit
    var description: String {
        var output = "suit is \(suit.rawValue),"
        output += " value is \(rank.values.first)"
        if let second = rank.values.second {
            output += " or \(second)"
        }
        return output
    }
}
let theAceOfSpades = BlackjackCard(rank: .ace, suit: .spades)
print("theAceOfSpades: \(theAceOfSpades.description)")
// æ‰“å° â€œtheAceOfSpades: suit is â™ , value is 1 or 11â€
```








## æ³›å‹
åœ¨å°–æ‹¬å·é‡Œå†™ä¸€ä¸ªåå­—æ¥åˆ›å»ºä¸€ä¸ªæ³›å‹å‡½æ•°æˆ–è€…ç±»å‹

### å®šä¹‰å’Œä½¿ç”¨ï¼š
```swift
//æ³›å‹å‡½æ•°
func swapTwoValues<T>(_ a: inout T, _ b: inout T) {
    let temporaryA = a
    a = b
    b = temporaryA
}

var a = 11;
var b = 12
swapTwoValues(&a, &b)
print(a)
print(b)
```

å¯ä»¥åˆ›å»ºæ³›å‹å‡½æ•°ã€æ–¹æ³•ã€ç±»ã€æšä¸¾å’Œç»“æ„ä½“

```swift
enum OptionalValue<Wrapped> {
    case None
    case Some(Wrapped)
}
var possibleInteger: OptionalValue<Int> = .None
possibleInteger = .Some(100)
```


åœ¨ç±»å‹ååé¢ä½¿ç”¨ `where` æ¥æŒ‡å®šå¯¹ç±»å‹çš„éœ€æ±‚ï¼Œæ¯”å¦‚ï¼Œé™å®šç±»å‹å®ç°æŸä¸€ä¸ªåè®®ï¼Œé™å®šä¸¤ä¸ªç±»å‹æ˜¯ç›¸åŒçš„ï¼Œæˆ–è€…é™å®šæŸä¸ªç±»å¿…é¡»æœ‰ä¸€ä¸ªç‰¹å®šçš„çˆ¶ç±»ã€‚

```swift

func anyCommonElements<T: Sequence, U: Sequence>(_ lhs: T, _ rhs: U) -> Bool
//whereæ¡ä»¶æŒ‡å®šT.Iterator.Elementå®ç°Equatableåè®®ï¼ŒT.Iterator.Elementå’ŒU.Iterator.Elementçš„ç±»å‹ç›¸åŒ
    where T.Iterator.Element: Equatable, T.Iterator.Element == U.Iterator.Element {
        for lhsItem in lhs {
            for rhsItem in rhs {
                if lhsItem == rhsItem {
                    return true
                }
            }
        }
        return false
}
anyCommonElements([1, 2, 3], [3])
```

### ç±»å‹çº¦æŸ
ç±»å‹çº¦æŸå¯ä»¥æŒ‡å®šä¸€ä¸ªç±»å‹å‚æ•°å¿…é¡»ç»§æ‰¿è‡ªæŒ‡å®šç±»ï¼Œæˆ–è€…ç¬¦åˆä¸€ä¸ªç‰¹å®šçš„åè®®æˆ–åè®®ç»„åˆ


ç¬¬ä¸€ä¸ªç±»å‹å‚æ•° Tï¼Œæœ‰ä¸€ä¸ªè¦æ±‚ T å¿…é¡»æ˜¯ `SomeClass` å­ç±»çš„ç±»å‹çº¦æŸï¼›ç¬¬äºŒä¸ªç±»å‹å‚æ•° Uï¼Œæœ‰ä¸€ä¸ªè¦æ±‚ U å¿…é¡»ç¬¦åˆ `SomeProtocol` åè®®çš„ç±»å‹çº¦æŸ
```swift
func someFunction<T: SomeClass, U: SomeProtocol>(someT: T, someU: U) {
    // è¿™é‡Œæ˜¯æ³›å‹å‡½æ•°çš„å‡½æ•°ä½“éƒ¨åˆ†
}
```
### å…³è”ç±»å‹
å®šä¹‰ä¸€ä¸ªåè®®æ—¶ï¼Œæœ‰çš„æ—¶å€™å£°æ˜ä¸€ä¸ªæˆ–å¤šä¸ªå…³è”ç±»å‹ä½œä¸ºåè®®å®šä¹‰çš„ä¸€éƒ¨åˆ†å°†ä¼šéå¸¸æœ‰ç”¨ã€‚

å…³è”ç±»å‹ä¸ºåè®®ä¸­çš„æŸä¸ªç±»å‹æä¾›äº†ä¸€ä¸ªå ä½åï¼ˆæˆ–è€…è¯´åˆ«åï¼‰ï¼Œå…¶ä»£è¡¨çš„å®é™…ç±»å‹åœ¨åè®®è¢«é‡‡çº³æ—¶æ‰ä¼šè¢«æŒ‡å®šã€‚ä½ å¯ä»¥é€šè¿‡ `associatedtype` å…³é”®å­—æ¥æŒ‡å®šå…³è”ç±»å‹ã€‚



ä¸ºäº†å®šä¹‰è¿™ä¸‰ä¸ªåè®®æ–¹æ³•ï¼Œ`Container` åè®®éœ€è¦åœ¨ä¸çŸ¥é“å®¹å™¨ä¸­å…ƒç´ çš„å…·ä½“ç±»å‹çš„æƒ…å†µä¸‹å¼•ç”¨è¿™ç§ç±»å‹ã€‚
ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œ`Container` åè®®å£°æ˜äº†ä¸€ä¸ªå…³è”ç±»å‹ `ItemType`ï¼ŒItemType åˆ«åæä¾›äº†ä¸€ç§æ–¹å¼æ¥å¼•ç”¨ Container ä¸­å…ƒç´ çš„ç±»å‹ã€‚


```swift
protocol Container {
    //å£°æ˜äº†ä¸€ä¸ªå…³è”ç±»å‹ `ItemType`
    associatedtype ItemType
    mutating func append(_ item: ItemType)
    var count: Int { get }
    subscript(i: Int) -> ItemType { get }
}

struct IntStack: Container {
    // IntStack çš„åŸå§‹å®ç°éƒ¨åˆ†
    var items = [Int]()
    mutating func push(_ item: Int) {
        items.append(item)
    }
    mutating func pop() -> Int {
        return items.removeLast()
    }
    // Container åè®®çš„å®ç°éƒ¨åˆ†
    //æŒ‡å®š ItemType ä¸º Int ç±»å‹ï¼Œç”±äºç±»å‹æ¨æ–­ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥çœç•¥
    typealias ItemType = Int
    mutating func append(_ item: Int) {
        self.push(item)
    }
    var count: Int {
        return items.count
    }
    subscript(i: Int) -> Int {
        return items[i]
    }
}
```

### æ‰©å±•ä¸€ä¸ªå­˜åœ¨çš„ç±»å‹æ¥æŒ‡å®šå…³è”ç±»å‹

```swift
extension Array: Container {}
```

### çº¦æŸå…³è”ç±»å‹
ç»™åè®®é‡Œçš„å…³è”ç±»å‹æ·»åŠ ç±»å‹æ³¨é‡Šï¼Œè®©éµå®ˆåè®®çš„ç±»å‹å¿…é¡»éµå¾ªè¿™ä¸ªçº¦æŸæ¡ä»¶

```swift
protocol Container {
    //çº¦æŸå…³è”ç±»å‹
    associatedtype Item: Equatable
    mutating func append(_ item: Item)
    var count: Int { get }
    subscript(i: Int) -> Item { get }
}
```

### æ³›å‹ where è¯­å¥


è¿™ä¸ªå‡½æ•°çš„ç±»å‹å‚æ•°åˆ—è¡¨è¿˜å®šä¹‰äº†å¯¹ä¸¤ä¸ªç±»å‹å‚æ•°çš„è¦æ±‚ï¼š

* C1 å¿…é¡»ç¬¦åˆ Container åè®®ï¼ˆå†™ä½œ C1: Containerï¼‰ã€‚
* C2 å¿…é¡»ç¬¦åˆ Container åè®®ï¼ˆå†™ä½œ C2: Containerï¼‰ã€‚
* C1 çš„ ItemType å¿…é¡»å’Œ C2 çš„ ItemTypeç±»å‹ç›¸åŒï¼ˆå†™ä½œ C1.ItemType == C2.ItemTypeï¼‰ã€‚
* C1 çš„ ItemType å¿…é¡»ç¬¦åˆ Equatable åè®®ï¼ˆå†™ä½œ C1.ItemType: Equatableï¼‰ã€‚

```swift
func allItemsMatch<C1: Container, C2: Container> (_ someContainer: C1, _ anotherContainer: C2) -> Bool
    where C1.ItemType == C2.ItemType, C1.ItemType: Equatable {
        
        // æ£€æŸ¥ä¸¤ä¸ªå®¹å™¨å«æœ‰ç›¸åŒæ•°é‡çš„å…ƒç´ 
        if someContainer.count != anotherContainer.count {
            return false
        }
        
        // æ£€æŸ¥æ¯ä¸€å¯¹å…ƒç´ æ˜¯å¦ç›¸ç­‰
        for i in 0..<someContainer.count {
            if someContainer[i] != anotherContainer[i] {
                return false
            }
        }
        
        // æ‰€æœ‰å…ƒç´ éƒ½åŒ¹é…ï¼Œè¿”å› true
        return true
}



var stackOfStrings = Stack<String>()
stackOfStrings.push("uno")
stackOfStrings.push("dos")
stackOfStrings.push("tres")

var arrayOfStrings = ["uno", "dos", "tres"]

if allItemsMatch(stackOfStrings, arrayOfStrings) {
    print("All items match.")
} else {
    print("Not all items match.")
}
// æ‰“å° â€œAll items match.â€

```
### å…·æœ‰æ³›å‹ where å­å¥çš„æ‰©å±•


```swift

struct Stack<Element> {
    var items = [Element]()
    mutating func push(_ item: Element) {
        items.append(item)
    }
    mutating func pop() -> Element {
        return items.removeLast()
    }
}

//æ³›å‹ where å­å¥è¦æ±‚ Item ç¬¦åˆåè®®
extension Stack where Element: Equatable {
    func isTop(_ item: Element) -> Bool {
    //å¦‚æœæ¡ä»¶ä¸æˆç«‹ï¼Œå¯ç”¨ guard è¯­å¥ç”¨æ¥é€€å‡ºå½“å‰ä½œç”¨åŸŸ
        guard let topItem = items.last else {
            return false
        }
        return topItem == item
    }
}


struct NotEquatable { }
var notEquatableStack = Stack<NotEquatable>()
let notEquatableValue = NotEquatable()
notEquatableStack.push(notEquatableValue)
notEquatableStack.isTop(notEquatableValue)  // æŠ¥é”™

//æ³›å‹ where å­å¥å»è¦æ±‚ Item ä¸ºç‰¹å®šç±»å‹
extension Container where Item == Double {
    func average() -> Double {
        var sum = 0.0
        for index in 0..<count {
            sum += self[index]
        }
        return sum / Double(count)
    }
}
print([1260.0, 1200.0, 98.6, 37.0].average())
// æ‰“å° "648.9"

```


### æ³›å‹ where å­å¥çš„å…³è”ç±»å‹


```swift
protocol Container {
    associatedtype Item
    mutating func append(_ item: Item)
    var count: Int { get }
    subscript(i: Int) -> Item { get }

    associatedtype Iterator: IteratorProtocol where Iterator.Element == Item
    func makeIterator() -> Iterator
}

protocol ComparableContainer: Container where Item: Comparable { }
```

### æ³›å‹ä¸‹æ ‡

```swift
extension Container_ {
    subscript<Indices: Sequence>(indices: Indices) -> [Item]
        where Indices.Iterator.Element == Int {
            var result = [Item]()
            for index in indices {
                result.append(self[index])
            }
            return result
    }
}
```

è¿™ä¸ªæ³›å‹ä¸‹æ ‡çš„çº¦æŸå¦‚ä¸‹ï¼š
* åœ¨å°–æ‹¬å·ä¸­çš„æ³›å‹å‚æ•° `Indices`ï¼Œå¿…é¡»æ˜¯ç¬¦åˆæ ‡å‡†åº“ä¸­çš„ `Sequence` åè®®çš„ç±»å‹ã€‚
* ä¸‹æ ‡ä½¿ç”¨çš„å•ä¸€çš„å‚æ•°ï¼Œ`indices`ï¼Œå¿…é¡»æ˜¯ `Indices` çš„å®ä¾‹ã€‚
* æ³›å‹ `where` å­å¥è¦æ±‚ Sequenceï¼ˆIndicesï¼‰çš„è¿­ä»£å™¨ï¼Œå…¶æ‰€æœ‰çš„å…ƒç´ éƒ½æ˜¯ `Int` ç±»å‹ã€‚è¿™æ ·å°±èƒ½ç¡®ä¿åœ¨åºåˆ—ï¼ˆSequenceï¼‰ä¸­çš„ç´¢å¼•å’Œå®¹å™¨(Container)é‡Œé¢çš„ç´¢å¼•ç±»å‹æ˜¯ä¸€è‡´çš„ã€‚

## å¯é€‰é“¾å¼è°ƒç”¨

å¯é€‰é“¾å¼è°ƒç”¨æ˜¯ä¸€ç§å¯ä»¥åœ¨å½“å‰å€¼å¯èƒ½ä¸º`nil`çš„å¯é€‰å€¼ä¸Šè¯·æ±‚å’Œè°ƒç”¨å±æ€§ã€æ–¹æ³•åŠä¸‹æ ‡çš„æ–¹æ³•ã€‚
å¦‚æœå¯é€‰å€¼æœ‰å€¼ï¼Œé‚£ä¹ˆè°ƒç”¨å°±ä¼šæˆåŠŸï¼›å¦‚æœå¯é€‰å€¼æ˜¯`nil`ï¼Œé‚£ä¹ˆè°ƒç”¨å°†è¿”å›`nil`ã€‚å¤šä¸ªè°ƒç”¨å¯ä»¥è¿æ¥åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ª**è°ƒç”¨é“¾**ï¼Œå¦‚æœå…¶ä¸­ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ä¸º`nil`ï¼Œæ•´ä¸ªè°ƒç”¨é“¾éƒ½ä¼šå¤±è´¥ï¼Œå³è¿”å›`nil`ã€‚

>æ³¨æ„
Swift çš„å¯é€‰é“¾å¼è°ƒç”¨å’Œ Objective-C ä¸­å‘nilå‘é€æ¶ˆæ¯æœ‰äº›ç›¸åƒï¼Œä½†æ˜¯ Swift çš„å¯é€‰é“¾å¼è°ƒç”¨å¯ä»¥åº”ç”¨äºä»»æ„ç±»å‹ï¼Œå¹¶ä¸”èƒ½æ£€æŸ¥è°ƒç”¨æ˜¯å¦æˆåŠŸã€‚


```swift
class Person {
    var residence: Residence?
}

class Residence {
    var numberOfRooms = 1
}
let john = Person()

//å¼ºåˆ¶è§£æoptionç±»å‹ï¼Œresidence = nil,ç¼–è¯‘æŠ¥é”™
//let roomCount = john.residence!.numberOfRooms

//john.residence = Residence()

//å¯é€‰é“¾
//åœ¨residenceåé¢æ·»åŠ é—®å·ä¹‹åï¼ŒSwift å°±ä¼šåœ¨residenceä¸ä¸ºnilçš„æƒ…å†µä¸‹è®¿é—®numberOfRooms
//å¯é€‰é“¾å¼è°ƒç”¨ä¼šè¿”å›Int?ç±»å‹
if let roomCount = john.residence?.numberOfRooms {
    print("John's residence has \(roomCount) room(s).")
} else {
    print("Unable to retrieve the number of rooms.")
}

```

è®¿é—®å¯é€‰ç±»å‹çš„ä¸‹æ ‡ï¼š
```swift
var testScores = ["Dave": [86, 82, 84], "Bev": [79, 94, 81]]
testScores["Dave"]?[0] = 91
testScores["Bev"]?[0] += 1
testScores["Brian"]?[0] = 72
// "Dave" æ•°ç»„ç°åœ¨æ˜¯ [91, 82, 84]ï¼Œ"Bev" æ•°ç»„ç°åœ¨æ˜¯ [80, 94, 81]
```


## å†…å­˜å®‰å…¨

>æ³¨æ„
å¦‚æœä½ å†™è¿‡å¹¶å‘å’Œå¤šçº¿ç¨‹çš„ä»£ç ï¼Œå†…å­˜è®¿é—®å†²çªä¹Ÿè®¸æ˜¯åŒæ ·çš„é—®é¢˜ã€‚ç„¶è€Œï¼Œè¿™é‡Œè®¿é—®å†²çªçš„è®¨è®ºæ˜¯åœ¨å•çº¿ç¨‹çš„æƒ…å¢ƒä¸‹è®¨è®ºçš„ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨å¹¶å‘æˆ–è€…å¤šçº¿ç¨‹ã€‚
å¦‚æœä½ æ›¾ç»åœ¨å•çº¿ç¨‹ä»£ç é‡Œæœ‰è®¿é—®å†²çªï¼ŒSwift å¯ä»¥ä¿è¯ä½ åœ¨ç¼–è¯‘æˆ–è€…è¿è¡Œæ—¶ä¼šå¾—åˆ°é”™è¯¯ã€‚å¯¹äºå¤šçº¿ç¨‹çš„ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ Thread Sanitizer å»å¸®åŠ©æ£€æµ‹å¤šçº¿ç¨‹çš„å†²çªã€‚

### å†…å­˜è®¿é—®çš„å…¸å‹çŠ¶å†µ

å†…å­˜è®¿é—®å†²çªæœ‰ä¸‰ç§å…¸å‹çš„çŠ¶å†µï¼šè®¿é—®æ˜¯è¯»è¿˜æ˜¯å†™ï¼Œè®¿é—®çš„æ—¶é•¿ï¼Œä»¥åŠè¢«è®¿é—®çš„å­˜å‚¨åœ°å€ã€‚ç‰¹åˆ«æ˜¯ï¼Œå½“ä½ æœ‰ä¸¤ä¸ªè®¿é—®ç¬¦åˆä¸‹åˆ—çš„æƒ…å†µï¼š

* è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯å†™è®¿é—®
* å®ƒä»¬è®¿é—®çš„æ˜¯åŒä¸€ä¸ªå­˜å‚¨åœ°å€
* å®ƒä»¬çš„è®¿é—®åœ¨æ—¶é—´çº¿ä¸Šéƒ¨åˆ†é‡å 


é‡å çš„è®¿é—®ä¸»è¦å‡ºç°åœ¨ä½¿ç”¨ `in-out` å‚æ•°çš„å‡½æ•°å’Œæ–¹æ³•æˆ–è€…ç»“æ„ä½“çš„ `mutating` æ–¹æ³•é‡Œ

### In-Out å‚æ•°çš„è®¿é—®å†²çª
ä¸€ä¸ªå‡½æ•°ä¼šå¯¹å®ƒæ‰€æœ‰çš„ `in-out` å‚æ•°è¿›è¡Œé•¿æœŸå†™è®¿é—®ã€‚
`in-out` å‚æ•°çš„å†™è®¿é—®ä¼šåœ¨æ‰€æœ‰é `in-out` å‚æ•°å¤„ç†å®Œä¹‹åå¼€å§‹ï¼Œç›´åˆ°å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¸ºæ­¢ã€‚å¦‚æœæœ‰å¤šä¸ª `in-out` å‚æ•°ï¼Œåˆ™å†™è®¿é—®å¼€å§‹çš„é¡ºåºä¸å‚æ•°çš„é¡ºåºä¸€è‡´ã€‚


é•¿æœŸè®¿é—®çš„å­˜åœ¨ä¼šé€ æˆä¸€ä¸ªç»“æœï¼Œä½ ä¸èƒ½åœ¨åŸå˜é‡ä»¥ in-out å½¢å¼ä¼ å…¥åè®¿é—®åŸå˜é‡ï¼Œå³ä½¿ä½œç”¨åŸŸåŸåˆ™å’Œè®¿é—®æƒé™å…è®¸ â€”â€” ä»»ä½•è®¿é—®åŸå˜é‡çš„è¡Œä¸ºéƒ½ä¼šé€ æˆå†²çª.


```swift
var stepSize = 1

func increment(_ number: inout Int) {
    number += stepSize
}

increment(&stepSize)
// é”™è¯¯ï¼šstepSize è®¿é—®å†²çª
```
`stepSize` æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå¹¶ä¸”å®ƒå¯ä»¥åœ¨ `increment(_:)` é‡Œæ­£å¸¸è®¿é—®ã€‚
ç„¶è€Œï¼Œå¯¹äº `stepSize` çš„è¯»è®¿é—®ä¸ `number` çš„å†™è®¿é—®é‡å äº†ã€‚å°±åƒä¸‹é¢å±•ç¤ºçš„é‚£æ ·ï¼Œ`number` å’Œ `stepSize` éƒ½æŒ‡å‘äº†åŒä¸€ä¸ªå­˜å‚¨åœ°å€ã€‚
åŒä¸€å—å†…å­˜çš„è¯»å’Œå†™è®¿é—®é‡å äº†ï¼Œå°±æ­¤äº§ç”Ÿäº†å†²çªã€‚


å¾€åŒä¸€ä¸ªå‡½æ•°çš„å¤šä¸ª in-out å‚æ•°é‡Œä¼ å…¥åŒä¸€ä¸ªå˜é‡ä¹Ÿä¼šäº§ç”Ÿå†²çª

```swift
func balance(_ x: inout Int, _ y: inout Int) {
    let sum = x + y
    x = sum / 2
    y = sum - x
}
var playerOneScore = 42
var playerTwoScore = 30
balance(&playerOneScore, &playerTwoScore)  // æ­£å¸¸
balance(&playerOneScore, &playerOneScore)
// é”™è¯¯ï¼šplayerOneScore è®¿é—®å†²çª
```

### æ–¹æ³•é‡Œ self çš„è®¿é—®å†²çª
ä¸€ä¸ªç»“æ„ä½“çš„ `mutating` æ–¹æ³•ä¼šåœ¨è°ƒç”¨æœŸé—´å¯¹ `self` è¿›è¡Œå†™è®¿é—®

```swift
struct Player {
    var name: String
    var health: Int
    var energy: Int

    static let maxHealth = 10
    mutating func restoreHealth() {
        health = Player.maxHealth
    }
}
//æ¥å—å¦ä¸€ä¸ª Player çš„å®ä¾‹ä½œä¸º in-out å‚æ•°ï¼Œäº§ç”Ÿäº†è®¿é—®é‡å çš„å¯èƒ½æ€§
extension Player {
    mutating func shareHealth(with teammate: inout Player) {
        balance(&teammate.health, &health)
    }
}

var oscar = Player(name: "Oscar", health: 10, energy: 10)
var maria = Player(name: "Maria", health: 5, energy: 10)
oscar.shareHealth(with: &maria)  // æ­£å¸¸

oscar.shareHealth(with: &oscar)
// é”™è¯¯ï¼šoscar è®¿é—®å†²çª

```


`mutating` æ–¹æ³•åœ¨è°ƒç”¨æœŸé—´éœ€è¦å¯¹ `self` å‘èµ·å†™è®¿é—®ï¼Œè€ŒåŒæ—¶ `in-out` å‚æ•°ä¹Ÿéœ€è¦å†™è®¿é—®ã€‚åœ¨æ–¹æ³•é‡Œï¼Œ`self` å’Œ `teammate` éƒ½æŒ‡å‘äº†åŒä¸€ä¸ªå­˜å‚¨åœ°å€ã€‚å¯¹äºåŒä¸€å—å†…å­˜åŒæ—¶è¿›è¡Œä¸¤ä¸ªå†™è®¿é—®ï¼Œå¹¶ä¸”å®ƒä»¬é‡å äº†ï¼Œå°±æ­¤äº§ç”Ÿäº†å†²çªã€‚


### å±æ€§çš„è®¿é—®å†²çª

ç»“æ„ä½“ï¼Œå…ƒç»„å’Œæšä¸¾çš„ç±»å‹éƒ½æ˜¯ç”±å¤šä¸ªç‹¬ç«‹çš„å€¼ç»„æˆçš„ï¼Œä¾‹å¦‚ç»“æ„ä½“çš„å±æ€§æˆ–å…ƒç»„çš„å…ƒç´ ã€‚å› ä¸ºå®ƒä»¬éƒ½æ˜¯å€¼ç±»å‹ï¼Œ**ä¿®æ”¹å€¼çš„ä»»ä½•ä¸€éƒ¨åˆ†éƒ½æ˜¯å¯¹äºæ•´ä¸ªå€¼çš„ä¿®æ”¹**ï¼Œæ„å‘³ç€å…¶ä¸­ä¸€ä¸ªå±æ€§çš„è¯»æˆ–å†™è®¿é—®éƒ½éœ€è¦è®¿é—®æ•´ä¸€ä¸ªå€¼ã€‚

ä¾‹å¦‚ï¼Œå…ƒç»„å…ƒç´ çš„å†™è®¿é—®é‡å ä¼šäº§ç”Ÿå†²çªï¼š

```swift
var playerInformation = (health: 10, energy: 20)
balance(&playerInformation.health, &playerInformation.energy)
// é”™è¯¯ï¼šplayerInformation çš„å±æ€§è®¿é—®å†²çª
```
ä¼ å…¥åŒä¸€å…ƒç»„çš„å…ƒç´ å¯¹ `balance(_:_:)` è¿›è¡Œè°ƒç”¨ï¼Œäº§ç”Ÿäº†å†²çªï¼Œå› ä¸º `playerInformation` çš„è®¿é—®äº§ç”Ÿäº†å†™è®¿é—®é‡å .
ä»»ä½•æƒ…å†µä¸‹ï¼Œå¯¹äºå…ƒç»„å…ƒç´ çš„å†™è®¿é—®éƒ½éœ€è¦å¯¹æ•´ä¸ªå…ƒç»„å‘èµ·å†™è®¿é—®ã€‚è¿™æ„å‘³ç€å¯¹äº `playerInfomation` å‘èµ·çš„ä¸¤ä¸ªå†™è®¿é—®é‡å äº†ï¼Œé€ æˆå†²çªã€‚

```swift
//å¯¹äºä¸€ä¸ªå­˜å‚¨åœ¨å…¨å±€å˜é‡é‡Œçš„ç»“æ„ä½“å±æ€§çš„å†™è®¿é—®é‡å äº†
var holly = Player(name: "Holly", health: 10, energy: 10)
balance(&holly.health, &holly.energy)  // é”™è¯¯
```

åœ¨å®è·µä¸­ï¼Œå¤§å¤šæ•°å¯¹äºç»“æ„ä½“å±æ€§çš„è®¿é—®éƒ½ä¼šå®‰å…¨çš„é‡å ã€‚ä¾‹å¦‚ï¼Œå°†ä¸Šé¢ä¾‹å­é‡Œçš„å˜é‡ `holly` æ”¹ä¸ºæœ¬åœ°å˜é‡è€Œéå…¨å±€å˜é‡ï¼Œç¼–è¯‘å™¨å°±ä¼šå¯ä»¥ä¿è¯è¿™ä¸ªé‡å è®¿é—®æ—¶å®‰å…¨çš„ï¼š

```swift
func someFunction() {
    var oscar = Player(name: "Oscar", health: 10, energy: 10)
    balance(&oscar.health, &oscar.energy)  // æ­£å¸¸
}
```

å½“ä½ éµå¾ªä¸‹é¢çš„åŸåˆ™æ—¶ï¼Œå®ƒå¯ä»¥ä¿è¯ç»“æ„ä½“å±æ€§çš„é‡å è®¿é—®æ˜¯å®‰å…¨çš„ï¼š

* ä½ è®¿é—®çš„æ˜¯å®ä¾‹çš„å­˜å‚¨å±æ€§ï¼Œè€Œä¸æ˜¯è®¡ç®—å±æ€§æˆ–ç±»çš„å±æ€§
* ç»“æ„ä½“æ˜¯æœ¬åœ°å˜é‡çš„å€¼ï¼Œè€Œéå…¨å±€å˜é‡
* ç»“æ„ä½“è¦ä¹ˆæ²¡æœ‰è¢«é—­åŒ…æ•è·ï¼Œè¦ä¹ˆåªè¢«éé€ƒé€¸é—­åŒ…æ•è·äº†

å¦‚æœç¼–è¯‘å™¨æ— æ³•ä¿è¯è®¿é—®çš„å®‰å…¨æ€§ï¼Œå®ƒå°±ä¸ä¼šå…è®¸è®¿é—®ã€‚


## è®¿é—®æ§åˆ¶

* `Open` å’Œ `Public` çº§åˆ«å¯ä»¥è®©å®ä½“è¢«åŒä¸€æ¨¡å—æºæ–‡ä»¶ä¸­çš„æ‰€æœ‰å®ä½“è®¿é—®ï¼Œåœ¨æ¨¡å—å¤–ä¹Ÿå¯ä»¥é€šè¿‡å¯¼å…¥è¯¥æ¨¡å—æ¥è®¿é—®æºæ–‡ä»¶é‡Œçš„æ‰€æœ‰å®ä½“ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ ä¼šä½¿ç”¨ Open æˆ– Public çº§åˆ«æ¥æŒ‡å®šæ¡†æ¶çš„å¤–éƒ¨æ¥å£ã€‚Open å’Œ Public çš„åŒºåˆ«åœ¨åé¢ä¼šæåˆ°ã€‚
* `Internal` çº§åˆ«è®©å®ä½“è¢«åŒä¸€æ¨¡å—æºæ–‡ä»¶ä¸­çš„ä»»ä½•å®ä½“è®¿é—®ï¼Œä½†æ˜¯ä¸èƒ½è¢«æ¨¡å—å¤–çš„å®ä½“è®¿é—®ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæŸä¸ªæ¥å£åªåœ¨åº”ç”¨ç¨‹åºæˆ–æ¡†æ¶å†…éƒ¨ä½¿ç”¨ï¼Œå°±å¯ä»¥å°†å…¶è®¾ç½®ä¸º Internal çº§åˆ«ã€‚
* `File-private` é™åˆ¶å®ä½“åªèƒ½åœ¨å…¶å®šä¹‰çš„æ–‡ä»¶å†…éƒ¨è®¿é—®ã€‚å¦‚æœåŠŸèƒ½çš„éƒ¨åˆ†ç»†èŠ‚åªéœ€è¦åœ¨æ–‡ä»¶å†…ä½¿ç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ File-private æ¥å°†å…¶éšè—ã€‚
* `Private` é™åˆ¶å®ä½“åªèƒ½åœ¨å…¶å®šä¹‰çš„ä½œç”¨åŸŸï¼Œä»¥åŠåŒä¸€æ–‡ä»¶å†…çš„ extension è®¿é—®ã€‚å¦‚æœåŠŸèƒ½çš„éƒ¨åˆ†ç»†èŠ‚åªéœ€è¦åœ¨å½“å‰ä½œç”¨åŸŸå†…ä½¿ç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Private æ¥å°†å…¶éšè—ã€‚


é»˜è®¤ä¸º `internal` çº§åˆ«

`Open` åªèƒ½ä½œç”¨äºç±»å’Œç±»çš„æˆå‘˜ï¼Œå®ƒå’Œ `Public` çš„åŒºåˆ«å¦‚ä¸‹ï¼š

* `Public` æˆ–è€…å…¶å®ƒæ›´ä¸¥è®¿é—®çº§åˆ«çš„ç±»ï¼Œåªèƒ½åœ¨å…¶å®šä¹‰çš„æ¨¡å—å†…éƒ¨è¢«ç»§æ‰¿ã€‚
* `Public` æˆ–è€…å…¶å®ƒæ›´ä¸¥è®¿é—®çº§åˆ«çš„ç±»æˆå‘˜ï¼Œåªèƒ½åœ¨å…¶å®šä¹‰çš„æ¨¡å—å†…éƒ¨çš„å­ç±»ä¸­é‡å†™ã€‚
* `Open` çš„ç±»ï¼Œå¯ä»¥åœ¨å…¶å®šä¹‰çš„æ¨¡å—ä¸­è¢«ç»§æ‰¿ï¼Œä¹Ÿå¯ä»¥åœ¨å¼•ç”¨å®ƒçš„æ¨¡å—ä¸­è¢«ç»§æ‰¿ã€‚
* `Open` çš„ç±»æˆå‘˜ï¼Œå¯ä»¥åœ¨å…¶å®šä¹‰çš„æ¨¡å—ä¸­å­ç±»ä¸­é‡å†™ï¼Œä¹Ÿå¯ä»¥åœ¨å¼•ç”¨å®ƒçš„æ¨¡å—ä¸­çš„å­ç±»é‡å†™ã€‚


```swift
public class SomePublicClass {}
internal class SomeInternalClass {}
fileprivate class SomeFilePrivateClass {}
private class SomePrivateClass {}

public var somePublicVariable = 0
internal let someInternalConstant = 0
fileprivate func someFilePrivateFunction() {}
private func somePrivateFunction() {}

```